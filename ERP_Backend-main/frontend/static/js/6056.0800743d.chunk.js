"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[6056],{64568:(e,a,s)=>{s.d(a,{c:()=>c});var t=s(82496);const c=()=>(0,t.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},62344:(e,a,s)=>{s.d(a,{o$:()=>l,o5:()=>d,cF:()=>n,iI:()=>r});var t=s(30800);const c=s.p+"static/media/smt.aa4d4f940bbebff07a57.png",r={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},n={control:(e,a)=>(0,t.c)((0,t.c)({},e),{},{height:"45px",background:"rgba(255, 255, 255, 0.322)"}),menu:(e,a)=>(0,t.c)((0,t.c)({},e),{},{zIndex:9999}),menuPortal:e=>(0,t.c)((0,t.c)({},e),{},{zIndex:9999})},l=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],d=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:c,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:c,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:c,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}]},42672:(e,a,s)=>{s.r(a),s.d(a,{default:()=>re});var t=s(69060),c=s(5548),r=s(82656),n=s(26773),l=s(4488),d=s(90048),o=s(28655),i=s(14168),m=s(86e3),h=s(57704),p=s(56480),u=s(77536),x=s(1908),_=s(8436),y=s(45108),j=s(32635),g=s(30800),v=s(89e3),T=s(12572),b=s(15786),S=s(56880),k=s(6392),f=s(21280),I=s(70564),N=s(99904),E=s(33856),C=s(58612),D=s(27454),P=s(700),w=s(27532),A=s(98204),R=s(35880),q=(s(21680),s(67472),s(68424)),O=s(39504),B=s(71448),F=s(52924),M=s(44380),L=s(39308),U=s(64568),W=s(82496);const G=(0,W.jsx)(q.c,{fontSize:"small"}),H=(0,W.jsx)(O.c,{fontSize:"small"}),z=e=>{let{row:a,children:s,openAction:c,reload:o,onCloseFun:i,loadingOn:m,loadingOff:h,onTaskAdded:u}=e;const _=localStorage.getItem("user"),y=JSON.parse(_),j={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:"",Entry_By:null===y||void 0===y?void 0:y.UserId,Company_id:null===y||void 0===y?void 0:y.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[v,T]=(0,t.useState)(!1),[b,S]=(0,t.useState)(!1),[k,f]=(0,t.useState)([]),[I,N]=(0,t.useState)([]),[E,C]=(0,t.useState)([]),[D,P]=(0,t.useState)(j),[w,A]=(0,t.useState)(!1),[R,q]=(0,t.useState)(j);(0,t.useEffect)((()=>{(async()=>{try{const e=await(0,x.q)({address:"taskManagement/tasks/dropdown"});e.success&&f(e.data);const a=await(0,x.q)({address:"masters/taskType/dropDown"});a.success&&N(a.data);const s=await(0,x.q)({address:"taskManagement/parameters"});s.success&&C(s.data)}catch(e){console.error(e)}})()}),[]),(0,t.useEffect)((()=>{T(c)}),[c]),(0,t.useEffect)((()=>{(0,L.CY)(a)?(console.log(a),P((e=>(0,g.c)((0,g.c)((0,g.c)({},e),a),{},{Task_Group_Id:a.Task_Group_Id||""}))),S(!0)):(P(j),S(!1))}),[a]);const O=()=>{T(!1),i&&i()},z=()=>{A(!1),q(j)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("span",{onClick:()=>T(!0),style:{cursor:"pointer"},children:s}),(0,W.jsxs)(r.c,{open:v,children:[(0,W.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:b?"Edit Task":"Add Task"}),(0,W.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=D.Task_Parameters.map((e=>(0,g.c)((0,g.c)({},e),{},{Param_Id:e.Paramet_Id})))||[],a=(0,g.c)((0,g.c)({},D),{},{Task_Parameters:e});m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:b?"PUT":"POST",bodyData:a});e.success?(p.m4.success(e.message),P(j),O(),o&&o(),u&&u()):p.m4.error(e.message)}catch(s){console.error(s),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,W.jsx)(l.c,{children:(0,W.jsxs)("div",{className:"row",children:[(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsxs)("label",{children:["Task Name ",(0,W.jsx)(U.c,{})]}),(0,W.jsx)("input",{maxLength:150,onChange:e=>P((0,g.c)((0,g.c)({},D),{},{Task_Name:e.target.value})),required:!0,value:D.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsxs)("label",{children:["Task Group ",(0,W.jsx)(U.c,{})]}),(0,W.jsxs)("select",{value:D.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>P((0,g.c)((0,g.c)({},D),{},{Task_Group_Id:e.target.value})),children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),I.map(((e,a)=>(0,W.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a)))]})]}),(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsx)("label",{children:"Base Task"}),(0,W.jsxs)("select",{value:D.Under_Task_Id,className:"cus-inpt",onChange:e=>P((0,g.c)((0,g.c)({},D),{},{Under_Task_Id:e.target.value})),children:[(0,W.jsx)("option",{value:0,children:"Primary"}),k.map(((e,a)=>(0,W.jsx)("option",{value:e.Task_Id,children:e.Task_Name},a)))]})]}),(0,W.jsxs)("div",{className:"col-12",children:[(0,W.jsxs)("label",{children:["Task Description ",(0,W.jsx)(U.c,{})]}),(0,W.jsx)("textarea",{className:"cus-inpt",value:D.Task_Desc,rows:"3",onChange:e=>P((0,g.c)((0,g.c)({},D),{},{Task_Desc:e.target.value}))})]}),(0,W.jsx)("div",{className:"col-md-12 p-2",children:(0,W.jsx)(B.c,{multiple:!0,id:"checkboxes-tags-demo",options:E,disableCloseOnSelect:!0,getOptionLabel:e=>"".concat(e.Paramet_Name," - ").concat(e.Paramet_Data_Type),value:D.Task_Parameters||[],onChange:(e,a)=>P((0,g.c)((0,g.c)({},D),{},{Task_Parameters:a})),renderOption:(e,a,s)=>{let{selected:t}=s;return(0,W.jsxs)("li",(0,g.c)((0,g.c)({},e),{},{children:[(0,W.jsx)(F.c,{icon:G,checkedIcon:H,style:{marginRight:8},checked:t}),"".concat(a.Paramet_Name," - ").concat(a.Paramet_Data_Type)]}))},className:"pt-2",isOptionEqualToValue:(e,a)=>Number(e.Paramet_Id)===Number(a.Paramet_Id),renderInput:e=>(0,W.jsx)(M.c,(0,g.c)((0,g.c)({},e),{},{label:"Task Parameters",placeholder:"Choose Task Parameters"}))})}),D.Task_Parameters.map(((e,a)=>(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsx)("label",{className:"mb-2",children:e.Paramet_Name}),(0,W.jsx)("input",{type:e.Paramet_Data_Type||"text",className:"cus-inpt",onChange:e=>{const s=[...D.Task_Parameters];s[a]=(0,g.c)((0,g.c)({},s[a]),{},{Default_Value:e.target.value}),P((0,g.c)((0,g.c)({},D),{},{Task_Parameters:s}))},value:e.Default_Value,placeholder:"Default Value"})]},a)))]})}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:O,children:"Cancel"}),(0,W.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]}),(0,W.jsxs)(r.c,{open:w,onClose:z,children:[(0,W.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Edit Task"}),(0,W.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=R.Task_Parameters.map((e=>(0,g.c)((0,g.c)({},e),{},{Param_Id:e.Paramet_Id})))||[],a=(0,g.c)((0,g.c)({},R),{},{Task_Parameters:e});m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:"PUT",bodyData:a});e.success?(p.m4.success(e.message),z(),o&&o(),u&&u()):p.m4.error(e.message)}catch(s){console.error(s),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,W.jsxs)(l.c,{children:[(0,W.jsx)(M.c,{label:"Task Name",value:R.Task_Name,onChange:e=>q((0,g.c)((0,g.c)({},R),{},{Task_Name:e.target.value})),fullWidth:!0}),(0,W.jsxs)(M.c,{label:"Task Group",select:!0,value:R.Task_Group_Id,onChange:e=>q((0,g.c)((0,g.c)({},R),{},{Task_Group_Id:e.target.value})),fullWidth:!0,children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),I.map(((e,a)=>(0,W.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a)))]})]}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:z,children:"Cancel"}),(0,W.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Save"})]})]})]})]})};var J=s(55888),Q=s(40656),V=s(62344);const Y=e=>{let{open:a,onClose:s,projectId:c,taskId:o,reload:i,onReload:m,editData:h}=e;const u=localStorage.getItem("user"),_=JSON.parse(u),[y,j]=(0,t.useState)([]),[T,b]=(0,t.useState)(!1),[S,k]=(0,t.useState)([]),f={AN_No:"",Project_Id:c,Sch_Id:o,Assigned_Emp_Id:null===_||void 0===_?void 0:_.UserId,Emp_Id:"",Task_Assign_dt:(new Date).toISOString().split("T")[0],Sch_Period:"",Sch_Time:"",EN_Time:"",Est_Start_Dt:"",Est_End_Dt:"",Ord_By:1,Timer_Based:!1,Sch_Type:"",Invovled_Stat:!0,EmpGet:"- Select -",Is_Repitative:!1,RepeatDays:{Mon:!1,Tue:!1,Wed:!1,Thu:!1,Fri:!1,Sat:!1,Sun:!1}},[I,N]=(0,t.useState)(f);(0,t.useEffect)((()=>{a&&E()}),[c,a,i]);const E=async()=>{b(!0);try{const e=await(0,x.q)({address:"masters/Employeedetails/getusersproject?Project_Id=".concat(c)}),a=await(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"});e.success&&j(e.data||[]),a.success}catch(e){p.m4.error("Failed to fetch data.")}finally{b(!1)}};(0,t.useEffect)((()=>{a&&(async()=>{b(!0);try{if(h){var e,a;const s=await(0,x.q)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(c,"&Sch_Id=").concat(o.Sch_Id,"&Task_Id=").concat(o.Task_Id)}),t=null===(e=s.data[0])||void 0===e?void 0:e.Sch_Type_Id,r=null===(a=s.data[0])||void 0===a?void 0:a.Sch_Name;k(t&&r?{value:t,label:r}:{value:"",label:""})}else{var s,t;const e=await(0,x.q)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(c,"&Sch_Id=").concat(o.TaskSchId,"&Task_Id=").concat(o.Task_Id)}),a=null===(s=e.data[0])||void 0===s?void 0:s.Sch_Type_Id,r=null===(t=e.data[0])||void 0===t?void 0:t.Sch_Name;k(a&&r?{value:a,label:r}:{value:"",label:""})}}catch(r){p.m4.error("Failed to fetch data.")}finally{b(!1)}})()}),[a,h,i,c]),(0,t.useEffect)((()=>{h&&N((e=>(0,g.c)((0,g.c)({},e),{},{AN_No:h.AN_No,Emp_Id:h.Emp_Id,Sch_Time:h.Sch_Time,EN_Time:h.EN_Time,Est_Start_Dt:h.Est_Start_Dt.split("T")[0],Est_End_Dt:h.Est_End_Dt.split("T")[0],Ord_By:h.Ord_By,Timer_Based:h.Timer_Based,Invovled_Stat:h.Invovled_Stat,Sch_Type_Id:h.Sch_Type,Sch_Type:h.Sch_Type_Name,EmpGet:h.EmployeeName,Is_Repitative:h.Is_Repitative,RepeatDays:{Mon:!!h.IS_Rep_Monday,Tue:!!h.IS_Rep_Tuesday,Wed:!!h.IS_Rep_Wednesday,Thu:!!h.IS_Rep_Thursday,Fri:!!h.Is_Rep_Friday,Sat:!!h.Is_Rep_Saturday,Sun:!!h.Is_Rep_Sunday}})))}),[h]);return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(r.c,{open:a,maxWidth:"sm",children:[(0,W.jsx)(n.c,{children:h?"Edit Task":"Employee Assign"}),(0,W.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=(()=>{const[e,a]=I.Sch_Time.split(":").map(Number),[s,t]=I.EN_Time.split(":").map(Number),c=new Date(0,0,0,e,a),r=new Date(0,0,0,s,t);if(r>c){let e=Math.abs(r-c);const a=Math.floor(e/36e5),s=Math.floor(e/6e4);return"".concat(String(a).padStart(2,"0"),":").concat(String(s).padStart(2,"0"))}return""})();if(I.Est_End_Dt<I.Est_Start_Dt)p.m4.error("End date must be greater than start date.");else try{const e=h?"masters/employeedetails/updateTask":"masters/employeedetails/assignTask",t={IS_Rep_Monday:I.RepeatDays.Mon?1:null,IS_Rep_Tuesday:I.RepeatDays.Tue?1:null,IS_Rep_Wednesday:I.RepeatDays.Wed?1:null,IS_Rep_Thursday:I.RepeatDays.Thu?1:null,Is_Rep_Friday:I.RepeatDays.Fri?1:null,Is_Rep_Saturday:I.RepeatDays.Sat?1:null,Is_Rep_Sunday:I.RepeatDays.Sun?1:null};(await(0,x.q)({address:e,method:h?"PUT":"POST",bodyData:(0,g.c)((0,g.c)({},I),{},{Project_Id:c,Sch_Id:h?o.Sch_Id:o.TaskSchId,Task_Levl_Id:o.Task_Levl_Id,Task_Id:Number(o.Task_Id),Assigned_Emp_Id:I.Assigned_Emp_Id,Emp_Id:I.Emp_Id,Sch_Period:a,Sch_Time:I.Sch_Time,EN_Time:I.EN_Time,Est_Start_Dt:I.Est_Start_Dt,Est_End_Dt:I.Est_End_Dt,Ord_By:I.Ord_By,Sch_Type:S.value,Timer_Based:I.Timer_Based?1:0,Invovled_Stat:I.Invovled_Stat?1:0,Is_Repitative:I.Is_Repitative?1:0,RepeatDays:I.Is_Repitative?I.RepeatDays:""},t)})).success?(p.m4.success("Task ".concat(h?"updated":"assigned"," successfully!")),N({}),m&&m(),s()):p.m4.error("Please fill the values correctly")}catch(t){p.m4.error("Error during task assignment/update: "+t.message)}},children:[(0,W.jsxs)(l.c,{className:"table-responsive",children:[T&&(0,W.jsx)("div",{children:"Loading..."}),(0,W.jsx)("table",{className:"table",style:{tableLayout:"fixed"},children:(0,W.jsxs)("tbody",{children:[(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Employee"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)(Q.cp,{value:{value:I.Emp_Id,label:I.EmpGet},onChange:e=>N((0,g.c)((0,g.c)({},I),{},{Emp_Id:e.value,EmpGet:e.label})),options:[{value:"",label:"- Select -"},...y.map((e=>({value:e.UserId,label:e.Name})))],styles:V.cF,required:!0,isSearchable:!0,placeholder:"Select User"})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Sch_Type"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)(Q.cp,{value:S?{value:S.value,label:"".concat(S.label)}:null,styles:{padding:"0.5em"},isDisabled:!0,placeholder:"Select Sch_Type"})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Start Time"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"time",className:"cus-inpt",value:I.Sch_Time,required:!0,onChange:e=>N((0,g.c)((0,g.c)({},I),{},{Sch_Time:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"End Time"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"time",className:"cus-inpt",value:I.EN_Time,required:!0,min:I.Sch_Time,onChange:e=>N((0,g.c)((0,g.c)({},I),{},{EN_Time:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. Start Date"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"date",className:"cus-inpt",value:I.Est_Start_Dt,required:!0,onChange:e=>N((0,g.c)((0,g.c)({},I),{},{Est_Start_Dt:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. End Date"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"date",className:"cus-inpt",value:I.Est_End_Dt,required:!0,min:I.Est_Start_Dt,onChange:e=>N((0,g.c)((0,g.c)({},I),{},{Est_End_Dt:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsx)("tr",{children:(0,W.jsxs)("td",{className:"border-bottom-0 fa-15 text-start",style:{paddingRight:"1em"},children:[(0,W.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,W.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",id:"timerbased",checked:Boolean(Number(null===I||void 0===I?void 0:I.Timer_Based)),onChange:e=>N((0,g.c)((0,g.c)({},I),{},{Timer_Based:e.target.checked})),style:{marginRight:"0.5em"}}),(0,W.jsx)("label",{className:"form-check-label p-1 ps-2",htmlFor:"timerbased",children:"Timer Based Task?"})]}),h&&(0,W.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,W.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",checked:Boolean(Number(null===I||void 0===I?void 0:I.Invovled_Stat)),onChange:()=>N((0,g.c)((0,g.c)({},I),{},{Invovled_Stat:!I.Invovled_Stat})),style:{marginRight:"0.5em"}}),(0,W.jsx)("label",{className:"form-check-label p-1 ps-2",children:"Involved Status"})]})]})}),(0,W.jsx)("tr",{children:(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingRight:"1em"},children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"1em"},children:[(0,W.jsx)("input",{type:"checkbox",checked:1===I.Is_Repitative,onChange:e=>{N((a=>(0,g.c)((0,g.c)({},a),{},{Is_Repitative:e.target.checked?1:0})))},style:{marginRight:"1em"}}),(0,W.jsx)("label",{style:{marginBottom:"0"},children:"Is Repetitive?"})]}),1===I.Is_Repitative&&(0,W.jsx)("div",{style:{display:"inline-flex",gap:"0.5em"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,W.jsxs)("label",{style:{display:"flex",alignItems:"center",marginRight:"1em",width:"30px"},children:[(0,W.jsx)("input",{type:"checkbox",checked:I.RepeatDays[e],onChange:()=>N((0,g.c)((0,g.c)({},I),{},{RepeatDays:(0,g.c)((0,g.c)({},I.RepeatDays),{},{[e]:!I.RepeatDays[e]})})),style:{marginRight:"0.5em"}}),e]},e)))})]})})})]})})]}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)(v.c,{onClick:()=>{s(),N(f)},variant:"outlined",children:"Close"}),(0,W.jsx)(v.c,{type:"submit",variant:"contained",children:"Save Changes"})]})]})]})})};var Z=s(63468),K=s(29504),$=s(63172),X=s(86848);const ee=function(e){let{open:a,onClose:s,taskDetails:d,closeDialogTask:o}=e;const[i,h]=(0,t.useState)(null),[p,x]=(0,t.useState)(!1),[_,y]=(0,t.useState)(!0),{contextObj:j}=(0,t.useContext)(u.a);(0,t.useEffect)((()=>{a&&(h(null),y(!0),setTimeout((()=>{y(!1)}),500))}),[a]);const g=e=>{if(!e)return"N/A";const a=new Date(e);if(isNaN(a.getTime()))return"Invalid Date";const s=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),c=a.getFullYear();return"".concat(s,"-").concat(t,"-").concat(c)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(r.c,{open:a,maxWidth:"lg",children:[(0,W.jsx)(n.c,{children:(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsx)("span",{children:"Details"}),(0,W.jsx)(v.c,{variant:"contained",color:"primary",onClick:s,children:"Close"})]})}),(0,W.jsx)(l.c,{children:_?(0,W.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",width:"500px"},children:(0,W.jsx)(Z.c,{})}):(0,W.jsx)(N.c,{children:(0,W.jsxs)(E.c,{children:[(0,W.jsx)(C.c,{children:(0,W.jsxs)(D.c,{children:[(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Employee"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Assigned By"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Start-End Date"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Start-End Time"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Total Hours"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Timer Based"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Involved Status"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Order By"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:"Action"})]})}),(0,W.jsx)(K.c,{children:0===d.length?(0,W.jsx)(D.c,{children:(0,W.jsx)(P.c,{colSpan:9,className:"fa-14 text-center",style:{textAlign:"center"},children:"No data found"})}):d.map(((e,a)=>(0,W.jsxs)(D.c,{children:[(0,W.jsx)(P.c,{className:"fa-13 text-center",children:e.EmployeeName||"N/A"}),(0,W.jsx)(P.c,{className:"fa-13 text-center",children:e.AssignedUser||"N/A"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:(0,W.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,W.jsx)($.c,{className:"fa-18 me-2"}),g(e.Est_Start_Dt)," - ",g(e.Est_End_Dt)]})}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:(0,W.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,W.jsx)(X.c,{className:"fa-18 me-2"}),e.Sch_Time||"N/A"," - ",e.EN_Time||"N/A"]})}),(0,W.jsx)(P.c,{className:"fa-13 text-center",children:e.Sch_Period||"N/A"}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:(0,W.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Timer_Based)?"bg-success":"bg-warning"),children:Number(e.Timer_Based)?"Yes":"No"})}),(0,W.jsx)(P.c,{className:"fa-14 text-center",children:(0,W.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Invovled_Stat)?"bg-success":"bg-danger"),children:Number(e.Invovled_Stat)?"IN":"OUT"})}),(0,W.jsx)(P.c,{className:"fa-13 text-center",children:e.Ord_By||"N/A"}),1===Number(null===j||void 0===j?void 0:j.Edit_Rights)&&(0,W.jsx)(P.c,{className:"fa-13 text-center",children:(0,W.jsxs)(c.c,{size:"small",onClick:()=>(h(e),void x(!0)),children:[(0,W.jsx)(m.c,{className:"fa-18"}),"Edit"]})})]},a)))})]})})})]}),p&&(0,W.jsx)(Y,{open:p,projectId:null===i||void 0===i?void 0:i.Project_Id,taskId:i,editData:i,onClose:()=>{x(!1),s()}})]})};var ae=s(18256),se=s(29720),te=s(61584);const ce=function(e){let{dialogOpen:a,setDialogOpen:s,projectid:o,reload:i,onReload:h,selectedProject:_}=e;const[y,j]=(0,t.useState)(!1),[q,O]=(0,t.useState)(!1),[B,F]=(0,t.useState)(!1),[M,L]=(0,t.useState)(null),[U,G]=(0,t.useState)([]),[H,Q]=(0,t.useState)([]),[V,Z]=(0,t.useState)(!1),[K,$]=(0,t.useState)({Sch_Type_Id:"",Sch_Type:""}),[X,ce]=(0,t.useState)([]),[re,ne]=(0,t.useState)(!1),le=JSON.parse(localStorage.getItem("user")),de=null===le||void 0===le?void 0:le.UserId,oe=null===le||void 0===le?void 0:le.Company_id,[ie,me]=(0,t.useState)(!1),[he,pe]=(0,t.useState)(null),[ue,xe]=(0,t.useState)(null),{contextObj:_e}=(0,t.useContext)(u.a),[ye,je]=(0,t.useState)(!1),[ge,ve]=(0,t.useState)(!1),[Te,be]=(0,t.useState)("1"),[Se,ke]=(0,t.useState)([]),fe=(e,a)=>{be(a)},Ie=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:"taskManagement/tasks/dropdown?Company_id=".concat(oe)});e.success?G(e.data):p.m4.error(e.message)}catch(e){console.error(e)}}),[oe]),Ne=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:"taskManagement/project/schedule/ListingDetails?Project_Id=".concat(o)});e.success?ce(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}}),[o]);(0,t.useEffect)((()=>{Ie(),Ne(),(async()=>{(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"}).then((e=>{e.success?(console.log("data.data",e.data),ke(e.data)):p.m4.error(e.message)}))})()}),[i,o,h]);const Ee=U.map((e=>({value:e.Task_Id,label:e.Task_Name}))),Ce=e=>{const a=Se.find((a=>a.Sch_Type_Id===parseInt(e.target.value)));a&&$((0,g.c)((0,g.c)({},K),{},{Sch_Type_Id:a.Sch_Type_Id,Sch_Type:a.Sch_Type}))};return(0,W.jsxs)(W.Fragment,{children:[ge&&(0,W.jsxs)(r.c,{open:ge,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},onClose:()=>ve(!1),children:[(0,W.jsx)(n.c,{children:ye?"Edit Task":"Assign Task"}),(0,W.jsx)(l.c,{children:(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,W.jsxs)("select",{value:K.Sch_Type_Id||"",onChange:Ce,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map(((e,a)=>(0,W.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a)))]})]})})}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)(v.c,{onClick:()=>ve(!1),children:"Cancel"}),(0,W.jsx)(v.c,{variant:"contained",color:"primary",onClick:()=>(async e=>{const a={Sch_Project_Id:e.Sch_Project_Id,Sch_Id:e.TaskSchId,schtypeid:K.Sch_Type_Id,Task_Id:e.Task_Id};try{const e=await(0,x.q)({address:"taskManagement/project/schedule/updateScheduleTaskUpdate",method:"PUT",bodyData:a});e.success?(p.m4.success(e.message),ve(!1),je(!1),h()):(e.status,p.m4.warn(e.message||"Task already exists for this project."))}catch(s){p.m4.error(s)}})(K),children:"Save"})]})]}),(0,W.jsxs)(r.c,{open:a,fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,W.jsx)(n.c,{children:(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsx)("span",{children:null===_||void 0===_?void 0:_.Project_Name}),(0,W.jsx)(v.c,{variant:"contained",color:"primary",onClick:()=>O(!0),children:"Assign Task"})]})}),(0,W.jsx)(T.c,{sx:{width:"100%",typography:"body1"},children:X.map(((e,a)=>{const s=JSON.parse(e.SchTypes);return(0,W.jsxs)(ae.cp,{value:Te,children:[(0,W.jsx)(T.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,W.jsx)(se.c,{onChange:fe,"aria-label":"Schedule Types",children:Array.isArray(s)&&s.length>0?s.map(((e,a)=>(0,W.jsx)(b.c,{label:e.SchType||"No SchType",value:(e.SchTypeId||a).toString(),id:"tab-".concat(e.SchTypeId||a),"aria-controls":"tabpanel-".concat(e.SchTypeId||a)},"".concat(e.SchTypeId||"index","-").concat(a)))):(0,W.jsxs)(S.c,{variant:"body2",color:"textSecondary",sx:{padding:2},children:["No Details Available for ",s]})})}),Array.isArray(s)&&s.map(((e,a)=>(0,W.jsxs)(te.c,{value:(e.SchTypeId||a).toString(),id:"tabpanel-".concat(e.SchTypeId||a),"aria-labelledby":"tab-".concat(e.SchTypeId||a),children:[(0,W.jsx)(T.c,{sx:{marginBottom:2,padding:2,backgroundColor:"#f9f9f9",borderRadius:"8px"},children:Array.isArray(e.TaskCountsInSchType)&&e.TaskCountsInSchType.length>0?e.TaskCountsInSchType.map(((a,s)=>(0,W.jsxs)(S.c,{variant:"body1",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,W.jsxs)(T.c,{children:["Schedule Type: ",(0,W.jsx)("strong",{children:e.SchType})]}),(0,W.jsxs)(T.c,{textAlign:"right",children:["Total Tasks: ",(0,W.jsx)("strong",{children:a.TotalTasks})," / Completed Tasks: ",(0,W.jsx)("strong",{children:a.CompletedTasks})]})]},s))):(0,W.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No tasks counted for this schedule type."})}),Array.isArray(e.TaskTypeGroups)&&e.TaskTypeGroups.length>0?e.TaskTypeGroups.map((a=>(0,W.jsxs)(k.c,{expanded:he===a.Task_Type_Id,onChange:()=>{return e=a.Task_Type_Id,void pe((a=>a===e?null:e));var e},sx:{backgroundColor:"#f0f4ff",boxShadow:"black"},children:[(0,W.jsxs)(f.c,{expandIcon:(0,W.jsx)(J.c,{}),children:[(0,W.jsx)(S.c,{fontWeight:"bold",children:a.Task_Type||"Default Task Type"}),(0,W.jsx)(T.c,{sx:{textAlign:"right",flexGrow:1},children:(0,W.jsxs)(S.c,{variant:"h6",children:[(0,W.jsx)(S.c,{fontWeight:"bold",children:"Completed Task / Total Task"}),Array.isArray(a.TaskMetrics)&&a.TaskMetrics.length>0?a.TaskMetrics.map(((e,a)=>(0,W.jsxs)(S.c,{sx:{textAlign:"right",flexGrow:1},children:[e.CompletedTasks," / ",null===e||void 0===e?void 0:e.TotalTasks]},a))):(0,W.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No task metrics available for this task type."})]})})]}),(0,W.jsx)(I.c,{children:Array.isArray(a.Tasks)&&a.Tasks.length>0?a.Tasks.map((a=>(0,W.jsxs)(k.c,{expanded:ue===a.Task_Id,onChange:()=>{return e=a.Task_Id,void xe((a=>a===e?null:e));var e},sx:{marginBottom:2},children:[(0,W.jsx)(f.c,{expandIcon:(0,W.jsx)(J.c,{}),children:(0,W.jsx)(T.c,{sx:{textAlign:"left",flexGrow:1},children:(0,W.jsx)(S.c,{fontWeight:"bold",children:(null===a||void 0===a?void 0:a.Task_Name)||"DEFAULT TASK"})})}),(0,W.jsx)(I.c,{children:(0,W.jsx)(N.c,{style:{maxHeight:"50vh"},children:(0,W.jsxs)(E.c,{stickyHeader:!0,children:[(0,W.jsx)(C.c,{style:{backgroundColor:"#2C3E50"},children:(0,W.jsxs)(D.c,{style:{backgroundColor:"#2C3E50"},children:[(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task"}),(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task Type"}),(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employees"}),(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employee Assign"}),(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Actions"}),(0,W.jsx)(P.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Details"})]})}),(0,W.jsxs)(D.c,{sx:{backgroundColor:"#BBE6F6"},children:[(0,W.jsx)(P.c,{children:a.Task_Name}),(0,W.jsxs)(P.c,{children:[e.SchType,(0,W.jsx)(c.c,{onClick:()=>{return e=a,je(!0),$(e),void ve(!0);var e},children:(0,W.jsx)(m.c,{})})]}),(0,W.jsx)(P.c,{children:Array.isArray(a.AssignedEmployees)&&a.AssignedEmployees.length>0?a.AssignedEmployees.map(((e,a)=>(0,W.jsx)(w.c,{label:e.Name,variant:"outlined",size:"small",sx:{margin:"2px",color:"green"}},a))):(0,W.jsx)("span",{children:"No Employees Assigned"})}),(0,W.jsx)(P.c,{children:(0,W.jsx)(c.c,{onClick:()=>(async e=>{L(e),F(!0)})(a),children:(0,W.jsx)(A.c,{})})}),1===Number(null===_e||void 0===_e?void 0:_e.Edit_Rights)&&(0,W.jsx)(P.c,{children:(0,W.jsx)(c.c,{onClick:()=>(L(a),void me(!0)),children:(0,W.jsx)(m.c,{})})}),(0,W.jsx)(P.c,{children:(0,W.jsx)(c.c,{onClick:()=>(async e=>{if(Z(!0),e.Task_Id&&o)try{const a=await(0,x.q)({address:"masters/employeedetails/assignedTaskDetails?Task_Id=".concat(e.Task_Id,"&ProjectId=").concat(o,"&LevelId=").concat(e.Task_Levl_Id)});a.success?Q(a.data):console.error(a.message)}catch(a){console.error("Error fetching task details:",a)}else p.m4.error("Task ID and Project ID are required")})(a),children:(0,W.jsx)(R.c,{})})})]},a.Task_Id)]})})})]},a.Task_Id))):(0,W.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No tasks available for this task type."})})]},a.Task_Type_Id))):(0,W.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No task type groups found for this schedule type."})]},"".concat(e.SchTypeId||"index","-").concat(a))))]},a)}))}),(0,W.jsx)(d.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,W.jsx)(v.c,{variant:"contained",color:"primary",onClick:async()=>{s(!1),$({})},children:"Close"})})]}),(0,W.jsxs)(r.c,{open:q,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,W.jsx)(n.c,{children:"Assign Task"}),(0,W.jsxs)(l.c,{children:[(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,W.jsxs)("select",{id:"task-select",value:K.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{$((a=>(0,g.c)((0,g.c)({},a),{},{Task_Id:e.value,TasksGet:e.label})));try{const a=await(0,x.q)({address:"taskManagement/tasks/tasklistsid?Task_Id=".concat(e.value)});if(a.success){const e=a.data;$((a=>(0,g.c)((0,g.c)({},a),{},{Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Sch_Type_Id:e.Sch_Type_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()})))}else p.m4.error("Failed to fetch task details")}catch(a){p.m4.error(a)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),Ee.map(((e,a)=>(0,W.jsx)("option",{value:e.value,children:e.label},a)))]}),(0,W.jsx)(c.c,{onClick:()=>j(!0),children:(0,W.jsx)(v.c,{variant:"contained",color:"primary",children:"Create New"})})]})}),(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,W.jsxs)("select",{value:K.Sch_Type_Id||"",onChange:Ce,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map(((e,a)=>(0,W.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a)))]})]})})]}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)(v.c,{onClick:()=>O(!1),children:"Cancel"}),(0,W.jsx)(v.c,{variant:"contained",color:"primary",onClick:async()=>{if(!K.Task_Id||!K.Sch_Type_Id)return void p.m4.error("Please select a task and schedule type before saving.");const e={entryBy:de,Project_Id:o,Sch_Type_Id:K.Sch_Type_Id,Sch_Est_Start_Date:K.Task_Est_Start_Date,Sch_Est_End_Date:K.Task_Est_End_Date,tasks:[K]};try{const a=await(0,x.q)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e});a.success?(p.m4.success(a.message),O(!1),$({}),Ne(),h()):(a.status,p.m4.warn(a.message||"Task already exists for this project."))}catch(a){p.m4.error(a)}},children:"Save"})]})]}),(0,W.jsx)(Y,{open:B,onClose:()=>F(!1),task:M,projectId:o,entryBy:de,taskId:M,reload:i,onReload:h}),(0,W.jsxs)(r.c,{open:re,onClose:()=>ne(!1),children:[(0,W.jsx)(n.c,{children:"Delete Task"}),(0,W.jsx)(d.c,{children:(0,W.jsx)(v.c,{onClick:()=>ne(!1),color:"primary",children:"Cancel"})})]}),(0,W.jsx)(z,{openAction:y,onCloseFun:()=>j(!1),onTaskAdded:Ie,Reload:i}),(0,W.jsx)(z,{row:M,openAction:ie,onCloseFun:()=>me(!1),reload:Ne,Reload:i}),(0,W.jsx)(ee,{open:V,onClose:()=>Z(!1),taskDetails:H})]})},re=()=>{const[e,a]=(0,t.useState)(!1),[s,g]=(0,t.useState)([]),[v,T]=(0,t.useState)([]),{contextObj:b}=(0,t.useContext)(u.a),[S,k]=(0,t.useState)(!1),[f,I]=(0,t.useState)(null),[N,E]=(0,t.useState)(!1),[C,D]=(0,t.useState)(0),[P,w]=(0,t.useState)(!1),[A,R]=(0,t.useState)(null),[q,O]=(0,t.useState)(!1),[B,F]=(0,t.useState)(!1),[M,L]=(0,t.useState)(""),[U,G]=(0,t.useState)(!1),H=JSON.parse(localStorage.getItem("user"));(0,t.useEffect)((()=>{J(),Q()}),[null===H||void 0===H?void 0:H.Company_id,e]);const z=()=>{a((e=>!e)),G((e=>!e))},J=async()=>{try{const e=await(0,x.q)({address:"taskManagement/project/newProjectAbstract?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});g(e.success?e.data:[])}catch(e){console.error(e),g([])}},Q=async()=>{try{const e=await(0,x.q)({address:"taskManagement/project?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});T(e.success?e.data:[])}catch(e){console.error(e),T([])}},V=()=>{A&&(0,x.q)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===A||void 0===A?void 0:A.Project_Id}}).then((s=>{s.success?(a(!e),p.m4.success(s.message)):p.m4.error(s.message)})).catch((e=>console.error("Fetch Error:",e))),w(!1)},Y=[{name:"Project",selector:e=>e.Project_Name,sortable:!0,width:"250px"},{name:"Head",selector:e=>{var a;return null===(a=v.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Project_Head_Name},sortable:!0},{name:"Status",selector:e=>{var a;return null===(a=v.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Status},sortable:!0},{name:"End Date",selector:e=>e.Est_End_Dt?new Date(e.Est_End_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"Progress",selector:e=>{return"".concat((a=e.TodayTaskcounts,s=e.CompletedTasks,0===Number(a)?0:(Number(s)/Number(a)*100).toFixed(0)),"%");var a,s},sortable:!0},{name:"Task Details",cell:e=>(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(c.c,{onClick:()=>$(e),children:(0,W.jsx)(o.c,{})}),e.CompletedTasks," / ",e.TodayTaskcounts]})},{name:"Task Count",selector:e=>null===e||void 0===e?void 0:e.TodayTaskcounts,sortable:!0,sortable:!0},{name:"Assigned",selector:e=>e.TasksAssignedToEmployee},{name:"Employees",cell:e=>(0,W.jsxs)(W.Fragment,{children:[1===Number(null===b||void 0===b?void 0:b.Add_Rights)&&(0,W.jsx)(c.c,{onClick:()=>ee(e.Project_Id),children:(0,W.jsx)(i.c,{})}),e.EmployeesInvolved]})},{name:"Actions",cell:e=>(0,W.jsx)(W.Fragment,{children:1===Number(null===b||void 0===b?void 0:b.Edit_Rights)&&(0,W.jsx)(c.c,{onClick:()=>K(e),children:(0,W.jsx)(m.c,{})})})}],Z=s.filter((e=>{var a,s;const t=(null===(a=v.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Project_Head_Name)||"",c=(null===(s=v.find((a=>a.Project_Id===e.Project_Id)))||void 0===s?void 0:s.Status)||"";return e.Project_Name.toLowerCase().includes(M.toLowerCase())||t.toLowerCase().includes(M.toLowerCase())||c.toLowerCase().includes(M.toLowerCase())})),K=e=>{I(e),E(!0),k(!0)},$=e=>{I(e),D(e.Project_Id),F(!0)},X=()=>{k(!1),F(!1),I(null),R(null),w(!1)},ee=e=>{D(e),O(!0)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"fw-bold d-flex align-items-center justify-content-between mt-0 ",children:[(0,W.jsx)("span",{style:{marginLeft:"20px"},children:"Projects"}),(0,W.jsxs)("div",{className:"mb-1",style:{display:"flex",alignItems:"center"},children:[(0,W.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,W.jsx)(h.c,{style:{position:"absolute",left:15,color:"#aaa"}}),(0,W.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>L(e.target.value),style:{paddingLeft:35,marginRight:10,margin:10,borderRadius:4,border:"1px solid black"}})]}),1===Number(null===b||void 0===b?void 0:b.Add_Rights)&&(0,W.jsx)("button",{onClick:()=>{I(null),E(!1),k(!0)},className:"btn btn-primary fa-13 shadow",children:"Create Project"})]})]}),(0,W.jsxs)("div",{className:"card-body p-0 table-container",children:[(0,W.jsx)(j.cp,{columns:Y,data:Z,pagination:!0,highlightOnHover:!0,fixedHeader:!0,paginationPerPage:15,responsive:!0,persistTableHead:!0,customStyles:{headCells:{style:{fontSize:"16px",fontWeight:"bold",padding:"10px",backgroundColor:"#2c3e50",color:"#ecf0f1",position:"sticky",top:0,zIndex:2}},cells:{style:{padding:"8px",fontSize:"14px",backgroundColor:"#f9f9f9",color:"#2c3e50"}},rows:{style:{borderBottom:"1px solid #ddd"}}},style:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"}}),(0,W.jsxs)(r.c,{open:P,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,W.jsx)(n.c,{className:"bg-danger text-white mb-2 px-3 py-2",style:{fontSize:"18px"},children:"Confirm Deletion"}),(0,W.jsxs)(l.c,{className:"p-4",style:{fontSize:"16px"},children:["Are you sure you want to delete the project",(0,W.jsx)("span",{className:"text-primary",children:" "+(null===A||void 0===A?void 0:A.Project_Name)+" "}),"?"]}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)("button",{onClick:()=>w(!1),className:"btn btn-secondary fa-13 shadow",style:{background:"#95a5a6",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Cancel"}),(0,W.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",style:{background:"#e74c3c",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Delete"})]})]})]}),(0,W.jsx)(ce,{onClose:X,dialogOpen:B,setDialogOpen:F,isEdit:!1,parseData:H,projectid:C,onReload:z,selectedProject:f,reload:e}),(0,W.jsx)(_.c,{open:S,onClose:X,inputValue:f,isEdit:N,setReload:z,projectData:C}),(0,W.jsx)(y.c,{open:q,onClose:()=>O(!1),projectId:C,onReload:z}),(0,W.jsxs)(r.c,{open:P,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,W.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,W.jsxs)(l.c,{className:"p-4",children:["Do you want to delete the project",(0,W.jsx)("span",{className:"text-primary",children:" "+(null===A||void 0===A?void 0:A.Project_Name)+" "}),"?"]}),(0,W.jsxs)(d.c,{children:[(0,W.jsx)("button",{onClick:()=>w(!1),className:"btn btn-secondary fa-13 shadow",children:"Cancel"}),(0,W.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",children:"Delete"})]})]})]})}},8436:(e,a,s)=>{s.d(a,{c:()=>u});var t=s(30800),c=s(69060),r=s(82656),n=s(26773),l=s(4488),d=s(90048),o=s(1908),i=s(56480),m=(s(21680),s(64568)),h=s(39308),p=s(82496);const u=e=>{let{open:a,onClose:s,inputValue:u,isEdit:x,setReload:_}=e;const y=localStorage.getItem("user"),j=JSON.parse(y),[g,v]=(0,c.useState)([]),[T,b]=(0,c.useState)([]),[S,k]=(0,c.useState)({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,h.Q7)(),Est_End_Dt:(0,h.Q7)(),Project_Status:"",Entry_By:null===j||void 0===j?void 0:j.UserId,Company_id:null===j||void 0===j?void 0:j.Company_id});(0,c.useEffect)((()=>{(0,o.q)({address:"masters/users/employee/dropDown?Company_id=".concat(null===j||void 0===j?void 0:j.Company_id)}).then((e=>{v(e.success?e.data:[])})).catch((e=>console.error("Fetch Error:",e)))}),[null===j||void 0===j?void 0:j.Company_id]),(0,c.useEffect)((()=>{(0,o.q)({address:"taskManagement/statusList"}).then((e=>{e.success&&b(e.data)})).catch((e=>console.error("Fetch Error:",e)))}),[]),(0,c.useEffect)((()=>{a&&(x&&u?k((0,t.c)((0,t.c)({},u),{},{Project_Head:null===u||void 0===u?void 0:u.Project_Head_Id,Est_Start_Dt:u.Est_Start_Dt?(0,h.Q7)(u.Est_Start_Dt):"",Est_End_Dt:u.Est_End_Dt?(0,h.Q7)(u.Est_End_Dt):"",Project_Status:(null===u||void 0===u?void 0:u.Project_Status)||"",Project_Desc:(null===u||void 0===u?void 0:u.Project_Desc)||"-"})):x||k({Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,h.Q7)(),Est_End_Dt:(0,h.Q7)(),Project_Status:"",Entry_By:null===j||void 0===j?void 0:j.UserId,Company_id:null===j||void 0===j?void 0:j.Company_id}))}),[u,a,x]);const f=e=>{k((0,t.c)((0,t.c)({},S),{},{[e.target.name]:e.target.value}))},I=()=>{const e=["Project_Name","Project_Head","Est_Start_Dt","Est_End_Dt","Project_Status"];for(const a of e)if(!S[a])return i.m4.error("".concat(a.replace(/_/g," ")," is required")),!1;return!0},N=[{label:"Project Name",elem:"input",type:"text",required:!0,name:"Project_Name",value:S.Project_Name||""},{label:"Project Head",elem:"select",options:g.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))),required:!0,name:"Project_Head",value:S.Project_Head||""},{label:"Estimated Start Date",elem:"input",type:"date",required:!0,name:"Est_Start_Dt",value:S.Est_Start_Dt||""},{label:"Estimated End Date",elem:"input",type:"date",required:!0,name:"Est_End_Dt",value:S.Est_End_Dt||""},{label:"Project Status",elem:"select",options:T.map((e=>({value:e.Status_Id,label:e.Status}))),required:!0,name:"Project_Status",value:S.Project_Status||""},{label:"Description",elem:"textarea",name:"Project_Desc",value:S.Project_Desc||" "}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(r.c,{open:a,onClose:s,children:[(0,p.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:x?"Edit Project":"Create Project"}),(0,p.jsx)(l.c,{children:(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x?I()&&(0,o.q)({address:"taskManagement/project",method:"PUT",bodyData:S}).then((e=>{e.success?(s(),_((e=>!e)),i.m4.success(e.message)):i.m4.error(e.message)})).catch((e=>console.error("Fetch Error:",e))):(()=>{if(!I())return;const e=(0,t.c)((0,t.c)({},S),{},{Company_id:j.Company_id});(0,o.q)({address:"taskManagement/project",method:"POST",bodyData:e}).then((e=>{e.success?(s(),_((e=>!e)),i.m4.success(e.message)):i.m4.error(e.message)})).catch((e=>{console.error("Fetch Error:",e),i.m4.error("An error occurred while creating the project.")}))})()},children:[(0,p.jsx)("div",{className:"row",children:N.map(((e,a)=>(0,p.jsxs)("div",{className:"col-lg-4 mb-3",children:[(0,p.jsxs)("label",{children:[e.label," ",e.required&&(0,p.jsx)(m.c,{})]}),"textarea"===e.elem?(0,p.jsx)("textarea",{name:e.name,className:"cus-inpt",value:e.value,onChange:f}):"select"===e.elem?(0,p.jsxs)("select",{name:e.name,className:"cus-inpt",value:e.value,onChange:f,children:[(0,p.jsx)("option",{value:"",children:"Select"}),e.options&&e.options.map(((e,a)=>(0,p.jsx)("option",{value:e.value,children:e.label},a)))]}):(0,p.jsx)("input",{type:e.type,name:e.name,className:"cus-inpt",value:e.value,onChange:f})]},a)))}),(0,p.jsxs)(d.c,{children:[(0,p.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:s,children:"Cancel"}),(0,p.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:x?"Update":"Submit"})]})]})})]})})}},45108:(e,a,s)=>{s.d(a,{c:()=>k});var t=s(30800),c=s(69060),r=s(82656),n=s(90048),l=s(89e3),d=s(4488),o=s(99904),i=s(33856),m=s(58612),h=s(27454),p=s(700),u=s(29504),x=s(26773),_=s(71448),y=s(44380),j=s(1908),g=s(56480),v=s(12572),T=s(77536),b=s(76552),S=s(82496);const k=e=>{let{open:a,onClose:s,projectId:k,onReload:f}=e;const I={Name:"",Designation_Name:"",BranchName:""},[N,E]=(0,c.useState)(I),[C,D]=(0,c.useState)(!0),[P,w]=(0,c.useState)(!1),[A,R]=(0,c.useState)([]),[q,O]=(0,c.useState)([]),B=localStorage.getItem("user"),F=JSON.parse(B),{contextObj:M}=(0,c.useContext)(T.a);(0,c.useEffect)((()=>{a&&k&&(L(),U(),W())}),[a,k]);const L=async()=>{D(!0);try{const e=await(0,j.q)({address:"masters/Employeedetails?Project_Id=".concat(k)});e.success&&E(e.data)}catch(e){console.error(e),g.m4.error("Failed to fetch employee details")}finally{D(!1)}},U=async()=>{D(!0);try{const e=await(0,j.q)({address:"masters/Employeedetails/dropDown?Company_id=".concat(F.Company_id)});e.success&&R(e.data)}catch(e){console.error(e),g.m4.error("Failed to fetch employees for dropdown")}finally{D(!1)}},W=async()=>{D(!0);try{const e=await(0,j.q)({address:"masters/Employeedetails?Project_Id=".concat(k)});e.success&&O(e.data)}catch(e){console.error(e),g.m4.error("Failed to fetch assigned employees")}finally{D(!1)}},G=()=>{s(),E(I)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(r.c,{open:a,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsxs)(v.c,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,marginInlineStart:2,children:[(0,S.jsx)("span",{children:"Employee Details"}),(0,S.jsx)(n.c,{children:(0,S.jsx)(l.c,{variant:"contained",color:"primary",onClick:()=>{w(!0)},sx:{mr:1},children:"Add"})})]}),(0,S.jsx)(d.c,{children:C?(0,S.jsx)("p",{children:"Loading..."}):(0,S.jsx)(o.c,{children:(0,S.jsxs)(i.c,{children:[(0,S.jsx)(m.c,{children:(0,S.jsxs)(h.c,{children:[(0,S.jsx)(p.c,{children:"Employee Name"}),(0,S.jsx)(p.c,{children:"Position"}),(0,S.jsx)(p.c,{children:"Department"})]})}),(0,S.jsx)(u.c,{children:Array.isArray(N)&&N.length>0?N.map((e=>(0,S.jsxs)(h.c,{children:[(0,S.jsx)(p.c,{children:e.Name||"N/A"}),(0,S.jsx)(p.c,{children:e.Designation_Name||"-"}),(0,S.jsx)(p.c,{children:e.BranchName||"-"})]},e.EmployeeId||e.UserId))):(0,S.jsx)(h.c,{children:(0,S.jsx)(p.c,{colSpan:3,children:"No data available"})})})]})})}),(0,S.jsx)(n.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,S.jsx)(l.c,{variant:"contained",color:"primary",onClick:G,children:"Close"})})]}),(0,S.jsxs)(r.c,{open:P,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsx)(x.c,{children:"Add Employee"}),(0,S.jsx)(d.c,{children:(0,S.jsx)(_.c,{multiple:!0,options:A,getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,a)=>e.UserId===a.UserId,onChange:(e,a)=>{const s=a.filter(((e,a,s)=>a===s.findIndex((a=>a.UserId===e.UserId))));O(s)},PopperComponent:e=>(0,S.jsx)(b.c,(0,t.c)((0,t.c)({},e),{},{placement:"top"})),value:q,onClose:onclose,renderInput:e=>(0,S.jsx)(y.c,(0,t.c)((0,t.c)({},e),{},{placeholder:"Employees"}))})}),(0,S.jsxs)(n.c,{children:[(0,S.jsx)(l.c,{onClick:()=>{w(!1),G(),E(I)},children:"Cancel"}),(0,S.jsx)(l.c,{onClick:async()=>{if(1===Number(null===M||void 0===M?void 0:M.Add_Rights))try{(await(0,j.q)({address:"masters/Employeedetails/employeeAdd",method:"POST",bodyData:{Project_Id:k,UserIds:q.map((e=>e.UserId))}})).success?(g.m4.success("Employees added successfully"),w(!1),await L(),await W(),f()):g.m4.error("Failed to add employees")}catch(e){console.error(e),g.m4.error("Error adding employees")}},variant:"contained",color:"primary",children:"Add"})]})]})]})}}}]);
//# sourceMappingURL=6056.0800743d.chunk.js.map