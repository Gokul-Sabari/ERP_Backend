"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8076],{38076:(e,a,i)=>{i.r(a),i.d(a,{default:()=>p});var t=i(30800),l=i(69060),r=i(43692),s=i(84436),d=i(3358),o=i(5548),n=i(39308),c=i(50764),_=i(13724),u=i(82496);const v=e=>{let{dataArray:a}=e;const[i,r]=(0,l.useState)([]);return(0,l.useEffect)((()=>{const e=(Array.isArray(a)?[...a]:[]).map((e=>{var a,i,l,r,s;return(0,t.c)((0,t.c)({},e),{},{M2_Avg:null!==(a=e.ALL_Avg_M2)&&void 0!==a?a:0,M3_Avg:null!==(i=e.ALL_Avg_M3)&&void 0!==i?i:0,M6_Avg:null!==(l=e.ALL_Avg_M6)&&void 0!==l?l:0,M9_Avg:null!==(r=e.ALL_Avg_M9)&&void 0!==r?r:0,M12_Avg:null!==(s=e.ALL_Avg_One_Year)&&void 0!==s?s:0,Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty"),StockTransaction:e.StockTransaction.map((e=>{var a,i,l,r,s;return(0,t.c)((0,t.c)({},e),{},{M2_Avg:null!==(a=e.M2_AVG_Qty)&&void 0!==a?a:0,M3_Avg:null!==(i=e.M3_AVG_Qty)&&void 0!==i?i:0,M6_Avg:null!==(l=e.M6_AVG_Qty)&&void 0!==l?l:0,M9_Avg:null!==(r=e.M9_AVG_Qty)&&void 0!==r?r:0,M12_Avg:null!==(s=e.One_Year_AVG_Qty)&&void 0!==s?s:0})}))})})).map((e=>(0,t.c)((0,t.c)({},e),{},{Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty")})));r(e)}),[a]),(0,u.jsx)(l.Fragment,{children:(0,u.jsx)(_.cp,{dataArray:i,isExpendable:!0,columns:[{Field_Name:"Stock_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"Billed_Qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}],expandableComp:e=>{let{row:a}=e;return(0,u.jsx)(_.cp,{initialPageCount:10,dataArray:Array.isArray(a.StockTransaction)?a.StockTransaction:[],columns:[{Field_Name:"Item_Name_Modified",isVisible:1,Fied_Data:"string"},{Field_Name:"bill_qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}]})},tableMaxHeight:540})})},m=e=>{let{dataArray:a,days:i}=e;const[r,s]=(0,l.useState)([]);return(0,l.useEffect)((()=>{const e=(Array.isArray(a)?[...a]:[]).map((e=>{var a,l,r,s,d;return(0,t.c)((0,t.c)({},e),{},{M2_Avg:null!==(a=(0,n.yy)(e.ALL_Avg_M2,(0,n.W8)(2)/2))&&void 0!==a?a:0,M3_Avg:null!==(l=(0,n.yy)(e.ALL_Avg_M3,(0,n.W8)(3)/3))&&void 0!==l?l:0,M6_Avg:null!==(r=(0,n.yy)(e.ALL_Avg_M6,(0,n.W8)(6)/6))&&void 0!==r?r:0,M9_Avg:null!==(s=(0,n.yy)(e.ALL_Avg_M9,(0,n.W8)(9)/9))&&void 0!==s?s:0,M12_Avg:null!==(d=(0,n.yy)(e.ALL_Avg_One_Year,(0,n.W8)(12)/12))&&void 0!==d?d:0,Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty"),Billed_Avg:(0,n.SW)(e.StockTransaction,"bill_qty")/i,StockTransaction:e.StockTransaction.map((e=>{var a,i,l,r,s;return(0,t.c)((0,t.c)({},e),{},{Grade_Item_Group:e.Item_Name_Modified,M2_Avg:null!==(a=(0,n.yy)(e.M2_AVG_Qty,(0,n.W8)(2)/2))&&void 0!==a?a:0,M3_Avg:null!==(i=(0,n.yy)(e.M3_AVG_Qty,(0,n.W8)(3)/3))&&void 0!==i?i:0,M6_Avg:null!==(l=(0,n.yy)(e.M6_AVG_Qty,(0,n.W8)(6)/6))&&void 0!==l?l:0,M9_Avg:null!==(r=(0,n.yy)(e.M9_AVG_Qty,(0,n.W8)(9)/9))&&void 0!==r?r:0,M12_Avg:null!==(s=(0,n.yy)(e.One_Year_AVG_Qty,(0,n.W8)(12)/12))&&void 0!==s?s:0})}))})})).map((e=>(0,t.c)((0,t.c)({},e),{},{Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty")})));s(e)}),[a]),(0,u.jsx)(l.Fragment,{children:(0,u.jsx)(_.cp,{dataArray:r,isExpendable:!0,columns:[{Field_Name:"Stock_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"Billed_Qty",isVisible:1,Fied_Data:"number"},{Field_Name:"Billed_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}],expandableComp:e=>{let{row:a}=e;return(0,u.jsx)(_.cp,{initialPageCount:10,dataArray:Array.isArray(a.StockTransaction)?a.StockTransaction:[],columns:[{Field_Name:"Grade_Item_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"bill_qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}]})},tableMaxHeight:540})})};var A=i(31664),y=i(61988),g=i(1908);const b=e=>{let{row:a,Fromdate:i,Todate:r,DB:s}=e;const[d,o]=(0,l.useState)([]),[n,_]=(0,l.useState)([]);return(0,l.useEffect)((()=>{(0,g.q)({address:"reports/salesReport/ledger/itemDetails?Fromdate=".concat(i,"&Todate=").concat(r,"&Ledger_Id=").concat(null===a||void 0===a?void 0:a.Ledger_Tally_Id),headers:{Db:s}}).then((e=>{let{success:a,data:i,others:l}=e;if(a){const{dataTypeInfo:e}=l;o(i),_((a=>(0,t.c)((0,t.c)({},a),{},{salesInfo:Array.isArray(e)?e:[]})))}else o([])})).catch(console.error)}),[null===a||void 0===a?void 0:a.Ledger_Tally_Id,i,r]),(0,u.jsx)(c.c,{dataArray:d,columns:n.salesInfo})},p=()=>{const e=JSON.parse(localStorage.getItem("user")),[a,i]=(0,l.useState)(null),[_,p]=(0,l.useState)({salesInfo:[],salesItemInfo:[]}),[F,M]=(0,l.useState)(null),[D,x]=(0,l.useState)({Fromdate:(0,n.SO)(1),Todate:(0,n.Q7)(),ReportType:"LedgerBased",filterDialog:!1,reload:!0});(0,l.useEffect)((()=>{i(null),M(null),p({salesInfo:[],salesItemInfo:[]}),(0,g.q)({address:"reports/salesReport/ledger?Fromdate=".concat(null===D||void 0===D?void 0:D.Fromdate,"&Todate=").concat(null===D||void 0===D?void 0:D.Todate),headers:{Db:null===e||void 0===e?void 0:e.Company_id}}).then((e=>{let{success:a,data:l,others:r}=e;if(a){const{dataTypeInfo:e}=r;i(l),p((a=>(0,t.c)((0,t.c)({},a),{},{salesInfo:Array.isArray(e)?e:[]})))}else i([])})).catch(console.error),(0,g.q)({address:"reports/salesReport/products?Fromdate=".concat(null===D||void 0===D?void 0:D.Fromdate,"&Todate=").concat(null===D||void 0===D?void 0:D.Todate),headers:{Db:null===e||void 0===e?void 0:e.Company_id}}).then((e=>{if(e.success){var a;const{dataTypeInfo:i}=null===e||void 0===e?void 0:e.others,l=Array.isArray(null===e||void 0===e||null===(a=e.others)||void 0===a?void 0:a.LOSAbstract)?e.others.LOSAbstract.map((a=>(0,t.c)((0,t.c)({},a),{},{StockTransaction:Array.isArray(e.data)?[...e.data].filter((e=>e.Stock_Group===a.Stock_Group)):[]}))):[];p((e=>(0,t.c)((0,t.c)({},e),{},{salesItemInfo:Array.isArray(i)?i:[]}))),M(l)}else M([])})).catch((e=>console.error(e)))}),[D.reload]);const h=()=>{x((e=>(0,t.c)((0,t.c)({},e),{},{filterDialog:!1})))},N=(0,n.Oe)(new Date(D.Fromdate),new Date(D.Todate));return(0,u.jsx)(l.Fragment,{children:(0,u.jsxs)(r.c,{className:"mt-3",children:[(0,u.jsxs)("div",{className:"px-3 py-2 d-flex justify-content-between align-items-center fw-bold text-dark",style:{backgroundColor:"#eae0cc"},children:[(0,u.jsx)("span",{children:null===e||void 0===e?void 0:e.Company_Name}),(0,u.jsx)("span",{children:(0,u.jsxs)("select",{value:D.ReportType,className:"cus-inpt ps-3 w-100 rounded-5 border-0",onChange:e=>x((a=>(0,t.c)((0,t.c)({},a),{},{ReportType:e.target.value}))),children:[(0,u.jsx)("option",{value:"LedgerBased",children:"Ledger Based"}),(0,u.jsx)("option",{value:"ProductBased",children:"Product Based"}),(0,u.jsx)("option",{value:"ProductDayAverage",children:"Product/Day Based"})]})})]}),(0,u.jsxs)(s.c,{children:[(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5 me-1",value:D.Fromdate,onChange:e=>x((a=>(0,t.c)((0,t.c)({},a),{},{Fromdate:e.target.value})))}),(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5",value:D.Todate,onChange:e=>x((a=>(0,t.c)((0,t.c)({},a),{},{Todate:e.target.value})))}),(0,u.jsx)(d.c,{title:"Reload Data",children:(0,u.jsx)(o.c,{onClick:()=>x((e=>(0,t.c)((0,t.c)({},e),{},{reload:!e.reload}))),size:"small",className:"ms-2",children:(0,u.jsx)(A.c,{})})}),(0,u.jsx)(d.c,{title:"Filters",children:(0,u.jsx)(o.c,{onClick:()=>x((e=>(0,t.c)((0,t.c)({},e),{},{filterDialog:!0}))),size:"small",className:"d-md-none d-inline",children:(0,u.jsx)(y.c,{})})})]}),null===a&&"LedgerBased"===D.ReportType&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Ledger Based data..."}),null===F&&("ProductBased"===D.ReportType||"ProductDayAverage"===D.ReportType)&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Product Based data..."}),"LedgerBased"===D.ReportType&&Array.isArray(a)&&(0,u.jsx)(c.c,{dataArray:a,columns:_.salesInfo,ExpandableComp:a=>{let{row:i}=a;return(0,u.jsx)(b,{row:i,DB:null===e||void 0===e?void 0:e.Company_id,Fromdate:null===D||void 0===D?void 0:D.Fromdate,Todate:null===D||void 0===D?void 0:D.Todate})},enableFilters:!0}),"ProductBased"===D.ReportType&&Array.isArray(F)&&(0,u.jsx)(v,{filterDialog:D.filterDialog,closeDialog:h,dataArray:F}),"ProductDayAverage"===D.ReportType&&Array.isArray(F)&&(0,u.jsx)(m,{filterDialog:D.filterDialog,closeDialog:h,dataArray:F,days:N})]})]})})}}}]);
//# sourceMappingURL=8076.9c0bce10.chunk.js.map