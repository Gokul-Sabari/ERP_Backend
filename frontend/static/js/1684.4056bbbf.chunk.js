"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[1684],{62344:(e,t,a)=>{a.d(t,{o$:()=>r,o5:()=>i,cF:()=>s,iI:()=>o});var n=a(30800);const l=a.p+"static/media/smt.aa4d4f940bbebff07a57.png",o={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},s={menu:(e,t)=>(0,n.c)((0,n.c)({},e),{},{zIndex:9999}),menuPortal:e=>(0,n.c)((0,n.c)({},e),{},{zIndex:9999}),groupHeading:e=>(0,n.c)((0,n.c)({},e),{},{backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold",fontSize:"14px",padding:"8px 12px",borderBottom:"1px solid #ddd",textTransform:"uppercase"}),option:(e,t)=>(0,n.c)((0,n.c)({},e),{},{backgroundColor:t.isSelected?"#2684FF":t.isFocused?"#E2ECF9":"white",color:t.isSelected?"white":"#333",padding:"10px 12px"})},r=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],i=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:l,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:l,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:l,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}]},27112:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(30800),l=a(69060),o=a(5548),s=a(82656),r=a(26773),i=a(4488),c=a(90048),d=a(40656),m=a(62344),u=a(39308),p=a(57704),h=a(31664),v=a(1908),x=a(13724),y=a(77536),g=a(51560),f=a(27532),b=a(89e3),D=a(71448),j=a(44380),C=a(43692),S=a(84436),A=a(56480),T=a(35832),N=a(82496);const E=e=>{var t,a;let{loadingOn:E,loadingOff:I}=e;const w=JSON.parse(localStorage.getItem("user")),F=(0,g.i6)(),L=(0,g.IT)(),M=L.state,[_,k]=(0,l.useState)(!1),P=()=>{const e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0");return"".concat(t,"-").concat(a)},O={From:P(),To:P(),EmpId:"0",Name:"ALL"},U=new URLSearchParams((0,g.IT)().search),R={From:P(),To:P()},[z,W]=(0,l.useState)([]),[B,H]=(0,l.useState)("default"),[q,$]=(0,l.useState)([]),[J,V]=(0,l.useState)([]),[Y,Q]=(0,l.useState)(!1),[G,Z]=(0,l.useState)([]),[K,X]=(0,l.useState)(!0),[ee,te]=(0,l.useState)(!1),[ae,ne]=(0,l.useState)([]),[le,oe]=(0,l.useState)(null),se=null===w||void 0===w?void 0:w.UserTypeId,re=w,{contextObj:ie}=(0,l.useContext)(y.a),[ce,de]=(0,l.useState)("ALL"),[me,ue]=(0,l.useState)(O),[pe,he]=(0,l.useState)(me);(0,l.useEffect)((()=>{const e=setTimeout((()=>{he(me)}),500);return()=>clearTimeout(e)}),[me]),(0,l.useEffect)((()=>{const{From:e,EmpId:t}=pe;e&&(t||0===t)&&(Me(e,t),Le())}),[pe]);const ve=e=>{if(!e)return 0;const[t,a]=e.split("-");return new Date(t,a,0).getDate()},[xe,ye]=(0,l.useState)({FromDate:(new Date).toISOString().split("T")[0],ToDate:(new Date).toISOString().split("T")[0],Cancel_status:0}),[ge,fe]=(0,l.useState)([]),[be,De]=(0,l.useState)(null),[je,Ce]=(0,l.useState)([]),Se=null===ie||void 0===ie?void 0:ie.Add_Rights;(0,l.useEffect)((()=>{E&&E();const e=(new Date).toISOString().split("T")[0],t=xe.FromDate||e,a=xe.ToDate||e;(0,v.q)({address:"empAttendance/departmentwise?FromDate=".concat(t,"&ToDate=").concat(a)}).then((e=>{e.success&&W(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e))).finally((()=>{I&&I()}))}),[Y]);const Ae=e=>{const t=e.target.value,[a,n]=t.split("-"),l="".concat(a,"-").concat(n,"-01"),o=(e=>{if(!e)return 0;const[t,a]=e.split("-");return new Date(t,a,0).getDate()})("".concat(a,"-").concat(n)),s="".concat(a,"-").concat(n,"-").concat(o);ue({From:l,To:s,EmpId:me.EmpId||0,Name:null===me||void 0===me?void 0:me.Name})},Te=async()=>{try{const e=me.From,[t,a]=e.split("-"),n="".concat(t,"-").concat(a,"-01"),l=ve("".concat(t,"-").concat(a)),o="".concat(t,"-").concat(a,"-").concat(l),s=await(0,v.q)({address:"userModule/employeActivity/employeeAttendanceModuledownload?FromDate=".concat(n,"&ToDate=").concat(o)});if(s.success){const e=s.data,l=(e,t)=>{const a=[],n=new Date(e),l=new Date(t);let o=0;for(;n<=l;){const e=new Date(n).toISOString().split("T")[0];a.push(e),0===n.getDay()&&o++,n.setDate(n.getDate()+1)}return 0===a.length&&a.push("No days in this range"),{days:a,sundayCount:o,totalDays:a.length}},{days:r,sundayCount:i,totalDays:c}=l(n,o);let d=0,m=0;const u=e.map((e=>{const n=e.AttendanceDetails?JSON.parse(e.AttendanceDetails):[];let l=0,o=0;return r.forEach((e=>{if(Array.isArray(n)){const t=n.find((t=>t.Date===e));if(0===new Date(e).getDay())return;t?"P"===t.AttendanceStatus?l++:"A"!==t.AttendanceStatus&&"H"!==t.AttendanceStatus||o++:o++}})),d+=l,m+=o,{EmployeeName:e.Name,EmployeeID:e.EmployeeID,Month:"".concat(a,"-").concat(t),Branch:e.Branch,NumberOfSundays:i,NumberOfDaysInMonth:c,TotalWorkingDays:l,TotalLeaveDays:o}})).map((e=>({EmployeeName:e.EmployeeName,EmployeeID:e.EmployeeID,Month:e.Month,Branch:e.Branch,NumberOfSundays:e.NumberOfSundays,NumberOfDaysInMonth:e.NumberOfDaysInMonth,TotalWorkingDays:e.TotalWorkingDays,TotalLeaveDays:e.TotalLeaveDays}))),p=T.c$.json_to_sheet(u),h=["EmployeeName","EmployeeID","Month","Branch","NumberOfSundays","NumberOfDaysInMonth","TotalWorkingDays","TotalLeaveDays"];T.c$.sheet_add_aoa(p,[h],{origin:"A1"});const v=T.c$.book_new();T.c$.book_append_sheet(v,p,"Attendance Summary Report"),T.a8(v,"Attendance_Summary_Report.xlsx")}}catch(e){console.error("Error downloading overall report:",e)}},Ne=()=>{const e=G.map((e=>{const t=e.AttendanceDetails?e.AttendanceDetails.split(",").filter((e=>""!==e.trim())):[];let a=e.AttendanceStatus;a||(a=0===t.length?"A":"P");const l={};for(let n=0;n<4;n++)l["Punch".concat(n+1)]=t[n]?t[n].trim():"--";return(0,n.c)({Employee:e.username||e.Employee,"Log Date":Ie(e.LogDate),"Attendance Status":a},l)})),t=["Employee","Log Date","Attendance Status","Punch1","Punch2","Punch3","Punch4"],a=e.map((e=>t.reduce(((t,a)=>(t[a]=e[a]||"--",t)),{}))),l=T.c$.json_to_sheet(a),o=T.c$.book_new();T.c$.book_append_sheet(o,l,"Attendance Report"),T.a8(o,"Attendance_Report.xlsx")};const Ee=Array.from({length:6},((e,t)=>({isCustomCell:!0,ColumnHeader:"Punch ".concat(t+1),isVisible:1,width:"13%",CellProps:{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px"}},Cell:e=>{let{row:a}=e;const n=(a.AttendanceDetails?a.AttendanceDetails.split(",").map((e=>e.trim())).filter((e=>""!==e)):[])[t]||"--",l=n.split(":in(")[0],o="--"!==n?function(e){if(!e)return"--";const[t,a]=e.split(":");if(!t||!a)return"--";let n=parseInt(t,10);const l=a,o=n>=12?"PM":"AM";return n=n%12||12,"".concat(n.toString().padStart(2,"0"),":").concat(l," ").concat(o)}(l):"--";return"--"!==o?(0,N.jsx)(f.c,{label:o,variant:"outlined",size:"small",sx:{color:"green",margin:"2px"}}):(0,N.jsx)("div",{style:{color:"gray"},children:"--"})}}))),Ie=e=>{if(!e)return"--";const[t]=e.split("T");return"".concat(t," ")},we=async()=>{try{const e=me.From,[t,a]=e.split("-"),l="".concat(t,"-").concat(a,"-01"),o=ve("".concat(t,"-").concat(a)),s="".concat(t,"-").concat(a,"-").concat(o),[r,i]=await Promise.all([(0,v.q)({address:"userModule/employeActivity/employeeAttendanceModuledownload?FromDate=".concat(l,"&ToDate=").concat(s)}),(0,v.q)({address:"masters/leave?FromDate=".concat(l,"&ToDate=").concat(s)})]);if(!r.success)throw new Error("Attendance data failed");const c={};((null===i||void 0===i?void 0:i.data)||[]).forEach((e=>{var t;if("APPROVED"!==(null===(t=e.Status)||void 0===t?void 0:t.toUpperCase()))return;const a=e.User_Id;if(!a)return;const n=e=>{try{return new Date(e.includes("T")?e.split("T")[0]:e)}catch(t){return null}},l=n(e.FromDate),o=n(e.ToDate);if(!l||!o)return;let s=new Date(l);for(;s<=o;){const e=s.toISOString().split("T")[0];c[a]||(c[a]={}),c[a][e]=!0,s.setDate(s.getDate()+1)}}));const{days:d}=function(e,t){const a=[],n=new Date(e),l=new Date(t);for(;n<=l;)a.push(n.toISOString().split("T")[0]),n.setDate(n.getDate()+1);return{days:a,count:a.length}}(l,s),m=r.data.map((e=>{const t=function(e){try{return e?JSON.parse(e):[]}catch(t){return[]}}(e.AttendanceDetails)||[],a={};let l=0;const o={};return t.forEach((e=>{null!==e&&void 0!==e&&e.Date&&(o[e.Date]={status:e.AttendanceStatus,hasPunch:"[]"!==e.Punch1})})),d.forEach(((t,n)=>{var s;const r="Day ".concat(n+1),i=0===new Date(t).getDay(),d=e.User_Mgt_Id,m=o[t],u=null===m||void 0===m?void 0:m.status,p=null===m||void 0===m?void 0:m.hasPunch;i?a[r]="H":d&&null!==(s=c[d])&&void 0!==s&&s[t]||"L"===u?a[r]="L":"P"===u?(a[r]=p?"P":"A",p&&l++):a[r]="H"===u?"H":"A"})),(0,n.c)({EmployeeName:e.username||e.Name,TotalPresent:l},a)})),u=["EmployeeName","TotalPresent",...d.map(((e,t)=>"Day ".concat(t+1)))],p=T.c$.json_to_sheet(m);T.c$.sheet_add_aoa(p,[u],{origin:"A1"});const h=T.c$.book_new();T.c$.book_append_sheet(h,p,"Attendance Report"),T.a8(h,"Attendance_Report_".concat(a,"_").concat(t,".xlsx"))}catch(e){console.error("Download failed:",e),A.m4.error("Failed to generate report")}};const Fe=async()=>{try{var e;const t=6,a=null===(e=G[0])||void 0===e?void 0:e.LogDate;if(!a)return void A.m4.error("No attendance data found");const l=new Date(a),o=l.getFullYear(),s=l.getMonth()+1,r="".concat(o,"-").concat(s.toString().padStart(2,"0"),"-01"),i=new Date(o,s,0).toISOString().split("T")[0],c=await(0,v.q)({address:"masters/leave?FromDate=".concat(r,"&ToDate=").concat(i)}),d=null!==c&&void 0!==c&&c.success?c.data:[],m={};d.forEach((e=>{var t;if("approved"!==(null===(t=e.Status)||void 0===t?void 0:t.toLowerCase()))return;const a=String(e.User_Id);if(!a)return;const n=e=>{const t=e.split(/[-/]/);return 3===t.length&&4===t[2].length?2===t[0].length?new Date("".concat(t[2],"-").concat(t[1],"-").concat(t[0])):new Date("".concat(t[2],"-").concat(t[0],"-").concat(t[1])):new Date(e)},l=n(e.FromDate),o=n(e.ToDate);let s=new Date(l);for(;s<=o;){const e=s.toISOString().split("T")[0];m[a]||(m[a]={}),0!==s.getDay()&&(m[a][e]="L"),s.setDate(s.getDate()+1)}}));const u=G.filter((e=>je.some((t=>String(t.UserId)===String(e.User_Mgt_Id)||"ALL"===t.UserId)))).reduce(((e,t)=>(e[t.username]=e[t.username]||[],e[t.username].push(t),e)),{});if(0===Object.keys(u).length)return void A.m4.error("No attendance data found");const p=T.c$.book_new();Object.entries(u).forEach((e=>{let[a,l]=e;const o=l.map((e=>{var l,o;const s=new Date(e.LogDate),r=s.toISOString().split("T")[0],i=0===s.getDay(),c=String(e.User_Mgt_Id),d="L"===(null===(l=m[c])||void 0===l?void 0:l[r]);let u;if(i)u="H";else if(d)u="L";else{var p;u=((null===(p=e.AttendanceDetails)||void 0===p?void 0:p.split(",").map((e=>e.trim())))||[]).some((e=>e&&"--"!==e))?"P":"A"}const h={},v=(null===(o=e.AttendanceDetails)||void 0===o?void 0:o.split(",").map((e=>e.trim())))||[];for(let a=0;a<t;a++)h["Punch ".concat(a+1)]=v[a]||"--";return(0,n.c)({Employee:a,"Log Date":Ie(e.LogDate),"Attendance Status":u},h)})),s=["Employee","Log Date","Attendance Status",...Array.from({length:t},((e,t)=>"Punch ".concat(t+1)))],r=o.map((e=>s.reduce(((t,a)=>(t[a]=e[a]||"--",t)),{})));T.c$.book_append_sheet(p,T.c$.json_to_sheet(r),a.slice(0,31))}));const h="Attendance_Report_".concat((new Date).toLocaleString("default",{month:"long"}),"_").concat(o,".xlsx");T.a8(p,h)}catch(t){console.error("Error generating report:",t),A.m4.error("Failed to generate report")}},Le=async()=>{X(!0);try{const e=await(0,v.q)({address:"masters/Employeedetails/dropDown?Company_id=".concat(re.Company_id)});e.success&&V(e.data)}catch(e){console.error(e),A.m4.error("Failed to fetch employees for dropdown")}finally{X(!1)}};(0,l.useEffect)((()=>{const e=null===w||void 0===w?void 0:w.UserTypeId,t=null===w||void 0===w?void 0:w.UserId,a=null===w||void 0===w?void 0:w.Company_id;(0,v.q)({address:"masters/users/employee/dropDown?Company_id=".concat(a),headers:{Authorization:"Bearer ".concat(localStorage.getItem("Autheticate_Id"))}}).then((a=>{if(a.success){let l=[];1===Number(e)||0===Number(e)||1===Number(Se)?(l=a.data,ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:0,Name:"ALL"}))),te(!1),de("ALL")):(l=a.data.filter((e=>e.UserId===t)),ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:t,Name:null===w||void 0===w?void 0:w.Name}))),te(!0),de(null===w||void 0===w?void 0:w.Name)),ne(l)}})).catch((e=>console.error("Error fetching employees:",e)))}),[null===w||void 0===w?void 0:w.UserTypeId,null===w||void 0===w?void 0:w.UserId,null===w||void 0===w?void 0:w.Company_id,null===w||void 0===w?void 0:w.Name,Y]);const Me=async(e,t)=>{try{const a=null===w||void 0===w?void 0:w.UserTypeId,[n,l]=e.split("-"),o="".concat(n,"-").concat(l,"-01"),s=ve("".concat(n,"-").concat(l)),r="".concat(n,"-").concat(l,"-").concat(s),i=await(0,v.q)({address:"userModule/employeActivity/trackActivitylogAttendance?FromDate=".concat(o,"&ToDate=").concat(r,"&UserTypeId=").concat(a,"&UserId=").concat(t),headers:{Authorization:"Bearer ".concat(localStorage.getItem("Autheticate_Id"))}});i.success&&Z(i.data)}catch(a){console.error("Error fetching attendance data:",a)}};(0,l.useEffect)((()=>{const e={FromDate:U.get("FromDate")&&(0,u.e8)(U.get("FromDate"))?U.get("FromDate"):R.Fromdate,ToDate:U.get("ToDate")&&(0,u.e8)(U.get("ToDate"))?U.get("ToDate"):R.Todate};ye((t=>(0,n.c)((0,n.c)({},t),{},{FromDate:e.FromDate,ToDate:e.ToDate})))}),[L.search]),(0,l.useEffect)((()=>{const e=null!==M&&void 0!==M&&M.FromDate&&(0,u.e8)(null===M||void 0===M?void 0:M.FromDate)?(0,u.Q7)(null===M||void 0===M?void 0:M.FromDate):null,t=null!==M&&void 0!==M&&M.ToDate&&(0,u.e8)(null===M||void 0===M?void 0:M.ToDate)?(0,u.Q7)(null===M||void 0===M?void 0:M.ToDate):null;e&&t&&(_e({FromDate:e,ToDate:t}),ye((e=>(0,n.c)((0,n.c)({},e),{},{FromDate:(0,u.Q7)(M.FromDate),ToDate:M.ToDate}))),Q((e=>!e)))}),[M]);const _e=e=>{const t=new URLSearchParams(e);F("?".concat(t.toString()),{replace:!0})},ke=()=>{k(!1)},Pe=()=>H("employee"),Oe=()=>H("department"),Ue=()=>{ye((e=>(0,n.c)((0,n.c)({},e),{},{FromDate:e.FromDate||(new Date).toISOString().split("T")[0],ToDate:e.ToDate||(new Date).toISOString().split("T")[0]}))),H("default")};(0,l.useEffect)((()=>{const e=null===w||void 0===w?void 0:w.UserTypeId,t=null===w||void 0===w?void 0:w.UserId,a=null===w||void 0===w?void 0:w.Company_id;(0,v.q)({address:"masters/users/employee/dropDown?Company_id=".concat(a),headers:{Authorization:"Bearer ".concat(localStorage.getItem("Autheticate_Id"))}}).then((a=>{if(a.success){let l=[];1===Number(e)||0===Number(e)||1===Number(Se)?(l=a.data,ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:0,Name:"ALL"}))),te(!1),de("ALL")):(l=a.data.filter((e=>e.UserId===t)),ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:t,Name:null===w||void 0===w?void 0:w.Name}))),te(!0),de(null===w||void 0===w?void 0:w.Name)),ne(l)}})).catch((e=>console.error("Error fetching employees:",e)))}),[null===w||void 0===w?void 0:w.UserTypeId,null===w||void 0===w?void 0:w.UserId,null===w||void 0===w?void 0:w.Company_id,null===w||void 0===w?void 0:w.Name]),(0,l.useEffect)((()=>{const e=null===w||void 0===w?void 0:w.Company_id;(0,v.q)({address:"empAttendance/department?Company_id=".concat(e),headers:{Authorization:"Bearer ".concat(localStorage.getItem("Autheticate_Id"))}}).then((e=>{if(e.success&&e.others&&e.others.department){const t=e.others.department.map((e=>({value:e.value,label:e.label})));fe(t)}})).catch((e=>console.error("Error fetching departments:",e)))}),[null===w||void 0===w?void 0:w.Company_id,Y]);const Re=l.useMemo((()=>{var e;if(null===z||void 0===z||null===(e=z[0])||void 0===e||!e.DepartmentWiseCounts)return[];try{const e=JSON.parse(z[0].DepartmentWiseCounts);return Array.isArray(e)?e:[]}catch(t){return console.error("Failed to parse DepartmentWiseCounts JSON:",t),[]}}),[z]),ze=l.useMemo((()=>{if(!Re||!Re.length)return[];return Re.filter((e=>!be||e.Department===be.label)).map((e=>{const t=e.employees||e.Employees||[],a=le?t.filter((e=>!!e.Emp_Name&&e.Emp_Name.trim().toLowerCase()===le.label.trim().toLowerCase())):t;return(0,n.c)((0,n.c)({},e),{},{Employees:a})}))}),[Re,be,le]);return(0,N.jsx)(N.Fragment,{children:0===Number(se)||1===Number(se)?(0,N.jsxs)(N.Fragment,{children:["default"===B&&(0,N.jsx)(x.cp,{title:(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",disabled:!0,onClick:()=>Ue(),children:"Dashboard"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Pe(),children:"Employee"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Oe(),children:"Department"}),(0,N.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-3",children:[(0,N.jsx)("label",{children:"From Date"}),(0,N.jsx)("input",{type:"date",onChange:e=>ye((0,n.c)((0,n.c)({},xe),{},{FromDate:e.target.value})),value:null===xe||void 0===xe?void 0:xe.FromDate,className:"cus-inpt w-auto p-1"})]}),(0,N.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-3",children:[(0,N.jsx)("label",{children:"To Date"}),(0,N.jsx)("input",{type:"date",onChange:e=>ye((0,n.c)((0,n.c)({},xe),{},{ToDate:e.target.value})),value:null===xe||void 0===xe?void 0:xe.ToDate,className:"cus-inpt w-auto p-1"})]}),(0,N.jsx)("div",{className:"p-1",children:(0,N.jsx)(o.c,{onClick:()=>Q(!Y),variant:"outlined",size:"small",children:(0,N.jsx)(p.c,{})})})]}),dataArray:z,EnableSerialNumber:!0,columns:[{isVisible:1,ColumnHeader:"Tot.Emp",isCustomCell:!0,Cell:e=>{var t,a,n;let{row:l}=e;const o=null!==(t=null===l||void 0===l?void 0:l.TotalEmployees)&&void 0!==t?t:0,s=null!==(a=null===l||void 0===l?void 0:l.TotalMaleEmployees)&&void 0!==a?a:0,r=null!==(n=null===l||void 0===l?void 0:l.TotalFemaleEmployees)&&void 0!==n?n:0;return(0,N.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:[(0,N.jsx)("div",{children:o}),(0,N.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"normal"},children:["Male / Female: ",s," / ",r]})]})}},{isVisible:1,ColumnHeader:"Tot.Pre.Today",isCustomCell:!0,Cell:e=>{var t,a,n;let{row:l}=e;const o=null!==(t=null===l||void 0===l?void 0:l.TotalPresentToday)&&void 0!==t?t:0,s=null!==(a=null===l||void 0===l?void 0:l.TotalMalePresentToday)&&void 0!==a?a:0,r=null!==(n=null===l||void 0===l?void 0:l.TotalFemalePresentToday)&&void 0!==n?n:0;return(0,N.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:[(0,N.jsx)("div",{children:o}),(0,N.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"normal"},children:["Male / Female: ",s," / ",r]})]})}}],isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:t}=e;const a="string"===typeof t.DepartmentWiseCounts?JSON.parse(t.DepartmentWiseCounts):t.DepartmentWiseCounts;return(0,N.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"10px"},children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{style:{backgroundColor:"#f0f0f0"},children:[(0,N.jsx)("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Department Name"}),(0,N.jsx)("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Total Employees"}),(0,N.jsx)("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Present Today"})]})}),(0,N.jsx)("tbody",{children:a&&a.length>0?a.map(((e,t)=>(0,N.jsxs)("tr",{onClick:()=>{return t=e.Department,void $(q===t?null:t);var t},children:[(0,N.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px"},children:(null===e||void 0===e?void 0:e.Department)||"-"}),(0,N.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px"},children:(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{style:{fontSize:"1.25rem",fontWeight:"bold",marginRight:"100px",minWidth:"60px"},children:(null===e||void 0===e?void 0:e.TotalEmployees)||"-"}),(0,N.jsxs)("span",{style:{fontSize:"1rem"},children:["Male / Female: ",(null===e||void 0===e?void 0:e.TotalMaleEmployees)||"0"," /"," ",(null===e||void 0===e?void 0:e.TotalFemaleEmployees)||"0"]})]})}),(0,N.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px"},children:(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{style:{fontSize:"1.25rem",fontWeight:"bold",marginRight:"100px",minWidth:"60px"},children:(null===e||void 0===e?void 0:e.TotalPresentToday)||"-"}),(0,N.jsxs)("span",{style:{fontSize:"1rem"},children:["Male / Female: ",(null===e||void 0===e?void 0:e.TotalMalePresentToday)||"0"," /"," ",(null===e||void 0===e?void 0:e.TotalFemalePresentToday)||"0"]})]})})]},t))):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"3",style:{padding:"8px"},children:"No Departments Available"})})})]})}}),"employee"===B&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(s.c,{open:_,maxWidth:"md",PaperProps:{style:{width:"500px",height:"500px"}},children:[(0,N.jsx)(r.c,{children:"Add Employee"}),(0,N.jsx)(i.c,{children:(0,N.jsx)(D.c,{multiple:!0,options:[{UserId:"all",Name:"ALL"},...J],getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,t)=>e.UserId===t.UserId,onChange:(e,t)=>{if(t.some((e=>"all"===e.UserId)))Ce(J);else{const e=t.filter(((e,t,a)=>t===a.findIndex((t=>t.UserId===e.UserId))));Ce(e)}},value:je.some((e=>"all"===e.UserId))?[{UserId:"all",Name:"ALL"}]:je,renderInput:e=>(0,N.jsx)(j.c,(0,n.c)((0,n.c)({},e),{},{placeholder:"Employees"}))})}),(0,N.jsxs)(c.c,{className:"d-flex justify-content-between flex-wrap",children:[(0,N.jsx)(b.c,{type:"button",variant:"outlined",onClick:()=>Ce([]),children:"Clear"}),(0,N.jsxs)("span",{children:[(0,N.jsx)(b.c,{onClick:ke,children:"Cancel"}),(0,N.jsx)(b.c,{onClick:Fe,children:"Download"})]})]})]}),(0,N.jsx)(C.c,{children:(0,N.jsxs)(S.c,{sx:{minHeight:"50vh"},children:[(0,N.jsxs)("div",{className:"ps-3 pb-2 pt-0 d-flex align-items-center justify-content-between border-bottom mb-3",children:[(0,N.jsxs)("h6",{className:"fa-18",children:[(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Ue(),children:"Dashboard"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",disabled:!0,onClick:()=>Pe(),children:"EMPLOYEE"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Oe(),children:"Department"})]}),(0,N.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-3",children:[(0,N.jsx)(b.c,{onClick:Ne,variant:"contained",disabled:0===(null===me||void 0===me?void 0:me.EmpId)||"ALL"===(null===me||void 0===me?void 0:me.Name),children:"Individual Report"}),(0,N.jsx)(b.c,{onClick:()=>{we(null===me||void 0===me||me.From,null===me||void 0===me||me.To)},children:"Monthly Report"}),(0,N.jsx)(b.c,{onClick:()=>{k(!0)},children:"Cummulative Monthly Report"}),(0,N.jsx)(b.c,{onClick:Te,children:"Summary"})]})]}),(0,N.jsxs)("div",{className:"px-2 row mb-4",children:[(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"Employee"}),(0,N.jsx)(d.cp,{value:{value:null===me||void 0===me?void 0:me.EmpId,label:null===me||void 0===me?void 0:me.Name},onChange:e=>ue((0,n.c)((0,n.c)({},me),{},{EmpId:e.value,Name:e.label})),options:[{value:0,label:"ALL"},...ae.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:m.cF,isSearchable:!0,placeholder:ce})]}),(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"From"}),(0,N.jsx)("input",{type:"month",className:"cus-inpt",value:null===me||void 0===me||null===(t=me.From)||void 0===t?void 0:t.slice(0,7),onChange:Ae})]}),(0,N.jsx)("div",{className:"col-auto p-2 d-flex align-items-center",children:(0,N.jsx)("button",{className:"btn btn-link ms-2 p-0 mt-3",onClick:()=>{E&&E();const e=null===w||void 0===w?void 0:w.UserTypeId,t=null===w||void 0===w?void 0:w.UserId,a=null===w||void 0===w?void 0:w.Company_id;(0,v.q)({address:"masters/users/employee/dropDown?Company_id=".concat(a),headers:{Authorization:"Bearer ".concat(localStorage.getItem("Autheticate_Id"))}}).then((a=>{if(a.success){let l=[];1===Number(e)||0===Number(e)||1===Number(Se)?(l=a.data,ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:0,Name:"ALL"}))),te(!1),de("ALL")):(l=a.data.filter((e=>e.UserId===t)),ue((e=>(0,n.c)((0,n.c)({},e),{},{EmpId:t,Name:null===w||void 0===w?void 0:w.Name}))),te(!0),de(null===w||void 0===w?void 0:w.Name)),ne(l)}})).catch((e=>console.error("Error fetching employees:",e))).finally((()=>{I&&I(),Q((e=>!e))}))},title:"Refresh Departments & Employees",children:(0,N.jsx)(h.c,{fontSize:"medium"})})})]}),(0,N.jsx)(x.cp,{dataArray:G,columns:[{isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.username},ColumnHeader:"Employee",isVisible:1,width:"20%",CellProps:{sx:{padding:"10px",textAlign:"left",fontWeight:"bold"}}},{isCustomCell:!0,Cell:e=>{let{row:t}=e;return Ie(t.LogDate||"--")},ColumnHeader:"Log Date",isVisible:1,width:"20%",CellProps:{sx:{padding:"10px",textAlign:"center",color:"gray"}}},...Ee],EnableSerialNumber:!0,CellSize:"small",disablePagination:!1})]})})]}),"department"===B&&(0,N.jsx)(x.cp,{title:(0,N.jsxs)("div",{className:"d-flex flex-column",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Ue(),children:"Dashboard"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",onClick:()=>Pe(),children:"Employee"}),(0,N.jsx)(b.c,{size:"small mx-2",variant:"outlined",disabled:!0,onClick:()=>Oe(),children:"Department"})]}),(0,N.jsxs)("div",{className:"row align-items-end",children:[(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"Department"}),(0,N.jsx)(d.cp,{options:ge,isSearchable:!0,placeholder:"ALL",value:be,styles:m.cF,onChange:e=>{De(e),ne([]),oe(null),e?(0,v.q)({address:"empAttendance/employeesByDepartment",method:"POST",bodyData:{department:e.value}}).then((e=>{var t;if(e.success&&null!==(t=e.others)&&void 0!==t&&t.employees){const t=e.others.employees.map((e=>({value:e.id||e.value||e.Emp_Id,label:e.name||e.label||e.Emp_Name})));ne(t)}else ne([])})).catch((e=>{console.error("Error fetching employees:",e),ne([])})):ne([])}})]}),(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"Employee"}),(0,N.jsx)(d.cp,{options:ae,isSearchable:!0,placeholder:"ALL",value:le,styles:m.cF,onChange:oe,isDisabled:!be})]}),(0,N.jsx)("div",{className:"col-auto p-2 d-flex align-items-center",children:(0,N.jsx)("button",{className:"btn btn-link ms-2 p-0 mb-2",onClick:()=>{window.location.reload()},style:{minWidth:"24px"},title:"Refresh Departments & Employees",children:(0,N.jsx)(h.c,{fontSize:"small"})})})]})]}),dataArray:ze,EnableSerialNumber:!0,columns:[(0,x.A5)("Department","string","Department"),(0,x.A5)("TotalMaleEmployees","number","Total Male Employees"),(0,x.A5)("TotalFemaleEmployees","number","Total Female Employees"),(0,x.A5)("TotalEmployees","number","Total Employees"),(0,x.A5)("TotalMalePresentToday","number","Total Male Present Today"),(0,x.A5)("TotalFemalePresentToday","number","Total Female Present Today"),(0,x.A5)("TotalPresentToday","number","Total Present Today")],isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:t}=e,a=[],n=[];try{a="string"===typeof t.Employees?JSON.parse(t.Employees):t.Employees||[],n="string"===typeof t.MonthlyAverageAttendance?JSON.parse(t.MonthlyAverageAttendance):t.MonthlyAverageAttendance||[]}catch(s){a=[],n=[]}const l=(new Date).getFullYear(),o=new Map;return n.forEach((e=>{var t;const a="".concat(e.MonthNumber,"-").concat(e.YearNumber);o.set(a,null!==(t=e.UniqueEmployeeDays)&&void 0!==t?t:0)})),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:(0,N.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,N.jsxs)("table",{style:{width:"60%",borderCollapse:"collapse",border:"1px solid #ccc"},children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{style:{backgroundColor:"#f0f0f0"},children:[(0,N.jsx)("th",{style:{border:"1px solid #ccc",padding:"5px",textAlign:"left"},children:"Emp_Name"}),(0,N.jsx)("th",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},children:"Sex"})]})}),(0,N.jsx)("tbody",{children:a&&a.length>0?a.map(((e,t)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px"},children:(null===e||void 0===e?void 0:e.Emp_Name)||"-"}),(0,N.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px"},children:(null===e||void 0===e?void 0:e.Sex)||"-"})]},t))):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"2",style:{padding:"8px"},children:"No Employees Available"})})})]}),(0,N.jsxs)("div",{style:{flex:"1",border:"1px solid #ddd",borderRadius:"5px",padding:"10px",overflowX:"auto",whiteSpace:"nowrap"},children:[(0,N.jsx)("h3",{style:{textAlign:"center"},children:"Months & Attendance"}),(0,N.jsx)("div",{style:{display:"flex",gap:"10px"},children:[{name:"January",number:1},{name:"February",number:2},{name:"March",number:3},{name:"April",number:4},{name:"May",number:5},{name:"June",number:6},{name:"July",number:7},{name:"August",number:8},{name:"September",number:9},{name:"October",number:10},{name:"November",number:11},{name:"December",number:12}].map((e=>{var t;const a="".concat(e.number,"-").concat(l),n=null!==(t=o.get(a))&&void 0!==t?t:0;return(0,N.jsxs)("div",{style:{minWidth:"100px",padding:"8px",backgroundColor:"#f0f0f0",color:"black",borderRadius:"4px",textAlign:"center",userSelect:"none"},children:[(0,N.jsxs)("div",{style:{fontWeight:"bold"},children:[e.name," ",l]}),(0,N.jsx)("div",{style:{marginTop:"6px",fontSize:"14px",color:"#555"},children:n})]},e.number)}))})]})]})})}})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(s.c,{open:_,maxWidth:"md",PaperProps:{style:{width:"500px",height:"500px"}},children:[(0,N.jsx)(r.c,{children:"Add Employee"}),(0,N.jsx)(i.c,{children:(0,N.jsx)(D.c,{multiple:!0,options:[{UserId:"all",Name:"ALL"},...J],getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,t)=>e.UserId===t.UserId,value:je.some((e=>"all"===e.UserId))?[{UserId:"all",Name:"ALL"}]:je,onChange:(e,t)=>{if(t.some((e=>"all"===e.UserId)))Ce(J);else{const e=t.filter(((e,t,a)=>t===a.findIndex((t=>t.UserId===e.UserId))));Ce(e)}},renderInput:e=>(0,N.jsx)(j.c,(0,n.c)((0,n.c)({},e),{},{placeholder:"Employees"}))})}),(0,N.jsxs)(c.c,{className:"d-flex justify-content-between flex-wrap",children:[(0,N.jsx)(b.c,{variant:"outlined",onClick:()=>Ce([]),children:"Clear"}),(0,N.jsxs)("span",{children:[(0,N.jsx)(b.c,{onClick:ke,children:"Cancel"}),(0,N.jsx)(b.c,{onClick:Fe,children:"Download"})]})]})]}),(0,N.jsx)(C.c,{children:(0,N.jsxs)(S.c,{sx:{minHeight:"50vh"},children:[(0,N.jsxs)("div",{className:"ps-3 pb-2 pt-0 d-flex align-items-center justify-content-between border-bottom mb-3",children:[(0,N.jsx)("h6",{className:"fa-18",children:(0,N.jsx)(b.c,{size:"small",variant:"outlined",className:"mx-2",children:"EMPLOYEE"})}),(1===se||0===se)&&(0,N.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-3",children:[(0,N.jsx)(b.c,{onClick:Ne,variant:"contained",disabled:0===(null===me||void 0===me?void 0:me.EmpId)||"ALL"===(null===me||void 0===me?void 0:me.Name),children:"Individual Report"}),(0,N.jsx)(b.c,{onClick:()=>we(null===me||void 0===me||me.From,null===me||void 0===me||me.To),children:"Monthly Report"}),(0,N.jsx)(b.c,{onClick:()=>k(!0),children:"Cumulative Monthly Report"}),(0,N.jsx)(b.c,{onClick:Te,children:"Summary"})]})]}),(0,N.jsxs)("div",{className:"px-2 row mb-4",children:[(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"Employee"}),(0,N.jsx)(d.cp,{value:{value:null===me||void 0===me?void 0:me.EmpId,label:null===me||void 0===me?void 0:me.Name},onChange:e=>ue((0,n.c)((0,n.c)({},me),{},{EmpId:e.value,Name:e.label})),options:[{value:0,label:"ALL"},...ae.map((e=>({value:e.UserId,label:e.Name})))],styles:m.cF,isSearchable:!0,placeholder:ce,isDisabled:ee})]}),(0,N.jsxs)("div",{className:"col-xl-2 col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,N.jsx)("label",{children:"From"}),(0,N.jsx)("input",{type:"month",className:"cus-inpt",value:null===me||void 0===me||null===(a=me.From)||void 0===a?void 0:a.slice(0,7),onChange:Ae})]})]}),(0,N.jsx)(x.cp,{dataArray:G,columns:[{isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.username},ColumnHeader:"Employee",isVisible:1,width:"20%",CellProps:{sx:{padding:"10px",textAlign:"left",fontWeight:"bold"}}},{isCustomCell:!0,Cell:e=>{let{row:t}=e;return Ie(t.LogDate||"--")},ColumnHeader:"Log Date",isVisible:1,width:"20%",CellProps:{sx:{padding:"10px",textAlign:"center",color:"gray"}}},...Ee],EnableSerialNumber:!0,CellSize:"small",disablePagination:!1})]})})]})})}},31664:(e,t,a)=>{a.d(t,{c:()=>o});var n=a(27664),l=a(82496);const o=(0,n.c)((0,l.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},57704:(e,t,a)=>{a.d(t,{c:()=>o});var n=a(27664),l=a(82496);const o=(0,n.c)((0,l.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},84436:(e,t,a)=>{a.d(t,{c:()=>x});var n=a(45072),l=a(95656),o=a(69060),s=a(79736),r=a(21412),i=a(12556),c=a(49836),d=a(10099),m=a(33448);function u(e){return(0,m.cp)("MuiCardContent",e)}(0,d.c)("MuiCardContent",["root"]);var p=a(82496);const h=["className","component"],v=(0,i.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=o.forwardRef((function(e,t){const a=(0,c.C)({props:e,name:"MuiCardContent"}),{className:o,component:i="div"}=a,d=(0,l.c)(a,h),m=(0,n.c)({},a,{component:i}),x=(e=>{const{classes:t}=e;return(0,r.c)({root:["root"]},u,t)})(m);return(0,p.jsx)(v,(0,n.c)({as:i,className:(0,s.c)(x.root,o),ownerState:m,ref:t},d))}))}}]);
//# sourceMappingURL=1684.4056bbbf.chunk.js.map