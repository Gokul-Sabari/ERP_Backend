"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8105],{48105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(30800),c=a(69060),r=a(1908),l=a(3358),o=a(5548),n=a(82656),d=a(26773),i=a(4488),m=a(44380),u=a(90048),h=a(87016),_=a(57704),v=a(86e3),x=a(45180),p=a(51560),D=a(56480),j=a(13724),g=a(42136),I=a(39308),w=a(73380),N=a.n(w),f=a(85592),b=a.n(f),S=a(26592),C=a(82496);const R={Fromdate:(0,I.Q7)(),NewDate:""},F=e=>{const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(c)};const P=function(e){var t;let{loadingOn:a,loadingOff:w}=e;const[f,P]=(0,c.useState)({Fromdate:R.Fromdate,fetchFrom:R.Fromdate,NewDate:R.NewDate,fetchNew:R.NewDate}),[y,A]=(0,c.useState)(!1),[B,k]=(0,c.useState)({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),[O,E]=(0,c.useState)(!1),[M,T]=(0,c.useState)([]),[q,Y]=(0,c.useState)([]),[W,L]=(0,c.useState)([]),z=(0,p.i6)(),H=(0,p.IT)(),U=new URLSearchParams((0,p.IT)().search),[V,Q]=(0,c.useState)(""),[G,J]=(0,c.useState)([]),[K,X]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const e={Fromdate:U.get("Fromdate")&&(0,I.e8)(U.get("Fromdate"))?U.get("Fromdate"):R.Fromdate,NewDate:U.get("NewDate")&&(0,I.e8)(U.get("NewDate"))?U.get("NewDate"):R.NewDate};P((t=>(0,s.c)((0,s.c)({},t),{},{fetchFrom:e.Fromdate,fetchNew:e.NewDate})))}),[H.search]),(0,c.useEffect)((()=>{(0,r.q)({address:"masters/posRateMaster?FromDate=".concat(null===f||void 0===f?void 0:f.Fromdate)}).then((e=>{e.success&&(J(e),L(e.data))})).catch((e=>console.error(e))),(0,r.q)({address:"masters/posbranch/dropdown"}).then((e=>{e.success&&T(e.data)})).catch((e=>console.error(e)))}),[f.Fromdate,K]),(0,c.useEffect)((()=>{V&&(async e=>{(0,r.q)({address:"masters/posbrand/productList?Pos_Brand_Id=".concat(e)}).then((e=>{e.success&&Y(e.data)})).catch((e=>console.error(e)))})(V)}),[V]),(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"date-inputs",children:(0,C.jsxs)("div",{className:"p-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,C.jsxs)("h5",{className:"m-0 my-1 flex-grow-1 d-flex align-items-center flex-wrap",children:[(0,C.jsx)("span",{className:"mx-2",children:"Rate Master"}),(0,C.jsx)(g.c,{onClick:()=>$(!0),children:"Export To"}),(0,C.jsx)(g.c,{className:"mx-2 btn btn-dark",style:{outline:"none",boxShadow:"none"},onClick:async()=>{const e=W.filter((e=>1===e.Is_Active_Decative));if(0===e.length)return void alert("No active data available for download.");const t=e.reduce(((e,t)=>{const{Pos_Brand_Id:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{});const a=new(b().Workbook),s=a.addWorksheet("PriceList_Data"),c=e.length>0?e[0].Rate_Date.split("T")[0].split("-").reverse().join("-"):"";s.addRow([c,"PriceList"]).font={bold:!0,size:14},Object.entries(t).forEach((e=>{let[t,a]=e;const c=s.addRow([a[0].POS_Brand_Name]).getCell(1);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}},c.font={bold:!0,size:12},a.forEach((e=>{s.addRow([e.Short_Name,e.Rate])}))})),s.columns=[{width:40},{width:15}];const r=await a.xlsx.writeBuffer(),l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,S.saveAs)(l,"PriceList_Data.xlsx")},children:"Download Excel"})]}),(0,C.jsx)(l.c,{title:"Sync Data",children:(0,C.jsx)(o.c,{onClick:()=>{(0,r.q)({address:"masters/posproductSync"}).then((e=>{e&&D.m4.success(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e)))},children:(0,C.jsx)(h.c,{})})}),(0,C.jsx)("div",{children:(0,C.jsx)("input",{type:"date",value:f.Fromdate,onChange:e=>{const t=e.target.value;P((0,s.c)((0,s.c)({},f),{},{Fromdate:t,fetchFrom:t}))},className:"cus-inpt w-auto p-1"})}),(0,C.jsx)(o.c,{onClick:()=>{(e=>{const t=new URLSearchParams(e);z("?".concat(t.toString()),{replace:!0})})({Fromdate:null===f||void 0===f?void 0:f.Fromdate})},variant:"outlined",size:"small",children:(0,C.jsx)(_.c,{})}),(null===f||void 0===f?void 0:f.Fromdate)===N()().format("YYYY-MM-DD")?(0,C.jsx)(g.c,{onClick:()=>A(!0),children:"Add"}):null]})}),(0,C.jsx)(j.cp,{dataArray:W,EnableSerialNumber:!0,isExpendable:!0,maxHeightOption:!0,columns:[(0,j.A5)("Rate_Date","date","Rate Date"),(0,j.A5)("POS_Brand_Name","string","Brand"),(0,j.A5)("Short_Name","string","Product"),(0,j.A5)("Rate","string","Rate"),{Field_Name:"Is_Active_Decative",ColumnHeader:"Status",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;const a=1===t.Is_Active_Decative?"Active":"Inactive";return(0,C.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 text-white",style:{backgroundColor:"Active"===a?"green":"red"},children:a})}},(null===f||void 0===f?void 0:f.Fromdate)===N()().format("YYYY-MM-DD")?{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,C.jsxs)("td",{style:{minWidth:"80px"},children:[(0,C.jsx)(o.c,{onClick:()=>{return e=t,A(!0),k({Id:null===e||void 0===e?void 0:e.Id,Rate_Date:F(e.Rate_Date),Pos_Brand_Id:e.Pos_Brand_Id,Item_Id:e.Item_Id,Rate:e.Rate,Is_Active_Decative:e.Is_Active_Decative,POS_Brand_Name:e.POS_Brand_Name,Product_Name:e.Product_Name}),void Q(e.Pos_Brand_Id);var e},size:"small",children:(0,C.jsx)(v.c,{className:"fa-in"})}),(0,C.jsx)(o.c,{onClick:()=>{E(!0),k({Id:t.Id})},size:"small",color:"error",children:(0,C.jsx)(x.c,{className:"fa-in "})})]})}}:{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,C.jsx)("td",{children:"-"})}}]}),(0,C.jsxs)(n.c,{open:y,onClose:()=>A(!1),fullWidth:!0,maxWidth:"sm",children:[(0,C.jsxs)(d.c,{children:[B.Id?"UPDATE":"CREATE"," RATE MASTER"]}),(0,C.jsxs)("form",{onSubmit:e=>{e.preventDefault(),B.Id?(0,r.q)({address:"masters/posRateMaster",method:"PUT",bodyData:(0,s.c)((0,s.c)({},B),{},{Rate_Date:F(B.Rate_Date)})}).then((e=>{e.success?(D.m4.success("Rate Master updated successfully!"),A(!1),X(!K),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),Q("")):D.m4.error("Failed to update Rate Master:",e.message)})).catch((e=>{throw e})):(0,r.q)({address:"masters/posRateMaster",method:"POST",bodyData:(0,s.c)((0,s.c)({},B),{},{Pos_Brand_Id:V,Item_Id:B.Item_Id,Rate_Date:F(B.Rate_Date)})}).then((e=>{e.success?(A(!1),D.m4.success(e.message),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),Q(""),X(!K)):D.m4.error(e.message)})).catch((e=>console.error(e)))},children:[(0,C.jsxs)(i.c,{children:[(0,C.jsx)("label",{children:"Rate Date"}),(0,C.jsx)("input",{type:"date",value:B.Rate_Date,onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Rate_Date:e.target.value})),className:"cus-inpt"}),(0,C.jsx)("label",{children:"POS Brand"}),(0,C.jsxs)("select",{value:V,onChange:e=>{const t=e.target.value;Q(t),k((0,s.c)((0,s.c)({},B),{},{Pos_Brand_Id:t}))},className:"cus-inpt",children:[(0,C.jsx)("option",{value:"",disabled:!0,children:"Select POS Brand"}),M.map(((e,t)=>(0,C.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,C.jsx)("label",{children:"Product"}),(0,C.jsxs)("select",{className:"cus-inpt",disabled:!V,value:B.Item_Id,onChange:e=>{k((0,s.c)((0,s.c)({},B),{},{Item_Id:e.target.value}))},children:[(0,C.jsx)("option",{value:"",disabled:!0,children:"Select Product"}),q.length>0?q.map(((e,t)=>(0,C.jsx)("option",{value:e.value,children:e.label},t))):(0,C.jsx)("option",{value:"",disabled:!0,children:"No products available"})]}),(0,C.jsx)("label",{children:"Rate"}),(0,C.jsx)(m.c,{label:"",value:null!==(t=B.Rate)&&void 0!==t?t:"",onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Rate:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,C.jsx)("label",{children:"Status"}),(0,C.jsxs)("select",{value:B.Is_Active_Decative,onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Is_Active_Decative:e.target.value})),children:[(0,C.jsx)("option",{value:"1",children:"Active"}),(0,C.jsx)("option",{value:"0",children:"Inactive"})]})]}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>{k({}),A(!1)},children:"Cancel"}),(0,C.jsx)(g.c,{type:"submit",variant:"contained",children:"Save"})]})]})]}),(0,C.jsxs)(n.c,{open:O,onClose:()=>E(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,C.jsx)(d.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,C.jsx)(i.c,{children:(0,C.jsx)("b",{children:"Do you want to delete the RateMaster?"})}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>E(!1),children:"Cancel"}),(0,C.jsx)(g.c,{onClick:()=>(B.Id,void(0,r.q)({address:"masters/posRateMaster",method:"DELETE",bodyData:{Id:B.Id}}).then((e=>{e.success?(X(!K),E(!1),A(!1),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"1",POS_Brand_Name:"",Product_Name:""}),Q(""),D.m4.success("Rate Master deleted successfully!")):D.m4.error("Failed to delete area:",e.message)})).catch((e=>console.error(e)))),autoFocus:!0,color:"error",children:"Delete"})]})]}),(0,C.jsxs)(n.c,{open:Z,onClose:()=>$(!1),fullWidth:!0,maxWidth:"sm",children:[(0,C.jsx)(d.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,C.jsx)(i.c,{children:(0,C.jsxs)("b",{children:["Do you want to export data from:",(0,C.jsxs)("div",{children:[(0,C.jsx)("label",{children:"From Date"}),(0,C.jsx)("input",{type:"date",disabled:!0,value:f.Fromdate,onChange:e=>{const t=e.target.value;P((0,s.c)((0,s.c)({},f),{},{Fromdate:t,fetchFrom:t}))},className:"cus-inpt w-auto p-1"})]}),(0,C.jsx)("br",{}),(0,C.jsxs)("div",{children:[(0,C.jsx)("label",{children:"New Date"}),(0,C.jsx)("input",{type:"date",value:f.NewDate,onChange:e=>{const t=e.target.value;P((0,s.c)((0,s.c)({},f),{},{NewDate:t}))},className:"cus-inpt w-auto p-1"})]})]})}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>$(!1),children:"Cancel"}),(0,C.jsx)(g.c,{onClick:()=>(async()=>{if(a&&a(),null===f||void 0===f||!f.Fromdate||null===f||void 0===f||!f.NewDate)throw new Error("Both 'From Date' and 'New Date' are required.");(0,r.q)({address:"masters/exportRateMaster?FromDate=".concat(null===f||void 0===f?void 0:f.Fromdate,"&NewDate=").concat(null===f||void 0===f?void 0:f.NewDate),method:"POST",bodyData:{bulkData:G}}).then((e=>{e.success?(D.m4.success(e.message),$(!1),P((0,s.c)((0,s.c)({},f),{},{NewDate:""}))):D.m4.error(e.message)})).catch((e=>console.error(e))).finally((()=>{w&&w()}))})(),autoFocus:!0,color:"primary",children:"Export"})]})]})]})}}}]);
//# sourceMappingURL=8105.f1c3e23a.chunk.js.map