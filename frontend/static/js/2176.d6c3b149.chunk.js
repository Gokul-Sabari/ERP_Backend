"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[2176],{64568:(e,t,l)=>{l.d(t,{c:()=>s});var a=l(82496);const s=()=>(0,a.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},62344:(e,t,l)=>{l.d(t,{o$:()=>n,o5:()=>o,cF:()=>d,iI:()=>r});var a=l(30800);const s=l.p+"static/media/smt.aa4d4f940bbebff07a57.png",r={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},d={control:(e,t)=>(0,a.c)((0,a.c)({},e),{},{height:"45px",background:"rgba(255, 255, 255, 0.322)"}),menu:(e,t)=>(0,a.c)((0,a.c)({},e),{},{zIndex:9999}),menuPortal:e=>(0,a.c)((0,a.c)({},e),{},{zIndex:9999})},n=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],o=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:s,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:s,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:s,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}]},128:(e,t,l)=>{l.d(t,{O:()=>s});var a=l(39308);const s=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"add";const s=(0,a.gH)(e),r=(0,a.gH)(t),d=r/2;let n,o,i,c;if("zerotax"===l)n=s,o=0,i=s,c=s;else if("add"===l)o=s*r/100,n=s,i=s+o,c=s;else{if("remove"!==l)throw new Error("Invalid type. Use 'add', 'remove', or 'zerotax'.");n=s/(1+r/100),o=s-n,i=s,c=n}const u=(o/2).toFixed(2),m=(o/2).toFixed(2),v=o.toFixed(2);return{base_amount:Number(n).toFixed(2),with_tax:Number(i).toFixed(2),without_tax:Number(c).toFixed(2),tax_per:Number(r),tax_amount:Number(o).toFixed(2),sgst_per:Number(d),sgst_amount:Number(u),cgst_per:Number(d),cgst_amount:Number(m),igst_per:Number(r),igst_amount:Number(v),type:l}}},45560:(e,t,l)=>{l.r(t),l.d(t,{default:()=>H});var a=l(30800),s=l(69060),r=l(43692),d=l(89e3),n=l(84436),o=l(5548),i=l(40656),c=l(62344),u=l(56480),m=l(39308),v=l(27664),h=l(82496);const x=(0,v.c)((0,h.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft");var _=l(80156),p=l(96064),j=l(49608),I=l(86e3),b=l(45180),g=l(36992),N=l(1908),S=l(13724),C=l(128),T=l(51560),f=l(82656),y=l(26773),A=l(4488);const P=(0,v.c)((0,h.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done"),Q=(0,m.gV)().user,R={So_Id:"",So_Inv_No:"",So_Year:"",So_Branch_Inv_Id:"",So_Date:(0,m.Q7)(),Retailer_Id:"",Sales_Person_Id:"",Branch_Id:"",VoucherType:"",GST_Inclusive:2,IS_IGST:0,Narration:"",isConverted:"",Cancel_status:"",CSGT_Total:0,SGST_Total:0,IGST_Total:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Created_by:null===Q||void 0===Q?void 0:Q.UserId,Altered_by:null===Q||void 0===Q?void 0:Q.UserId,Approved_By:"",Approve_Status:"",Created_on:"",Alterd_on:"",Trans_Type:"",Alter_Id:""},B={BrandID:"",Brand:"",GroupID:"",Group:"",SO_St_Id:"",So_Date:"",Sales_Order_Id:"",S_No:"",Pre_Id:"",Item_Id:"",Item_Rate:0,Bill_Qty:0,Amount:0,HSN_Code:"",Unit_Id:"",Unit_Name:"",Free_Qty:0,Total_Qty:0,Taxble:0,Taxable_Rate:0,Taxable_Amount:0,Tax_Rate:0,Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Final_Amo:0,Created_on:""},G=e=>{let{loadingOn:t,loadingOff:l,open:r,onClose:n,retailer:i,children:c,selectedItems:u,setSelectedItems:v,products:x=[],GST_Inclusive:_,IS_IGST:p}=e;const j=(0,m.Qr)(_,1),I=(0,m.Qr)(_,2),[b,g]=(0,s.useState)([]),[S,T]=(0,s.useState)({Fromdate:(0,m.Q7)(),Todate:(0,m.Q7)(),search:!1});(0,s.useEffect)((()=>{if((0,m.Q$)(i)&&r){const{Fromdate:e,Todate:a}=S;t&&t(),(0,N.q)({address:"sales/saleOrder/importPosOrders?Fromdate=".concat(e,"&Todate=").concat(a,"&Retailer_Id=").concat(i)}).then((e=>{e.success?g(e.data):g([])})).catch((e=>console.error(e))).finally((()=>{l&&l()}))}}),[S.search]);const Q=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v((l=>{const a=l.filter((t=>!(0,m.Qr)(null===t||void 0===t?void 0:t.Pre_Id,e.Pre_Id)));let s;if(t)s=a;else{const t=b.filter((t=>(0,m.Qr)(t.Pre_Id,e.Pre_Id))).map((e=>Object.fromEntries(Object.entries(B).map((t=>{var l,a,s,r,d;let[n,o]=t;const i=(e=>{var t;return null!==(t=null===x||void 0===x?void 0:x.find((t=>(0,m.Qr)(null===t||void 0===t?void 0:t.Product_Id,e))))&&void 0!==t?t:{}})(e.Item_Id),c=p?i.Igst_P:i.Gst_P,u=c>0,{Item_Rate:v,Bill_Qty:h,Tonnage:_,PackValue:b}=e,g=(0,m.eX)(v,(0,m.eX)(h,b)),N=I?"zerotax":j?"remove":"add",S=(0,C.O)(v,c,N),T=(0,C.O)(g,c,N),f=p?0:T.cgst_per,y=p?T.igst_per:0,A=p?0:T.cgst_amount,P=p?T.igst_amount:0;switch(n){case"Pre_Id":return[n,null!==(l=e.Pre_Id)&&void 0!==l?l:o];case"Item_Id":return[n,null!==(a=e.Item_Id)&&void 0!==a?a:o];case"Item_Rate":return[n,(0,m.gH)(v)];case"Bill_Qty":case"Total_Qty":return[n,(0,m.gH)(_)];case"Amount":return[n,g];case"Unit_Id":return[n,null!==(s=e.Unit_Id)&&void 0!==s?s:o];case"Unit_Name":return[n,null!==(r=e.Units)&&void 0!==r?r:o];case"HSN_Code":return[n,null!==(d=i.HSN_Code)&&void 0!==d?d:o];case"Taxable_Rate":return[n,S.base_amount];case"Taxble":return[n,u?1:0];case"Taxable_Amount":return[n,T.base_amount];case"Tax_Rate":return[n,c];case"Cgst":case"Sgst":return[n,null!==f&&void 0!==f?f:0];case"Cgst_Amo":case"Sgst_Amo":return[n,I?0:A];case"Igst":return[n,null!==y&&void 0!==y?y:0];case"Igst_Amo":return[n,I?0:P];case"Final_Amo":return[n,T.with_tax];default:return[n,o]}})))));s=[...a,...t]}return s}))},R=()=>{n&&n(),g([])};return(0,h.jsxs)(h.Fragment,{children:[c,(0,h.jsxs)(f.c,{open:r,onClose:R,fullScreen:!0,children:[(0,h.jsx)(y.c,{children:(0,h.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,h.jsx)("span",{className:"flex-grow-1",children:"Import from POS"}),(0,h.jsx)(o.c,{onClick:R,color:"success",children:(0,h.jsx)(P,{className:"fa-20"})})]})}),(0,h.jsxs)(A.c,{children:[(0,h.jsx)("form",{onSubmit:e=>{e.preventDefault(),T((e=>(0,a.c)((0,a.c)({},e),{},{search:!e.search})))},children:(0,h.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,h.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===S||void 0===S?void 0:S.Fromdate,onChange:e=>T((t=>(0,a.c)((0,a.c)({},t),{},{Fromdate:e.target.value}))),required:!0})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,h.jsx)("input",{className:"cus-inpt p-2 w-auto ms-2",type:"date",min:S.Fromdate,value:null===S||void 0===S?void 0:S.Todate,onChange:e=>T((t=>(0,a.c)((0,a.c)({},t),{},{Todate:e.target.value}))),required:!0})]}),(0,h.jsx)(d.c,{variant:"outlined",className:"ms-2",type:"submit",children:"search"})]})}),(0,h.jsx)("div",{className:"table-responsive mt-3",children:(0,h.jsxs)("table",{className:"table table-bordered fa-13",children:[(0,h.jsx)("thead",{children:(0,h.jsx)("tr",{children:["Sno","#","Item","Qty","Pack","Rate","Amount","Order ID","Date","Invoice Value"].map(((e,t)=>(0,h.jsx)("th",{children:e},t)))})}),(0,h.jsx)("tbody",{children:b.filter((e=>(0,m.Qr)(e.Custome_Id,i))).map(((e,t)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:t+1}),(0,h.jsx)("td",{children:(()=>{const t=-1!==u.findIndex((t=>(0,m.Qr)(null===t||void 0===t?void 0:t.Pre_Id,e.Pre_Id)));return(0,h.jsx)("div",{children:(0,h.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:t,onChange:()=>{t?Q(e,!0):Q(e)}})})})()}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Tonnage}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Pre_Id}),(0,h.jsx)("td",{children:(0,m.uy)(null===e||void 0===e?void 0:e.Pre_Date)}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Total_Invoice_value})]},t)))})]})})]})]})]})};var D=l(90048),O=l(56084),w=l(64568);const M=e=>{var t;let{children:l,orderProducts:r=[],setOrderProducts:n,open:o=!1,onClose:v,products:x=[],brands:_=[],uom:p=[],GST_Inclusive:j,IS_IGST:I,editValues:b=null}=e;const[g,N]=(0,s.useState)(B),S=(0,m.Qr)(j,1),T=(0,m.Qr)(j,2),P=e=>{var t;return null!==(t=null===x||void 0===x?void 0:x.find((t=>(0,m.Qr)(null===t||void 0===t?void 0:t.Product_Id,e))))&&void 0!==t?t:{}};return(0,s.useEffect)((()=>{(0,m.CY)(b)&&o&&N((e=>Object.fromEntries(Object.entries(e).map((e=>{let[t,l]=e;return[t,b[t]?b[t]:l]})))))}),[b]),(0,h.jsxs)(h.Fragment,{children:[l,(0,h.jsxs)(f.c,{open:o,onClose:v,maxWidth:"sm",fullWidth:!0,children:[(0,h.jsx)(y.c,{className:"border-bottom",children:(0,h.jsx)("span",{children:"Add Products Details"})}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),g.Item_Id?(n((e=>[...e.filter((e=>!(0,m.Qr)(e.Item_Id,g.Item_Id))),Object.fromEntries(Object.entries(B).map((e=>{let[t,l]=e;const a=P(g.Item_Id),s=I?a.Igst_P:a.Gst_P,r=s>0,{Bill_Qty:d,Item_Rate:n,Amount:o}=g,i=T?"zerotax":S?"remove":"add",c=(0,C.O)(n,s,i),u=(0,C.O)(o,s,i),m=I?0:u.cgst_per,v=I?u.igst_per:0,h=I?0:u.cgst_amount,x=I?u.igst_amount:0;switch(t){case"Taxable_Rate":return[t,c.base_amount];case"Total_Qty":return[t,d];case"Taxble":return[t,r?1:0];case"Taxable_Amount":return[t,u.base_amount];case"Tax_Rate":return[t,s];case"Cgst":case"Sgst":return[t,null!==m&&void 0!==m?m:0];case"Cgst_Amo":case"Sgst_Amo":return[t,T?0:h];case"Igst":return[t,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[t,T?0:x];case"Final_Amo":return[t,u.with_tax];default:return[t,g[t]||l]}})))])),N(B),v()):u.m4.warn("Select Product")},children:[(0,h.jsx)(A.c,{children:(0,h.jsxs)("div",{className:"row pb-5",children:[(0,h.jsxs)("div",{className:"col-6 p-2",children:[(0,h.jsx)("label",{children:"Brand"}),(0,h.jsx)(i.cp,{value:{value:g.BrandID,label:g.Brand},onChange:e=>N((t=>(0,a.c)((0,a.c)({},t),{},{BrandID:e.value,Brand:e.label}))),options:[{value:"",label:"select",isDisabled:!0},_.map((e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name})))],styles:c.cF,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200})]}),(0,h.jsxs)("div",{className:"col-6 p-2",children:[(0,h.jsx)("label",{children:"Group"}),(0,h.jsx)(i.cp,{value:{value:g.GroupID,label:g.Group},onChange:e=>N((t=>(0,a.c)((0,a.c)({},t),{},{GroupID:e.value,Group:e.label}))),options:[{value:"",label:"select",isDisabled:!0},x.filter((e=>!g.BrandID||(0,m.Qr)(e.Brand,g.BrandID))).reduce(((e,t)=>(e.some((e=>e.value===t.Product_Group))||e.push({value:t.Product_Group,label:t.Pro_Group}),e)),[])],styles:c.cF,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200})]}),(0,h.jsxs)("div",{className:"col-12 p-2",children:[(0,h.jsxs)("label",{children:["Item Name ",(0,h.jsx)(w.c,{})]}),(0,h.jsx)(i.cp,{value:{value:g.Item_Id,label:null===(t=P(g.Item_Id))||void 0===t?void 0:t.Product_Name},isDisabled:(0,m.Q$)(g.Pre_Id),onChange:e=>{const t=P(e.value);N((l=>{var s,r,d,n,o,i,c;return(0,a.c)((0,a.c)({},l),{},{Group:null!==(s=t.Pro_Group)&&void 0!==s?s:l.Group,GroupID:null!==(r=t.Product_Group)&&void 0!==r?r:l.GroupID,Brand:null!==(d=t.Brand_Name)&&void 0!==d?d:l.Brand,BrandID:null!==(n=t.Brand)&&void 0!==n?n:l.BrandID,Item_Id:e.value,Item_Rate:null!==(o=t.Item_Rate)&&void 0!==o?o:0,Bill_Qty:0,Amount:0,Unit_Id:null!==(i=t.UOM_Id)&&void 0!==i?i:l.Unit_Id,Unit_Name:null!==(c=t.Units)&&void 0!==c?c:l.Unit_Name,HSN_Code:null===t||void 0===t?void 0:t.HSN_Code})}))},options:[{value:"",label:"select",isDisabled:!0},...[...x.filter((e=>!g.BrandID||(0,m.Qr)(e.Brand,g.BrandID))).filter((e=>!g.GroupID||(0,m.Qr)(e.Product_Group,g.GroupID)))].map((e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==r.findIndex((t=>(0,m.Qr)(null===t||void 0===t?void 0:t.Item_Id,null===e||void 0===e?void 0:e.Product_Id)))})))],styles:c.cF,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200})]}),(0,h.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,h.jsxs)("label",{children:["Quantity ",(0,h.jsx)(w.c,{})]}),(0,h.jsx)("input",{required:!0,value:g.Bill_Qty?g.Bill_Qty:"",onInput:m.Gk,onChange:e=>{g.Item_Rate?N((t=>(0,a.c)((0,a.c)({},t),{},{Amount:(0,m.eX)(g.Item_Rate,e.target.value),Bill_Qty:e.target.value}))):g.Amount?N((t=>(0,a.c)((0,a.c)({},t),{},{Item_Rate:(0,m.yy)(t.Amount,e.target.value),Bill_Qty:e.target.value}))):N((t=>(0,a.c)((0,a.c)({},t),{},{Bill_Qty:e.target.value})))},className:"cus-inpt",min:1})]}),(0,h.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,h.jsx)("label",{children:"Rate "}),(0,h.jsx)("input",{value:g.Item_Rate?g.Item_Rate:"",onInput:m.Gk,onChange:e=>N((t=>(0,a.c)((0,a.c)({},t),{},{Item_Rate:e.target.value,Amount:t.Bill_Qty?(0,m.eX)(e.target.value,t.Bill_Qty):t.Amount}))),required:!0,className:"cus-inpt"})]}),(0,h.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,h.jsx)("label",{children:"UOM"}),(0,h.jsxs)("select",{value:g.UOM,onChange:e=>{const t=e.target.selectedIndex,l=e.target.options[t].text,s=e.target.value;N((e=>(0,a.c)((0,a.c)({},e),{},{UOM:s,Units:l})))},className:"cus-inpt",children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"select"}),p.map(((e,t)=>(0,h.jsx)("option",{value:e.Unit_Id,children:e.Units},t)))]})]}),(0,h.jsxs)("div",{className:"col-md-6 p-2",children:[(0,h.jsx)("label",{children:"Amount"}),(0,h.jsx)("input",{required:!0,value:g.Amount?g.Amount:"",onInput:m.Gk,onChange:e=>N((t=>(0,a.c)((0,a.c)({},t),{},{Amount:e.target.value,Item_Rate:t.Bill_Qty?(0,m.yy)(e.target.value,t.Bill_Qty):t.Item_Rate}))),className:"cus-inpt",min:1})]})]})}),(0,h.jsxs)(D.c,{className:"d-flex justify-content-between align-items-center",children:[(0,h.jsx)(d.c,{onClick:()=>N(B),type:"button",startIcon:(0,h.jsx)(O.c,{}),children:"Clear"}),(0,h.jsxs)("span",{children:[(0,h.jsx)(d.c,{type:"button",onClick:v,children:"cancel"}),(0,h.jsx)(d.c,{type:"submit",variant:"outlined",children:"Add"})]})]})]})]})]})},k=(0,m.gV)().user,F=function(){var e;let t=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,m.Qr)(e.Product_Id,t))))&&void 0!==e?e:{}},H=e=>{var t,l;let{loadingOn:v,loadingOff:f}=e;const y=(0,T.i6)(),A=(0,T.IT)().state,[P,Q]=(0,s.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[D,O]=(0,s.useState)(R),[w,H]=(0,s.useState)([]),[V,U]=(0,s.useState)({}),[E,z]=(0,s.useState)(null),[q,L]=(0,s.useState)(!1),[$,W]=(0,s.useState)(!1),X=(0,m.Qr)(D.GST_Inclusive,1),Y=(0,m.Qr)(D.GST_Inclusive,2),Z=(0,m.Qr)(D.IS_IGST,1),J=Y?"zerotax":X?"remove":"add";(0,s.useEffect)((()=>{if((0,m.CY)(A)&&Array.isArray(null===A||void 0===A?void 0:A.Products_List)){const{Products_List:e}=A;O(Object.fromEntries(Object.entries(R).map((e=>{var t;let[l,a]=e;return"So_Date"===l?[l,A[l]?(0,m.Q7)(A[l]):a]:[l,null!==(t=A[l])&&void 0!==t?t:a]})))),H(e.map((e=>Object.fromEntries(Object.entries(B).map((t=>{var l;let[a,s]=t;return[a,null!==(l=e[a])&&void 0!==l?l:s]}))))))}}),[A]),(0,s.useEffect)((()=>{(async()=>{try{const[e,t,l,s,r,d,n,o,i]=await Promise.all([(0,N.q)({address:"masters/branch/dropDown"}),(0,N.q)({address:"masters/products"}),(0,N.q)({address:"masters/retailers/dropDown?Company_Id=".concat(null===k||void 0===k?void 0:k.Company_id)}),(0,N.q)({address:"purchase/voucherType"}),(0,N.q)({address:"masters/uom"}),(0,N.q)({address:"dataEntry/costCenter"}),(0,N.q)({address:"dataEntry/costCenter/category"}),(0,N.q)({address:"masters/users/salesPerson/dropDown"}),(0,N.q)({address:"masters/company?Company_id=".concat(null===k||void 0===k?void 0:k.Company_id)})]),c=(e.success?e.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===t||void 0===t?void 0:t.BranchName))),u=(t.success?t.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===t||void 0===t?void 0:t.Product_Name))),v=(l.success?l.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===t||void 0===t?void 0:t.Retailer_Name))),h=(s.success?s.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===t||void 0===t?void 0:t.Voucher_Type))),x=(r.success?r.data:[]).sort(((e,t)=>String(e.Units).localeCompare(t.Units))),_=(d.success?d.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===t||void 0===t?void 0:t.Cost_Center_Name))),p=(n.success?n.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===t||void 0===t?void 0:t.Cost_Category))),j=(o.success?o.data:[]).sort(((e,t)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===t||void 0===t?void 0:t.Name)));Q((e=>(0,a.c)((0,a.c)({},e),{},{products:u,branch:c,retailers:v,voucherType:h,uom:x,staff:_,staffType:p,salesPerson:j,brand:(0,m.Un)(u,"Brand",["Brand_Name"])}))),U(i.success&&null!==i&&void 0!==i&&i.data[0]?null===i||void 0===i?void 0:i.data[0]:{})}catch(e){console.error("Error fetching data:",e)}})()}),[null===k||void 0===k?void 0:k.Company_id]);const K=(0,s.useMemo)((()=>w.reduce(((e,t)=>{const l=(0,m.kR)(null===t||void 0===t?void 0:t.Amount);if(Y)return(0,m.Q5)(e,l);const a=F(P.products,t.Item_Id),s=(0,m.Qr)(Z,1)?a.Igst_P:a.Gst_P;return X?(0,m.Q5)(e,(0,C.O)(l,s,"remove").with_tax):(0,m.Q5)(e,(0,C.O)(l,s,"add").with_tax)}),0)),[w,Y,P.products,Z,X]),ee=(0,s.useMemo)((()=>w.reduce(((e,t)=>{const l=(0,m.kR)(null===t||void 0===t?void 0:t.Amount);if(Y)return{TotalValue:(0,m.Q5)(e.TotalValue,l),TotalTax:0};const a=F(P.products,t.Item_Id),s=(0,m.Qr)(Z,1)?a.Igst_P:a.Gst_P,r=(0,C.O)(l,s,X?"remove":"add");return{TotalValue:(0,m.Q5)(e.TotalValue,r.without_tax),TotalTax:(0,m.Q5)(e.TotalTax,r.tax_amount)}}),{TotalValue:0,TotalTax:0})),[w,Y,P.products,Z,X]);return(0,s.useEffect)((()=>{H((e=>[...e].map((e=>Object.fromEntries(Object.entries(B).map((t=>{let[l,a]=t;const s=F(P.products,null===e||void 0===e?void 0:e.Item_Id),r=Z?s.Igst_P:s.Gst_P,d=r>0,{Bill_Qty:n,Item_Rate:o,Amount:i}=e,c=(0,C.O)(o,r,J),u=(0,C.O)(i,r,J),m=Z?0:u.cgst_per,v=Z?u.igst_per:0,h=Z?0:u.cgst_amount,x=Z?u.igst_amount:0;switch(l){case"Taxable_Rate":return[l,c.base_amount];case"Total_Qty":return[l,n];case"Taxble":return[l,d?1:0];case"Taxable_Amount":return[l,u.base_amount];case"Tax_Rate":return[l,r];case"Cgst":case"Sgst":return[l,null!==m&&void 0!==m?m:0];case"Cgst_Amo":case"Sgst_Amo":return[l,Y?0:h];case"Igst":return[l,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[l,Y?0:x];case"Final_Amo":return[l,u.with_tax];default:return[l,e[l]||a]}})))))))}),[B,P.products,Z,J]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(M,{orderProducts:w,setOrderProducts:H,open:q,onClose:()=>{L(!1),z(null)},products:P.products,brands:P.brand,uom:P.uom,GST_Inclusive:D.GST_Inclusive,IS_IGST:Z,editValues:E}),(0,h.jsxs)(r.c,{children:[(0,h.jsxs)("div",{className:"d-flex align-items-center flex-wrap p-2",children:[(0,h.jsx)("h5",{className:"flex-grow-1 ps-2",children:"Create Order"}),(0,h.jsx)(d.c,{variant:"outlined",sx:{ml:1},startIcon:(0,h.jsx)(x,{}),onClick:()=>y("/erp/sales/saleOrder"),children:"Back"}),(0,h.jsx)(d.c,{variant:"outlined",sx:{ml:1},startIcon:(0,h.jsx)(_.c,{}),onClick:()=>{O(R),H([])},children:"Clear"})]}),(0,h.jsx)(n.c,{children:(0,h.jsxs)("div",{className:"pt-0",children:[(0,h.jsxs)("div",{className:"p-3 rounded-3 mb-3 shadow-sm",children:[(0,h.jsx)("h5",{className:"border-bottom",children:"From:"}),(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-lg-4 col-md-6",children:(0,h.jsx)("table",{className:"table table-borderless m-0 fa-13",children:(0,h.jsxs)("tbody",{children:[(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{children:[(0,h.jsx)("span",{className:"me-2",children:"Company: "}),(0,h.jsx)("span",{children:null===V||void 0===V?void 0:V.Company_Name})]})}),(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{children:[(0,h.jsx)("span",{className:"me-2",children:"Address: "}),(0,h.jsx)("span",{children:null===V||void 0===V?void 0:V.Company_Address})]})}),(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{children:[(0,h.jsx)("span",{className:"me-2",children:"Phone: "}),(0,h.jsx)("span",{children:null===V||void 0===V?void 0:V.Telephone_Number})]})})]})})}),(0,h.jsx)("div",{className:"col-lg-4 col-md-6",children:(0,h.jsx)("table",{className:"table table-borderless fa-13 m-0",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Date:"}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"date",value:null!==D&&void 0!==D&&D.So_Date?(0,m.Q7)(null===D||void 0===D?void 0:D.So_Date):"",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{So_Date:e.target.value})),className:"cus-inpt p-1"})})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Invoice Type:"}),(0,h.jsx)("td",{children:(0,h.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{GST_Inclusive:Number(e.target.value)})),value:D.GST_Inclusive,children:[(0,h.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,h.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,h.jsx)("option",{value:2,children:"Not Taxable"})]})})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Tax Type:"}),(0,h.jsx)("td",{children:(0,h.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{IS_IGST:Number(e.target.value)})),value:D.IS_IGST,children:[(0,h.jsx)("option",{value:"0",children:"GST"}),(0,h.jsx)("option",{value:"1",children:"IGST"})]})})]})]})})}),(0,h.jsx)("div",{className:"col-lg-4 col-md-6",children:(0,h.jsx)("table",{className:"table table-borderless fa-13 m-0",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Sales Person:"}),(0,h.jsx)("td",{children:(0,h.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{Sales_Person_Id:Number(e.target.value)})),value:D.Sales_Person_Id,children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"select sales person"}),(0,h.jsx)("option",{value:null===k||void 0===k?void 0:k.UserId,children:null===k||void 0===k?void 0:k.Name}),null===(t=P.salesPerson)||void 0===t?void 0:t.map(((e,t)=>(0,h.jsx)("option",{value:e.UserId,children:e.Name},t)))]})})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Voucher Type:"}),(0,h.jsx)("td",{children:(0,h.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{VoucherType:Number(e.target.value)})),value:D.VoucherType,children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),null===(l=P.voucherType)||void 0===l?void 0:l.filter((e=>"SALES"===e.Type)).map(((e,t)=>(0,h.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},t)))]})})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Branch"}),(0,h.jsx)("td",{children:(0,h.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>O((0,a.c)((0,a.c)({},D),{},{Branch_Id:Number(e.target.value)})),value:D.Branch_Id,children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),P.branch.map(((e,t)=>(0,h.jsx)("option",{value:e.BranchId,children:e.BranchName},t)))]})})]})]})})})]})]}),(0,h.jsxs)("div",{className:"p-3 rounded-3 mb-3 shadow-sm",children:[(0,h.jsx)("h5",{className:"border-bottom",children:"To:"}),(0,h.jsxs)("div",{className:"row ",children:[(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsx)("table",{className:"table table-borderless",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Retailer Name:"}),(0,h.jsx)("td",{children:(0,h.jsx)(i.cp,{value:{value:null===D||void 0===D?void 0:D.Retailer_Id,label:null===D||void 0===D?void 0:D.Retailer_Name},onChange:e=>{O((0,a.c)((0,a.c)({},D),{},{Retailer_Id:e.value,Retailer_Name:e.label})),H([])},options:[{value:"",label:"select",isDisabled:!0},...P.retailers.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:c.cF,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200})})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Address:"}),(0,h.jsx)("td",{children:k.Name})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Phone:"}),(0,h.jsx)("td",{})]})]})})}),(0,h.jsx)("div",{className:"col-md-6",children:(0,h.jsx)("table",{className:"table table-borderless",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Q-Pay:"}),(0,h.jsx)("td",{children:10})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"Frequency Days:"}),(0,h.jsx)("td",{children:20})]})]})})})]})]}),(0,h.jsx)(S.cp,{title:"Products",ButtonArea:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.c,{onClick:()=>{z(null),L(!0)},sx:{ml:1},variant:"outlined",startIcon:(0,h.jsx)(p.c,{}),disabled:!(0,m.Q$)(D.Retailer_Id)||w.length>0&&w.some((e=>(0,m.Q$)(e.Pre_Id))),children:"Add Product"}),(0,h.jsx)(G,{loadingOn:v,loadingOff:f,open:$,onClose:()=>W(!1),retailer:null===D||void 0===D?void 0:D.Retailer_Id,selectedItems:w,setSelectedItems:H,products:P.products,GST_Inclusive:D.GST_Inclusive,IS_IGST:Z,children:(0,h.jsx)(d.c,{onClick:()=>W(!0),disabled:!(0,m.Q$)(D.Retailer_Id)||w.length>0&&w.some((e=>!(0,m.Q$)(e.Pre_Id))),sx:{ml:1},variant:"outlined",startIcon:(0,h.jsx)(j.c,{}),children:"Import pos"})})]}),dataArray:w,columns:[{isCustomCell:!0,Cell:e=>{let{row:t}=e;return F(P.products,null===t||void 0===t?void 0:t.Item_Id).Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var t;let{row:l}=e;return null===(t=F(P.products,null===l||void 0===l?void 0:l.Item_Id).Product_Name)||void 0===t?void 0:t.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var t;let{row:l}=e;return(null===l||void 0===l?void 0:l.Bill_Qty)+" "+(null!==(t=null===l||void 0===l?void 0:l.Units)&&void 0!==t?t:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},(0,S.A5)("Item_Rate","number","Rate","right"),(0,S.A5)("Taxable_Amount","number","Taxable Amount","right"),{isCustomCell:!0,Cell:e=>{var t;let{row:l}=e;const a=null===(t=F(P.products,null===l||void 0===l?void 0:l.Item_Id))||void 0===t?void 0:t.Gst_P,s=(0,m.gH)(null===l||void 0===l?void 0:l.Amount),r=(0,C.O)(s,a,J);return(0,m.SA)(r.tax_amount)+" ("+r.tax_per+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var t,l;let{row:a}=e;const s=null===(t=F(P.products,null===a||void 0===a?void 0:a.Item_Id))||void 0===t?void 0:t.Gst_P,r=null!==(l=a.Amount)&&void 0!==l?l:0,d=(0,C.O)(r,s,J).tax_amount;return(0,m.SA)((0,m.Qr)(D.GST_Inclusive,1)?r:(0,m.Q5)(r,d))},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(o.c,{onClick:()=>{z(t),L(!0)},size:"small",children:(0,h.jsx)(I.c,{})}),(0,h.jsx)(o.c,{size:"small",onClick:()=>{(0,m.Q$)(null===t||void 0===t?void 0:t.Pre_Id)?H((e=>e.filter((e=>!(0,m.Qr)(null===e||void 0===e?void 0:e.Pre_Id,null===t||void 0===t?void 0:t.Pre_Id))))):H((e=>e.filter((e=>!(0,m.Qr)(e.Item_Id,t.Item_Id)))))},color:"error",children:(0,h.jsx)(b.c,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),w.length>0&&(0,h.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,h.jsx)("table",{className:"table",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{className:"border p-2",rowSpan:(0,m.Qr)(D.IS_IGST,1)?4:5,children:["Total in words: ",(0,m.m4)(parseInt(K))]}),(0,h.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.SA)(ee.TotalValue)})]}),(0,m.Qr)(D.IS_IGST,1)?(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border p-2",children:"IGST"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.SA)(ee.TotalTax)})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border p-2",children:"CGST"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.SA)(ee.TotalTax/2)})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border p-2",children:"SGST"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.SA)(ee.TotalTax/2)})]})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.kR)(Math.round(K)-K)})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border p-2",children:"Total"}),(0,h.jsx)("td",{className:"border p-2",children:(0,m.SA)(Math.round(K))})]})]})})}),(0,h.jsx)("p",{className:"fa-15 mt-3 m-0",children:"Narration"}),(0,h.jsx)("textarea",{className:"cus-inpt ",value:D.Narration,onChange:e=>O((t=>(0,a.c)((0,a.c)({},t),{},{Narration:e.target.value})))}),(0,h.jsx)("div",{className:"d-flex justify-content-end",children:(0,h.jsx)(d.c,{onClick:()=>{if((null===w||void 0===w?void 0:w.length)>0&&null!==D&&void 0!==D&&D.Retailer_Id)v(),(0,N.q)({address:"sales/saleOrder",method:(0,m.Q$)(null===D||void 0===D?void 0:D.So_Id)?"PUT":"POST",bodyData:(0,a.c)((0,a.c)({},D),{},{Product_Array:w.filter((e=>(0,m.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0)))})}).then((e=>{e.success?(u.m4.success(null===e||void 0===e?void 0:e.message),O(R),H([])):u.m4.error(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e))).finally((()=>f()));else{if(w.length<=0)return u.m4.error("Enter any one product quantity");if(null===D||void 0===D||!D.Retailer_Id)return u.m4.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,h.jsx)(g.c,{}),disabled:0===(null===w||void 0===w?void 0:w.length)||!(null!==D&&void 0!==D&&D.Retailer_Id),children:"Save"})})]})})]})]})}},96064:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},80156:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},56084:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll")},45180:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},86e3:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},36992:(e,t,l)=>{l.d(t,{c:()=>r});var a=l(27664),s=l(82496);const r=(0,a.c)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},84436:(e,t,l)=>{l.d(t,{c:()=>_});var a=l(45072),s=l(95656),r=l(69060),d=l(79736),n=l(21412),o=l(12556),i=l(49836),c=l(10099),u=l(33448);function m(e){return(0,u.cp)("MuiCardContent",e)}(0,c.c)("MuiCardContent",["root"]);var v=l(82496);const h=["className","component"],x=(0,o.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),_=r.forwardRef((function(e,t){const l=(0,i.C)({props:e,name:"MuiCardContent"}),{className:r,component:o="div"}=l,c=(0,s.c)(l,h),u=(0,a.c)({},l,{component:o}),_=(e=>{const{classes:t}=e;return(0,n.c)({root:["root"]},m,t)})(u);return(0,v.jsx)(x,(0,a.c)({as:o,className:(0,d.c)(_.root,r),ownerState:u,ref:t},c))}))}}]);
//# sourceMappingURL=2176.d6c3b149.chunk.js.map