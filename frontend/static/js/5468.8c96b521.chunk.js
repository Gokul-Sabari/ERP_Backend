"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5468],{95468:(e,l,t)=>{t.r(l),t.d(l,{default:()=>b});var i=t(30800),s=t(69060),r=t(1908),a=t(39308),d=t(13724),o=t(43692),n=t(5548),c=t(89e3),u=t(56480),h=t(57704),v=t(27664),m=t(82496);const x=(0,v.c)((0,m.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox");var p=t(86e3),g=t(80236);const b=e=>{let{loadingOn:l,loadingOff:t}=e;const[v,b]=(0,s.useState)({FromDate:(new Date).toISOString().split("T")[0],ToDate:(new Date).toISOString().split("T")[0],refresh:!1,search:""}),[j,C]=(0,s.useState)(""),[_,N]=(0,s.useState)([]),[y,f]=(0,s.useState)([]),[w,P]=(0,s.useState)(!1),[S,D]=(0,s.useState)(!1);(0,s.useEffect)((()=>{S&&(l&&l(),P(!0),(0,r.q)({address:"sales/presaleOrder/getList?FromDate=".concat(v.FromDate,"&ToDate=").concat(v.ToDate)}).then((e=>{e.success&&(N(e.data),f(y))})).catch((e=>{console.error(e)})).finally((()=>{P(!1),D(!1),t&&t()})))}),[v.refresh,S]);const A=e=>String(e).toLowerCase().replace(/\s+/g," ").replace(/[^a-z0-9]/gi,"").trim(),I=(0,s.useMemo)((()=>{const e=A(v.search||"");return _.filter((l=>{let t=[];for(let e in l)"ProductList"!==e&&t.push(l[e]);Array.isArray(l.ProductList)&&l.ProductList.forEach((e=>{t.push(...Object.values(e))}));return A(t.join(" ")).includes(e)}))}),[v.search,_]),F=e=>{var l,t;let{row:i}=e;return(0,m.jsx)(m.Fragment,{children:(null===i||void 0===i||null===(l=i.ProductList)||void 0===l?void 0:l.length)>0&&(0,m.jsxs)("table",{className:"table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{className:"border p-2 bg-light",children:"S_No"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Item_Id"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Product_Name"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Bill_Qty"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Item_Rate"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Unit_Id"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Unit_Name"}),(0,m.jsx)("th",{className:"border p-2 bg-light",children:"Amount"})]})}),(0,m.jsx)("tbody",{children:null===i||void 0===i||null===(t=i.ProductList)||void 0===t?void 0:t.map(((e,l)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.S_No}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Item_Id}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Product_Name}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Item_Rate}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Unit_Id}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Unit_Name}),(0,m.jsx)("td",{className:"border p-2",children:null===e||void 0===e?void 0:e.Amount})]},l)))})]})})},T=e=>{l();const s=Array.isArray(e.ProductList)?e.ProductList.filter((e=>(0,a.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0))).map((l=>{const t=(e=>{const l=null===e||void 0===e?void 0:e.match(/(\d+)\s?kg/i);return l?parseInt(l[1]):1})(null===l||void 0===l?void 0:l.Product_Name);return(0,i.c)((0,i.c)({},l),{},{Pre_Id:null===e||void 0===e?void 0:e.Pre_Id,Bill_Qty:t*(null===l||void 0===l?void 0:l.Bill_Qty),Total_Qty:null===l||void 0===l?void 0:l.Bill_Qty})})):[],d=(0,i.c)((0,i.c)({},e),{},{Product_Array:s,Retailer_Id:null===e||void 0===e?void 0:e.Custome_Id});(0,r.q)({address:"sales/presaleOrder/saleOrderCreationWithPso",method:0!==(null===e||void 0===e?void 0:e.isConverted)?"PUT":"POST",bodyData:d}).then((e=>{e.success?(u.m4.success(null===e||void 0===e?void 0:e.message),P(!0)):u.m4.error(null===e||void 0===e?void 0:e.message)})).catch((()=>{u.m4.error("Something went wrong!")})).finally((()=>t()))};return(0,s.useEffect)((()=>{w&&(0,r.q)({address:"sales/presaleOrder/getList?FromDate=".concat(v.FromDate,"&ToDate=").concat(v.ToDate)}).then((e=>{e.success&&(N(e.data),f(e.data))})).catch((e=>console.error(e))).finally((()=>P(!1)))}),[w,v.FromDate,v.ToDate]),(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(o.c,{children:[(0,m.jsx)("div",{className:"px-3 py-2 fa-14",children:(0,m.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,m.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,m.jsx)("td",{children:(0,m.jsx)("input",{type:"date",value:v.FromDate,onChange:e=>b((0,i.c)((0,i.c)({},v),{},{FromDate:e.target.value})),className:"cus-inpt"})}),(0,m.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,m.jsx)("td",{children:(0,m.jsx)("input",{type:"date",value:v.ToDate,onChange:e=>b((0,i.c)((0,i.c)({},v),{},{ToDate:e.target.value})),className:"cus-inpt"})}),(0,m.jsx)(n.c,{size:"small",onClick:()=>{D(!0)},children:(0,m.jsx)(h.c,{})}),(0,m.jsx)(n.c,{size:"small",onClick:()=>{b((e=>(0,i.c)((0,i.c)({},e),{},{viewNotSynced:!e.viewNotSynced})))}})]})}),v.search?(0,m.jsx)(d.cp,{title:"Pre-Sale Order List",bodyFontSizePx:11,headerFontSizePx:11,dataArray:I,columns:[(0,d.A5)("Pre_Id","string","Pre_Id"),{Field_Name:"Pre_Date",ColumnHeader:"Pre_Date",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,m.jsx)("td",{className:"fa-12",style:{minWidth:"80px"},children:null===l||void 0===l?void 0:l.Pre_Date.split("T")[0]})}},(0,d.A5)("Retailer_Name","string","Retailer_Name"),(0,d.A5)("Total_Invoice_value","string","Total_Invoice_value"),{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,t;let{row:i}=e;const s=g.o.find((e=>e.id===Number(null===i||void 0===i?void 0:i.isConverted)));return(0,m.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(t=null===s||void 0===s?void 0:s.label)&&void 0!==t?t:"Undefined"})}},{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,m.jsx)("td",{className:"fa-12",style:{minWidth:"80px"},children:(0,m.jsx)(n.c,{size:"small",onClick:()=>T(l),children:0===(null===l||void 0===l?void 0:l.isConverted)?(0,m.jsx)(x,{}):(0,m.jsx)(p.c,{})})})}}],isExpendable:!0,tableMaxHeight:550,expandableComp:F,ButtonArea:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.c,{sx:{ml:1},variant:"outlined",onClick:()=>b((e=>(0,i.c)((0,i.c)({},e),{},{search:j}))),children:"Search"}),(0,m.jsx)("input",{type:"search",className:"cus-inpt p-1 w-auto",value:j,onChange:e=>C(e.target.value),placeholder:"Search.."})]})}):(0,m.jsx)(d.cp,{title:"Pre-Sale Order List",bodyFontSizePx:11,headerFontSizePx:11,dataArray:_,columns:[(0,d.A5)("Pre_Id","string","Pre_Id"),{Field_Name:"Pre_Date",ColumnHeader:"Pre_Date",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,m.jsx)("td",{className:"fa-12",style:{minWidth:"80px"},children:null===l||void 0===l?void 0:l.Pre_Date.split("T")[0]})}},(0,d.A5)("Retailer_Name","string","Retailer_Name"),(0,d.A5)("Total_Invoice_value","string","Total_Invoice_value"),{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,t;let{row:i}=e;const s=g.o.find((e=>e.id===Number(null===i||void 0===i?void 0:i.isConverted)));return(0,m.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(t=null===s||void 0===s?void 0:s.label)&&void 0!==t?t:"Undefined"})}},{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,m.jsx)("td",{className:"fa-12",style:{minWidth:"80px"},children:(0,m.jsx)(n.c,{size:"small",onClick:()=>T(l),children:0===(null===l||void 0===l?void 0:l.isConverted)?(0,m.jsx)(x,{}):(0,m.jsx)(p.c,{})})})}}],isExpendable:!0,tableMaxHeight:550,expandableComp:F,ButtonArea:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.c,{sx:{ml:1},variant:"outlined",onClick:()=>b((e=>(0,i.c)((0,i.c)({},e),{},{search:j}))),children:"Search"}),(0,m.jsx)("input",{type:"search",className:"cus-inpt p-1 w-auto",value:j,onChange:e=>C(e.target.value),placeholder:"Search.."})]})})]})})}},80236:(e,l,t)=>{t.d(l,{W:()=>s,o:()=>i});const i=[{id:0,label:"New",color:" bg-info text-white "},{id:1,label:"Verified",color:" bg-warning text-white "},{id:2,label:"Converted",color:" bg-success text-white "},{id:3,label:"Canceled",color:" bg-danger text-white "}],s=[{id:1,label:"New",color:" bg-info text-white "},{id:2,label:"Progess",color:" bg-warning text-white "},{id:3,label:"Completed",color:" bg-success text-white "},{id:4,label:"Canceled",color:" bg-danger text-white "}]},86e3:(e,l,t)=>{t.d(l,{c:()=>r});var i=t(27664),s=t(82496);const r=(0,i.c)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},57704:(e,l,t)=>{t.d(l,{c:()=>r});var i=t(27664),s=t(82496);const r=(0,i.c)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=5468.8c96b521.chunk.js.map