"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5660],{15660:(e,l,s)=>{s.r(l),s.d(l,{default:()=>F});var a=s(30800),t=s(69060),r=s(43692),o=s(89e3),d=s(84436),n=s(5548),i=s(40656),c=s(62344),u=s(56480),m=s(39308),v=s(27664),_=s(82496);const h=(0,v.c)((0,_.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft");var x=s(80156),p=s(96064),I=s(49608),j=s(86e3),f=s(45180),C=s(36992),S=s(1908),b=s(13724),T=s(128),g=s(51560);const N=(0,m.gV)().user,y={So_Id:"",So_Inv_No:"",So_Year:"",So_Branch_Inv_Id:"",So_Date:(0,m.Q7)(),Retailer_Id:"",Retailer_Name:"",Sales_Person_Id:"",Branch_Id:"",VoucherType:"",GST_Inclusive:2,IS_IGST:0,Narration:"",isConverted:"",Cancel_status:"",CSGT_Total:0,SGST_Total:0,IGST_Total:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Created_by:null===N||void 0===N?void 0:N.UserId,Altered_by:null===N||void 0===N?void 0:N.UserId,Approved_By:"",Approve_Status:"",Created_on:"",Alterd_on:"",Trans_Type:"",Alter_Id:""},A={BrandID:"",Brand:"",GroupID:"",Group:"",SO_St_Id:"",So_Date:"",Sales_Order_Id:"",S_No:"",Pre_Id:"",Item_Id:"",Item_Rate:0,Bill_Qty:0,Amount:0,HSN_Code:"",Unit_Id:"",Unit_Name:"",Free_Qty:0,Total_Qty:0,Taxble:0,Taxable_Rate:0,Taxable_Amount:0,Tax_Rate:0,Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Final_Amo:0,Created_on:""},P={Id:"",So_Id:"",Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",EmpType:""};var Q=s(82656),R=s(26773),O=s(4488),G=s(42376);const w=e=>{let{loadingOn:l,loadingOff:s,open:r,onClose:d,retailer:i,children:c,selectedItems:u,setSelectedItems:v,products:h=[],GST_Inclusive:x,IS_IGST:p}=e;const I=(0,m.Qr)(x,1),j=(0,m.Qr)(x,2),[f,C]=(0,t.useState)([]),[b,g]=(0,t.useState)({Fromdate:(0,m.Q7)(),Todate:(0,m.Q7)(),search:!1});(0,t.useEffect)((()=>{if((0,m.Q$)(i)&&r){const{Fromdate:e,Todate:a}=b;l&&l(),(0,S.q)({address:"sales/saleOrder/importPosOrders?Fromdate=".concat(e,"&Todate=").concat(a,"&Retailer_Id=").concat(i)}).then((e=>{e.success?C(e.data):C([])})).catch((e=>console.error(e))).finally((()=>{s&&s()}))}}),[b.search]);const N=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v((s=>{const a=s.filter((l=>!(0,m.Qr)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id)));let t;if(l)t=a;else{const l=f.filter((l=>(0,m.Qr)(l.Pre_Id,e.Pre_Id))).map((e=>Object.fromEntries(Object.entries(A).map((l=>{var s,a,t,r,o;let[d,n]=l;const i=(e=>{var l;return null!==(l=null===h||void 0===h?void 0:h.find((l=>(0,m.Qr)(null===l||void 0===l?void 0:l.Product_Id,e))))&&void 0!==l?l:{}})(e.Item_Id),c=p?i.Igst_P:i.Gst_P,u=c>0,{Item_Rate:v,Bill_Qty:_,Tonnage:x,PackValue:f}=e,C=(0,m.eX)(v,(0,m.eX)(_,f)),S=j?"zerotax":I?"remove":"add",b=(0,T.O)(v,c,S),g=(0,T.O)(C,c,S),N=p?0:g.cgst_per,y=p?g.igst_per:0,A=p?0:g.cgst_amount,P=p?g.igst_amount:0;switch(d){case"Pre_Id":return[d,null!==(s=e.Pre_Id)&&void 0!==s?s:n];case"Item_Id":return[d,null!==(a=e.Item_Id)&&void 0!==a?a:n];case"Item_Rate":return[d,(0,m.gH)(v)];case"Bill_Qty":case"Total_Qty":return[d,(0,m.gH)(x)];case"Amount":return[d,C];case"Unit_Id":return[d,null!==(t=e.Unit_Id)&&void 0!==t?t:n];case"Unit_Name":return[d,null!==(r=e.Units)&&void 0!==r?r:n];case"HSN_Code":return[d,null!==(o=i.HSN_Code)&&void 0!==o?o:n];case"Taxable_Rate":return[d,b.base_amount];case"Taxble":return[d,u?1:0];case"Taxable_Amount":return[d,g.base_amount];case"Tax_Rate":return[d,c];case"Cgst":case"Sgst":return[d,null!==N&&void 0!==N?N:0];case"Cgst_Amo":case"Sgst_Amo":return[d,j?0:A];case"Igst":return[d,null!==y&&void 0!==y?y:0];case"Igst_Amo":return[d,j?0:P];case"Final_Amo":return[d,g.with_tax];default:return[d,n]}})))));t=[...a,...l]}return t}))},y=()=>{d&&d(),C([])};return(0,_.jsxs)(_.Fragment,{children:[c,(0,_.jsxs)(Q.c,{open:r,onClose:y,fullScreen:!0,children:[(0,_.jsx)(R.c,{children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,_.jsx)("span",{className:"flex-grow-1",children:"Import from POS"}),(0,_.jsx)(n.c,{onClick:y,color:"success",children:(0,_.jsx)(G.c,{className:"fa-20"})})]})}),(0,_.jsxs)(O.c,{children:[(0,_.jsx)("form",{onSubmit:e=>{e.preventDefault(),g((e=>(0,a.c)((0,a.c)({},e),{},{search:!e.search})))},children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===b||void 0===b?void 0:b.Fromdate,onChange:e=>g((l=>(0,a.c)((0,a.c)({},l),{},{Fromdate:e.target.value}))),required:!0})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto ms-2",type:"date",min:b.Fromdate,value:null===b||void 0===b?void 0:b.Todate,onChange:e=>g((l=>(0,a.c)((0,a.c)({},l),{},{Todate:e.target.value}))),required:!0})]}),(0,_.jsx)(o.c,{variant:"outlined",className:"ms-2",type:"submit",children:"search"})]})}),(0,_.jsx)("div",{className:"table-responsive mt-3",children:(0,_.jsxs)("table",{className:"table table-bordered fa-13",children:[(0,_.jsx)("thead",{children:(0,_.jsx)("tr",{children:["Sno","#","Item","Qty","Pack","Rate","Amount","Order ID","Date","Invoice Value"].map(((e,l)=>(0,_.jsx)("th",{children:e},l)))})}),(0,_.jsx)("tbody",{children:f.filter((e=>(0,m.Qr)(e.Custome_Id,i))).map(((e,l)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:l+1}),(0,_.jsx)("td",{children:(()=>{const l=-1!==u.findIndex((l=>(0,m.Qr)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id)));return(0,_.jsx)("div",{children:(0,_.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:l,onChange:()=>{l?N(e,!0):N(e)}})})})()}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Tonnage}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Pre_Id}),(0,_.jsx)("td",{children:(0,m.uy)(null===e||void 0===e?void 0:e.Pre_Date)}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Total_Invoice_value})]},l)))})]})})]})]})]})};var V=s(664);const k=e=>{let{StaffArray:l=[],setStaffArray:s,costCenter:t=[],costCategory:r=[]}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,_.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,_.jsx)(o.c,{variant:"outlined",color:"primary",type:"button",onClick:()=>s((e=>[...e,(0,a.c)({},P)])),children:"Add"})]}),(0,_.jsxs)("table",{className:"table table-bordered",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:"fa-13",children:"Sno"}),(0,_.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,_.jsx)("th",{className:"fa-13",children:"Category"}),(0,_.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,_.jsx)("tbody",{children:(0,m.dq)(l).map(((e,o)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"fa-13 vctr text-center",children:o+1}),(0,_.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,_.jsx)(i.cp,{value:{value:null===e||void 0===e?void 0:e.Involved_Emp_Id,label:null===e||void 0===e?void 0:e.EmpName},onChange:e=>s((l=>l.map(((l,s)=>{if((0,m.Qr)(s,o)){const s=(0,m.dq)(t).find((l=>(0,m.Qr)(null===l||void 0===l?void 0:l.Cost_Center_Id,e.value)));return(0,a.c)((0,a.c)({},l),{},{Cost_Center_Type_Id:(0,m.Q$)(null===l||void 0===l?void 0:l.Cost_Center_Type_Id)?Number(null===l||void 0===l?void 0:l.Cost_Center_Type_Id):(0,m.Q$)(s.User_Type)?Number(s.User_Type):0,Involved_Emp_Id:Number(e.value),EmpName:e.label})}return l})))),options:[...(0,m.dq)(t).filter((e=>!l.some((l=>(0,m.Qr)(l.Emp_Id,e.Cost_Center_Id)))))].map((e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name}))),styles:c.cF,isSearchable:!0,placeholder:"Select Staff"})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,_.jsxs)("select",{value:null===e||void 0===e?void 0:e.Cost_Center_Type_Id,onChange:e=>s((l=>l.map(((l,s)=>(0,m.Qr)(s,o)?(0,a.c)((0,a.c)({},l),{},{Cost_Center_Type_Id:e.target.value}):l)))),className:"cus-inpt p-2 border-0",children:[(0,_.jsx)("option",{value:"",children:"Select"}),(0,m.dq)(r).map(((e,l)=>(0,_.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},l)))]})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",children:(0,_.jsx)(n.c,{onClick:()=>{s((e=>e.filter(((e,l)=>o!==l))))},size:"small",children:(0,_.jsx)(f.c,{color:"error"})})})]},o)))})]})]})};var B=s(64568);const E=(0,m.gV)().user,D=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,m.Qr)(e.Product_Id,l))))&&void 0!==e?e:{}},F=e=>{var l,s;let{loadingOn:v,loadingOff:N}=e;const Q=(0,g.i6)(),R=(0,g.IT)().state,[O,G]=(0,t.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[F,H]=(0,t.useState)(y),[q,U]=(0,t.useState)([]),[z,$]=(0,t.useState)([]),[L,M]=(0,t.useState)(null),[W,X]=(0,t.useState)(!1),[Y,J]=(0,t.useState)(!1),K=(0,m.Qr)(F.GST_Inclusive,1),Z=(0,m.Qr)(F.GST_Inclusive,2),ee=(0,m.Qr)(F.IS_IGST,1),le=Z?"zerotax":K?"remove":"add";(0,t.useEffect)((()=>{if((0,m.CY)(R)&&Array.isArray(null===R||void 0===R?void 0:R.Products_List)&&Array.isArray(null===R||void 0===R?void 0:R.Staff_Involved_List)){const{Products_List:e,Staff_Involved_List:l}=R;H(Object.fromEntries(Object.entries(y).map((e=>{var l;let[s,a]=e;return"So_Date"===s?[s,R[s]?(0,m.Q7)(R[s]):a]:[s,null!==(l=R[s])&&void 0!==l?l:a]})))),U(e.map((e=>Object.fromEntries(Object.entries(A).map((l=>{var s;let[a,t]=l;return[a,null!==(s=e[a])&&void 0!==s?s:t]})))))),$(l.map((e=>Object.fromEntries(Object.entries(P).map((l=>{var s;let[a,t]=l;return[a,null!==(s=e[a])&&void 0!==s?s:t]}))))))}}),[R]),(0,t.useEffect)((()=>{(async()=>{try{v&&v();const[e,l,s,t,r,o,d,n]=await Promise.all([(0,S.q)({address:"masters/branch/dropDown"}),(0,S.q)({address:"masters/products"}),(0,S.q)({address:"masters/retailers/dropDown?Company_Id=".concat(null===E||void 0===E?void 0:E.Company_id)}),(0,S.q)({address:"purchase/voucherType"}),(0,S.q)({address:"masters/uom"}),(0,S.q)({address:"dataEntry/costCenter"}),(0,S.q)({address:"dataEntry/costCenter/category"}),(0,S.q)({address:"masters/users/salesPerson/dropDown"})]),i=(e.success?e.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===l||void 0===l?void 0:l.BranchName))),c=(l.success?l.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===l||void 0===l?void 0:l.Product_Name))),u=(s.success?s.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===l||void 0===l?void 0:l.Retailer_Name))),_=(t.success?t.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===l||void 0===l?void 0:l.Voucher_Type))),h=(r.success?r.data:[]).sort(((e,l)=>String(e.Units).localeCompare(l.Units))),x=(o.success?o.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===l||void 0===l?void 0:l.Cost_Center_Name))),p=(d.success?d.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===l||void 0===l?void 0:l.Cost_Category))),I=(n.success?n.data:[]).sort(((e,l)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===l||void 0===l?void 0:l.Name)));G((e=>(0,a.c)((0,a.c)({},e),{},{products:c,branch:i,retailers:u,voucherType:_,uom:h,staff:x,staffType:p,salesPerson:I,brand:(0,m.Un)(c,"Brand",["Brand_Name"])})))}catch(e){console.error("Error fetching data:",e)}finally{N&&N()}})()}),[null===E||void 0===E?void 0:E.Company_id]);const se=()=>{H(y),U([]),$([])},ae=(0,t.useMemo)((()=>q.reduce(((e,l)=>{const s=(0,m.kR)(null===l||void 0===l?void 0:l.Amount);if(Z)return(0,m.Q5)(e,s);const a=D(O.products,l.Item_Id),t=(0,m.Qr)(ee,1)?a.Igst_P:a.Gst_P;return K?(0,m.Q5)(e,(0,T.O)(s,t,"remove").with_tax):(0,m.Q5)(e,(0,T.O)(s,t,"add").with_tax)}),0)),[q,Z,O.products,ee,K]),te=(0,t.useMemo)((()=>q.reduce(((e,l)=>{const s=(0,m.kR)(null===l||void 0===l?void 0:l.Amount);if(Z)return{TotalValue:(0,m.Q5)(e.TotalValue,s),TotalTax:0};const a=D(O.products,l.Item_Id),t=(0,m.Qr)(ee,1)?a.Igst_P:a.Gst_P,r=(0,T.O)(s,t,K?"remove":"add");return{TotalValue:(0,m.Q5)(e.TotalValue,r.without_tax),TotalTax:(0,m.Q5)(e.TotalTax,r.tax_amount)}}),{TotalValue:0,TotalTax:0})),[q,Z,O.products,ee,K]);return(0,t.useEffect)((()=>{U((e=>[...e].map((e=>Object.fromEntries(Object.entries(A).map((l=>{let[s,a]=l;const t=D(O.products,null===e||void 0===e?void 0:e.Item_Id),r=ee?t.Igst_P:t.Gst_P,o=r>0,{Bill_Qty:d,Item_Rate:n,Amount:i}=e,c=(0,T.O)(n,r,le),u=(0,T.O)(i,r,le),m=ee?0:u.cgst_per,v=ee?u.igst_per:0,_=ee?0:u.cgst_amount,h=ee?u.igst_amount:0;switch(s){case"Taxable_Rate":return[s,c.base_amount];case"Total_Qty":return[s,d];case"Taxble":return[s,o?1:0];case"Taxable_Amount":return[s,u.base_amount];case"Tax_Rate":return[s,r];case"Cgst":case"Sgst":return[s,null!==m&&void 0!==m?m:0];case"Cgst_Amo":case"Sgst_Amo":return[s,Z?0:_];case"Igst":return[s,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[s,Z?0:h];case"Final_Amo":return[s,u.with_tax];default:return[s,e[s]||a]}})))))))}),[A,O.products,ee,le]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(V.c,{orderProducts:q,setOrderProducts:U,open:W,onClose:()=>{X(!1),M(null)},products:O.products,brands:O.brand,uom:O.uom,GST_Inclusive:F.GST_Inclusive,IS_IGST:ee,editValues:L,initialValue:A}),(0,_.jsxs)(r.c,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap p-2",children:[(0,_.jsx)("h5",{className:"flex-grow-1 ps-2",children:"Sale Order Creation"}),(0,_.jsx)(o.c,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(h,{}),onClick:()=>Q("/erp/sales/saleOrder"),children:"Back"}),(0,_.jsx)(o.c,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(x.c,{}),onClick:se,children:"Clear"})]}),(0,_.jsxs)(d.c,{children:[(0,_.jsxs)("div",{className:"row",children:[(0,_.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,_.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsx)(k,{StaffArray:z,setStaffArray:$,costCenter:O.staff,costCategory:O.staffType})})}),(0,_.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,_.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsxs)("div",{className:"row",children:[(0,_.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Retailer Name ",(0,_.jsx)(B.c,{})]}),(0,_.jsx)(i.cp,{value:{value:null===F||void 0===F?void 0:F.Retailer_Id,label:null===F||void 0===F?void 0:F.Retailer_Name},onChange:e=>{H((0,a.c)((0,a.c)({},F),{},{Retailer_Id:e.value,Retailer_Name:e.label})),U([])},options:[{value:"",label:"select",isDisabled:!0},...O.retailers.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:c.cF,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200})]}),(0,_.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Voucher Type ",(0,_.jsx)(B.c,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{VoucherType:Number(e.target.value)})),value:F.VoucherType,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),null===(l=O.voucherType)||void 0===l?void 0:l.filter((e=>"SALES"===e.Type)).map(((e,l)=>(0,_.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Date ",(0,_.jsx)(B.c,{})]}),(0,_.jsx)("input",{type:"date",value:null!==F&&void 0!==F&&F.So_Date?(0,m.Q7)(null===F||void 0===F?void 0:F.So_Date):"",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{So_Date:e.target.value})),className:"cus-inpt p-2"})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Invoice Type ",(0,_.jsx)(B.c,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{GST_Inclusive:Number(e.target.value)})),value:F.GST_Inclusive,children:[(0,_.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,_.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,_.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Tax Type ",(0,_.jsx)(B.c,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{IS_IGST:Number(e.target.value)})),value:F.IS_IGST,children:[(0,_.jsx)("option",{value:"0",children:"GST"}),(0,_.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Sales Person ",(0,_.jsx)(B.c,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{Sales_Person_Id:Number(e.target.value)})),value:F.Sales_Person_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select sales person"}),(0,_.jsx)("option",{value:null===E||void 0===E?void 0:E.UserId,children:null===E||void 0===E?void 0:E.Name}),null===(s=O.salesPerson)||void 0===s?void 0:s.map(((e,l)=>(0,_.jsx)("option",{value:e.UserId,children:e.Name},l)))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Branch ",(0,_.jsx)(B.c,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,a.c)((0,a.c)({},F),{},{Branch_Id:Number(e.target.value)})),value:F.Branch_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),O.branch.map(((e,l)=>(0,_.jsx)("option",{value:e.BranchId,children:e.BranchName},l)))]})]}),(0,_.jsxs)("div",{className:"col-12 p-2",children:[(0,_.jsx)("label",{className:"fa-13",children:"Narration"}),(0,_.jsx)("textarea",{className:"cus-inpt ",value:F.Narration,onChange:e=>H((l=>(0,a.c)((0,a.c)({},l),{},{Narration:e.target.value})))})]})]})})})]}),(0,_.jsx)(b.cp,{title:"Products",ButtonArea:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(o.c,{onClick:()=>{M(null),X(!0)},sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(p.c,{}),disabled:!(0,m.Q$)(F.Retailer_Id)||q.length>0&&q.some((e=>(0,m.Q$)(e.Pre_Id))),children:"Add Product"}),(0,_.jsx)(w,{loadingOn:v,loadingOff:N,open:Y,onClose:()=>J(!1),retailer:null===F||void 0===F?void 0:F.Retailer_Id,selectedItems:q,setSelectedItems:U,products:O.products,GST_Inclusive:F.GST_Inclusive,IS_IGST:ee,children:(0,_.jsx)(o.c,{onClick:()=>J(!0),disabled:!(0,m.Q$)(F.Retailer_Id)||q.length>0&&q.some((e=>!(0,m.Q$)(e.Pre_Id))),sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(I.c,{}),children:"Import pos"})})]}),dataArray:q,columns:[{isCustomCell:!0,Cell:e=>{let{row:l}=e;return D(O.products,null===l||void 0===l?void 0:l.Item_Id).Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;return null===(l=D(O.products,null===s||void 0===s?void 0:s.Item_Id).Product_Name)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;return(null===s||void 0===s?void 0:s.Bill_Qty)+" "+(null!==(l=null===s||void 0===s?void 0:s.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},(0,b.A5)("Item_Rate","number","Rate","right"),(0,b.A5)("Taxable_Amount","number","Taxable Amount","right"),{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;const a=null===(l=D(O.products,null===s||void 0===s?void 0:s.Item_Id))||void 0===l?void 0:l.Gst_P,t=(0,m.gH)(null===s||void 0===s?void 0:s.Amount),r=(0,T.O)(t,a,le);return(0,m.SA)(r.tax_amount)+" ("+r.tax_per+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var l,s;let{row:a}=e;const t=null===(l=D(O.products,null===a||void 0===a?void 0:a.Item_Id))||void 0===l?void 0:l.Gst_P,r=null!==(s=a.Amount)&&void 0!==s?s:0,o=(0,T.O)(r,t,le).tax_amount;return(0,m.SA)((0,m.Qr)(F.GST_Inclusive,1)?r:(0,m.Q5)(r,o))},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(n.c,{onClick:()=>{M(l),X(!0)},size:"small",children:(0,_.jsx)(j.c,{})}),(0,_.jsx)(n.c,{size:"small",onClick:()=>{(0,m.Q$)(null===l||void 0===l?void 0:l.Pre_Id)?U((e=>e.filter((e=>!(0,m.Qr)(null===e||void 0===e?void 0:e.Pre_Id,null===l||void 0===l?void 0:l.Pre_Id))))):U((e=>e.filter((e=>!(0,m.Qr)(e.Item_Id,l.Item_Id)))))},color:"error",children:(0,_.jsx)(f.c,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),q.length>0&&(0,_.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,_.jsx)("table",{className:"table",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{className:"border p-2",rowSpan:(0,m.Qr)(F.IS_IGST,1)?4:5,children:["Total in words: ",(0,m.m4)(parseInt(ae))]}),(0,_.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.SA)(te.TotalValue)})]}),(0,m.Qr)(F.IS_IGST,1)?(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"IGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.SA)(te.TotalTax)})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"CGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.SA)(te.TotalTax/2)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"SGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.SA)(te.TotalTax/2)})]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.kR)(Math.round(ae)-ae)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Total"}),(0,_.jsx)("td",{className:"border p-2",children:(0,m.SA)(Math.round(ae))})]})]})})}),(0,_.jsx)("div",{className:"d-flex justify-content-end",children:(0,_.jsx)(o.c,{onClick:()=>{if((null===q||void 0===q?void 0:q.length)>0&&null!==F&&void 0!==F&&F.Retailer_Id)v(),(0,S.q)({address:"sales/saleOrder",method:(0,m.Q$)(null===F||void 0===F?void 0:F.So_Id)?"PUT":"POST",bodyData:(0,a.c)((0,a.c)({},F),{},{Product_Array:q.filter((e=>(0,m.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0))),Staff_Involved_List:z})}).then((e=>{e.success?(u.m4.success(null===e||void 0===e?void 0:e.message),se()):u.m4.error(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e))).finally((()=>N()));else{if(q.length<=0)return u.m4.error("Enter any one product quantity");if(null===F||void 0===F||!F.Retailer_Id)return u.m4.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,_.jsx)(C.c,{}),disabled:0===(null===q||void 0===q?void 0:q.length)||!(null!==F&&void 0!==F&&F.Retailer_Id),children:"Save"})})]})]})]})}},80156:(e,l,s)=>{s.d(l,{c:()=>r});var a=s(27664),t=s(82496);const r=(0,a.c)((0,t.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},36992:(e,l,s)=>{s.d(l,{c:()=>r});var a=s(27664),t=s(82496);const r=(0,a.c)((0,t.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")}}]);
//# sourceMappingURL=5660.45316b6c.chunk.js.map