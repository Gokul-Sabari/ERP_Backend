"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[9052],{19052:(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var a=s(69060),i=s(44380),r=s(5548),c=s(82656),l=s(26773),d=s(4488),n=s(90048),o=s(75848),m=s(89e3),u=s(56480),h=s(42136),N=s(57704),_=s(86e3),x=s(45180),S=s(1908),D=s(13724),b=s(82496);const j={District_Id:0,District_Name:"",State_Id:0,State_Name:""};const p=function(){const[e,t]=(0,a.useState)(!1),[s,p]=(0,a.useState)(!1),[f,I]=(0,a.useState)(!1),[C,g]=(0,a.useState)(j),[y,v]=(0,a.useState)(!1),[w,k]=(0,a.useState)([]),[F,E]=(0,a.useState)([]),[q,A]=(0,a.useState)([]),[T,z]=(0,a.useState)(""),[L,U]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,S.q)({address:"masters/district"});e.success&&(k(e.data),E(e.data))}catch(e){console.error(e),u.m4.error("Failed to load districts")}})(),(async()=>{try{const e=await(0,S.q)({address:"masters/state/dropDown"});e.success&&A(e.data)}catch(e){console.log(e),u.m4.error("Failed to load State dropdown")}})()}),[e]),(0,a.useEffect)((()=>{if(""===T.trim())E(w);else{const e=w.filter((e=>{const t=T.toLowerCase();return String(e.District_Id).toLowerCase().includes(t)||e.District_Name&&e.District_Name.toLowerCase().includes(t)||e.State_Name&&e.State_Name.toLowerCase().includes(t)}));E(e)}}),[T,w]);const P=()=>{L||(I(!1),g(j))},W=()=>{L||(v(!1),g(j))},H=()=>{L||p(!1)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"card",children:[(0,b.jsxs)("div",{className:"card-header bg-white fw-bold d-flex align-items-center justify-content-between",children:["DISTRICT MASTER",(0,b.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,b.jsx)("div",{style:{width:"300px"},children:(0,b.jsx)(i.c,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Search District...",value:T,onChange:e=>z(e.target.value),InputProps:{startAdornment:(0,b.jsx)(N.c,{fontSize:"small",sx:{mr:1}}),style:{height:"40px"}}})}),(0,b.jsx)(h.c,{variant:"contained",size:"small",className:"rounded-1 btn-primary",onClick:()=>{I(!0),g(j)},sx:{textTransform:"none",fontWeight:500,px:2,height:"40px"},children:"Create District"})]})]}),(0,b.jsx)(D.cp,{dataArray:F,EnableSerialNumber:!0,maxHeightOption:!0,columns:[(0,D.A5)("District_Name","string","District Name"),(0,D.A5)("State_Name","string","State"),{ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,b.jsxs)("td",{style:{minWidth:"80px"},children:[(0,b.jsx)(r.c,{onClick:()=>(e=>{g({District_Id:Number(e.District_Id),District_Name:e.District_Name,State_Id:Number(e.State_Id),State_Name:e.State_Name||""}),v(!0)})(t),size:"small",children:(0,b.jsx)(_.c,{})}),(0,b.jsx)(r.c,{onClick:()=>{p(!0),g({District_Id:t.District_Id,District_Name:t.District_Name})},size:"small",color:"error",children:(0,b.jsx)(x.c,{})})]})}}]})]}),(0,b.jsxs)(c.c,{open:f,onClose:P,children:[(0,b.jsx)(l.c,{children:"Create District"}),(0,b.jsx)(d.c,{children:(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("label",{htmlFor:"stateSelect",children:"State *"}),(0,b.jsxs)("select",{className:"form-select form-select-sm",id:"editStateSelect",value:C.State_Id||"",onChange:e=>{const t=Number(e.target.value),s=q.find((e=>e.State_Id===t));g({...C,State_Id:t,State_Name:s?s.State_Name:""})},children:[(0,b.jsx)("option",{value:"",children:"Select State"}),q.map((e=>(0,b.jsx)("option",{value:e.State_Id,children:e.State_Name},e.State_Id)))]})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("label",{htmlFor:"districtName",className:"form-label",children:"District Name *"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-mdf",id:"districtName",value:C.District_Name,onChange:e=>g({...C,District_Name:e.target.value})})]})]})}),(0,b.jsxs)(n.c,{children:[(0,b.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:P,disabled:L,children:"Cancel"}),(0,b.jsx)("button",{className:"btn btn-primary btn-sm",onClick:async()=>{const{District_Name:e,State_Id:s}=C;if(e&&s){U(!0);try{const e=await(0,S.q)({address:"masters/district",method:"POST",bodyData:{...C}});e.success?(u.m4.success("District Created successfully!"),I(!1),g(j),t((e=>!e))):u.m4.error(e.message)}catch(a){console.error(a),u.m4.error("Failed to Create District")}finally{U(!1)}}else u.m4.error("Please fill all required fields.")},disabled:L||!C.District_Name||!C.State_Id,children:L?"Creating...":"Create"})]})]}),(0,b.jsxs)(c.c,{open:y,onClose:W,children:[(0,b.jsx)(l.c,{children:"Edit District"}),(0,b.jsx)(d.c,{children:(0,b.jsxs)("div",{className:"p-3",children:[(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("label",{htmlFor:"editStateSelect",className:"form-label",children:"State *"}),(0,b.jsxs)("select",{className:"form-select form-select-sm",id:"editStateSelect",value:C.State_Id||"",onChange:e=>{const t=Number(e.target.value);if(isNaN(t))return void u.m4.error("Invalid state selected");const s=q.find((e=>e.State_Id===t));g({...C,State_Id:t,State_Name:s?s.State_Name:""})},children:[(0,b.jsx)("option",{value:"",children:"Select State"}),q.map((e=>(0,b.jsx)("option",{value:e.State_Id,children:e.State_Name},e.State_Id)))]})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("label",{htmlFor:"editDistrictName",className:"form-label",children:"District Name *"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"editDistrictName",value:C.District_Name,onChange:e=>g({...C,District_Name:e.target.value})})]})]})}),(0,b.jsxs)(n.c,{children:[(0,b.jsx)("button",{className:"btn btn-secondary btn-sm me-2",onClick:W,disabled:L,children:"Cancel"}),(0,b.jsx)("button",{className:"btn btn-primary btn-sm",onClick:async()=>{var e;const{District_Id:s,District_Name:a,State_Id:i}=C,r={District_Id:Number(s),District_Name:a.trim(),State_Id:Number(i),State_Name:(null===(e=C.State_Name)||void 0===e?void 0:e.trim())||null};if(r.District_Id&&r.District_Name&&r.State_Id){U(!0);try{const e=await(0,S.q)({address:"masters/district",method:"PUT",bodyData:r});e.success?(u.m4.success("District updated successfully!"),k((e=>e.map((e=>e.District_Id===r.District_Id?{...e,...r}:e)))),E((e=>e.map((e=>e.District_Id===r.District_Id?{...e,...r}:e)))),v(!1),g(j)):(u.m4.error(e.message||"Update failed"),t((e=>!e)))}catch(c){console.error("Update error:",c),u.m4.error(`Failed to update district: ${c.message}`),t((e=>!e))}finally{U(!1)}}else u.m4.error("All required fields must be properly filled.")},disabled:L||!C.District_Name||!C.State_Id,children:L?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),"Updating..."]}):"Update"})]})]}),(0,b.jsxs)(c.c,{open:s,onClose:H,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,b.jsx)(l.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,b.jsx)(d.c,{children:(0,b.jsx)(o.c,{id:"alert-dialog-description",children:(0,b.jsx)("b",{children:`Do you want to delete the ${C.District_Name}?`})})}),(0,b.jsxs)(n.c,{children:[(0,b.jsx)(m.c,{onClick:H,children:"Cancel"}),(0,b.jsx)(m.c,{onClick:async()=>{U(!0);const e=C.District_Id;try{k((t=>t.filter((t=>t.District_Id!==e)))),E((t=>t.filter((t=>t.District_Id!==e))));const s=await(0,S.q)({address:"masters/district",method:"DELETE",bodyData:{District_Id:e}});s.success?u.m4.success("District deleted successfully!"):(t((e=>!e)),u.m4.error(s.message||"Failed to delete district"))}catch(s){console.error(s),t((e=>!e)),u.m4.error("Failed to delete district")}finally{U(!1),p(!1)}},autoFocus:!0,sx:{color:"red"},children:L?"Deleting...":"Delete"})]})]})]})}}}]);
//# sourceMappingURL=9052.068ed2cc.chunk.js.map