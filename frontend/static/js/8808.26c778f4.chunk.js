"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8808],{88808:(e,a,l)=>{l.r(a),l.d(a,{default:()=>G});var t=l(30800),i=l(69060),r=l(1908),o=l(39308),s=l(13724),d=l(71448),n=l(52924),c=l(44380),u=l(43692),m=l(3358),p=l(5548),v=l(84436),x=l(12572),g=l(15786),b=l(82656),_=l(4488),h=l(90048),j=l(89e3),N=l(18256),F=l(29720),y=l(61584),f=l(68424),D=l(39504),w=l(61988),C=l(74912),S=l(82496);const k=(0,S.jsx)(f.c,{fontSize:"small"}),B=(0,S.jsx)(D.c,{fontSize:"small"}),G=e=>{let{loadingOn:a,loadingOff:l}=e;const[f,D]=(0,i.useState)([]),[G,T]=(0,i.useState)([]),[A,V]=(0,i.useState)({Fromdata:(0,o.SO)(7),Todate:(0,o.Q7)(),view:"Grouped"}),[E,Q]=(0,i.useState)({}),[H,O]=(0,i.useState)(!1),[L,I]=(0,i.useState)(f),W=[{Field_Name:"Stock_Group",Fied_Data:"string",isVisible:1},{Field_Name:"Grade_Item_Group",Fied_Data:"string",isVisible:1},{Field_Name:"Group_Name",Fied_Data:"string",isVisible:1},{Field_Name:"stock_item_name",Fied_Data:"string",isVisible:1},{Field_Name:"godown_name",Fied_Data:"string",isVisible:1},..."List"===A.view?[{Field_Name:"Act_Bags",Fied_Data:"number",ColumnHeader:"Bags",isVisible:1},{Field_Name:"Bal_Act_Qty",Fied_Data:"number",ColumnHeader:"Balance Quantity",isVisible:1}]:[]];(0,i.useEffect)((()=>{z()}),[E]),(0,i.useEffect)((()=>Q({})),[A.view]);const M=(e,a)=>{Q((l=>(0,t.c)((0,t.c)({},l),{},{[e]:a})))},z=()=>{let e=[...f];for(const l of W)if(E[l.Field_Name])if("range"===E[l.Field_Name].type){const{min:a,max:t}=E[l.Field_Name];e=e.filter((e=>{const i=e[l.Field_Name];return(void 0===a||i>=a)&&(void 0===t||i<=t)}))}else if("date"===E[l.Field_Name].type){const{start:a,end:t}=E[l.Field_Name].value;e=e.filter((e=>{const i=new Date(e[l.Field_Name]);return(void 0===a||i>=new Date(a))&&(void 0===t||i<=new Date(t))}))}else if(Array.isArray(E[l.Field_Name])){var a;e=(null===(a=E[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter((e=>{var a;return E[l.Field_Name].includes(null===(a=e[l.Field_Name])||void 0===a?void 0:a.toLowerCase().trim())})):e}I(e)},P=e=>{const{Field_Name:a,Fied_Data:l}=e;var i,r,o,s,u,m,p,v,x,g;if("number"===l)return(0,S.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,S.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(i=null===(r=E[a])||void 0===r?void 0:r.min)&&void 0!==i?i:"",onChange:e=>M(a,(0,t.c)((0,t.c)({type:"range"},E[a]),{},{min:e.target.value?parseFloat(e.target.value):void 0}))}),(0,S.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(o=null===(s=E[a])||void 0===s?void 0:s.max)&&void 0!==o?o:"",onChange:e=>M(a,(0,t.c)((0,t.c)({type:"range"},E[a]),{},{max:e.target.value?parseFloat(e.target.value):void 0}))})]});if("date"===l)return(0,S.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,S.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(u=null===(m=E[a])||void 0===m||null===(p=m.value)||void 0===p?void 0:p.start)&&void 0!==u?u:"",onChange:e=>{var l;return M(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=E[a])||void 0===l?void 0:l.value),{},{start:e.target.value||void 0})})}}),(0,S.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(v=null===(x=E[a])||void 0===x||null===(g=x.value)||void 0===g?void 0:g.end)&&void 0!==v?v:"",onChange:e=>{var l;return M(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=E[a])||void 0===l?void 0:l.value),{},{end:e.target.value||void 0})})}})]});if("string"===l){const e=[...new Set(f.map((e=>{var l,t;return null===(l=e[a])||void 0===l||null===(t=l.toLowerCase())||void 0===t?void 0:t.trim()})))];return(0,S.jsx)(d.c,{multiple:!0,id:"".concat(a,"-filter"),options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:E[a]||[],onChange:(e,l)=>M(a,l),renderOption:(e,a,l)=>{let{selected:i}=l;return(0,S.jsxs)("li",(0,t.c)((0,t.c)({},e),{},{children:[(0,S.jsx)(n.c,{icon:k,checkedIcon:B,style:{marginRight:8},checked:i}),a]}))},isOptionEqualToValue:(e,a)=>e===a,renderInput:e=>(0,S.jsx)(c.c,(0,t.c)((0,t.c)({},e),{},{label:a,placeholder:"Select ".concat(null===a||void 0===a?void 0:a.replace(/_/g," "))}))})}};(0,i.useEffect)((()=>{a&&a(),(0,r.q)({address:"reports/liveStockReport?Fromdata=".concat(A.Fromdata,"&Todate=").concat(A.Todate)}).then((e=>{e.success&&D(e.data)})).catch((e=>console.error(e))).finally((()=>{l&&l()}))}),[A.Fromdata,A.Todate]),(0,i.useEffect)((()=>{(async()=>{try{const e=Object.keys(E).length>0?L:f;a&&await a();const l=(0,o.ui)(e,"Stock_Group"),i=null===l||void 0===l?void 0:l.sort(((e,a)=>{var l;return String(e.Stock_Group).localeCompare(null!==(l=a.Stock_Group)&&void 0!==l?l:"")})).map((e=>(0,t.c)((0,t.c)({},e),{},{BagsTotal:(0,o.SW)(e.groupedData,"Act_Bags"),BalQtyTotal:(0,o.SW)(e.groupedData,"Bal_Act_Qty")}))),r=(null===i||void 0===i?void 0:i.map((e=>(0,t.c)((0,t.c)({},e),{},{groupedData:(0,o.ui)(null===e||void 0===e?void 0:e.groupedData,"Grade_Item_Group")})))).map((e=>{var a;return(0,t.c)((0,t.c)({},e),{},{groupedData:null===(a=e.groupedData)||void 0===a?void 0:a.map((e=>(0,t.c)((0,t.c)({},e),{},{BagsTotal:(0,o.SW)(e.groupedData,"Act_Bags"),BalQtyTotal:(0,o.SW)(e.groupedData,"Bal_Act_Qty")})))})})),s=r.map((e=>{var a;return(0,t.c)((0,t.c)({},e),{},{groupedData:null===(a=e.groupedData)||void 0===a?void 0:a.map((e=>(0,t.c)((0,t.c)({},e),{},{groupedData:(0,o.ui)(null===e||void 0===e?void 0:e.groupedData,"Group_Name")})))})})).map((e=>{var a;return(0,t.c)((0,t.c)({},e),{},{groupedData:null===(a=e.groupedData)||void 0===a?void 0:a.map((e=>{var a;return(0,t.c)((0,t.c)({},e),{},{groupedData:null===e||void 0===e||null===(a=e.groupedData)||void 0===a?void 0:a.map((e=>(0,t.c)((0,t.c)({},e),{},{BagsTotal:(0,o.SW)(e.groupedData,"Act_Bags"),BalQtyTotal:(0,o.SW)(e.groupedData,"Bal_Act_Qty")})))})}))})}));setTimeout((()=>T(s)),500)}catch(e){console.error(e)}finally{l&&setTimeout((()=>l()),500)}})()}),[f,E,L]);const R=e=>[{Field_Name:e,isVisible:1,Fied_Data:"string"},{Field_Name:"BagsTotal",ColumnHeader:"Bags",isVisible:1,Fied_Data:"number"},{Field_Name:"BalQtyTotal",ColumnHeader:"Balance Quantity",isVisible:1,Fied_Data:"number"}];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(u.c,{children:[(0,S.jsxs)("div",{className:"p-1 d-flex justify-content-between align-items-center flex-wrap border-bottom",children:[(0,S.jsx)("h5",{className:"ps-2 pt-2",children:"Live Stock Report"}),(0,S.jsxs)("span",{children:[(0,S.jsx)("input",{type:"date",value:A.Fromdata,className:"cus-inpt w-auto p-1",onChange:e=>V((a=>(0,t.c)((0,t.c)({},a),{},{Fromdata:e.target.value})))})," - TO -",(0,S.jsx)("input",{type:"date",value:A.Todate,className:"cus-inpt w-auto p-1",onChange:e=>V((a=>(0,t.c)((0,t.c)({},a),{},{Todate:e.target.value})))}),(0,S.jsx)(m.c,{title:"Filters",children:(0,S.jsx)(p.c,{onClick:()=>O(!0),size:"small",className:"d-md-none d-inline",children:(0,S.jsx)(w.c,{})})})]})]}),(0,S.jsx)(v.c,{children:(0,S.jsxs)("div",{className:"row",children:[(0,S.jsx)("div",{className:"col-xxl-10 col-lg-9 col-md-8",children:(0,S.jsxs)(N.cp,{value:A.view,children:[(0,S.jsx)(x.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,S.jsxs)(F.c,{indicatorColor:"transparant",onChange:(e,a)=>V((e=>(0,t.c)((0,t.c)({},e),{},{view:a}))),variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:[(0,S.jsx)(g.c,{sx:"Grouped"===A.view?{backgroundColor:"#c6d7eb"}:{},label:"Grouped",value:"Grouped"}),(0,S.jsx)(g.c,{sx:"List"===A.view?{backgroundColor:"#c6d7eb"}:{},label:"List",value:"List"})]})}),(0,S.jsx)(y.c,{value:"Grouped",sx:{px:0,py:2},children:(0,S.jsx)(s.cp,{dataArray:G,title:"Stock Group",columns:R("Stock_Group"),isExpendable:!0,EnableSerialNumber:!0,expandableComp:e=>{let{row:a}=e;return(0,S.jsx)(s.cp,{dataArray:a.groupedData,title:"Grade Item Group",columns:R("Grade_Item_Group"),isExpendable:!0,EnableSerialNumber:!0,expandableComp:e=>{let{row:a}=e;return(0,S.jsx)(s.cp,{dataArray:a.groupedData,title:"Group Name",columns:R("Group_Name"),isExpendable:!0,EnableSerialNumber:!0,expandableComp:e=>{let{row:a}=e;return(0,S.jsx)(s.cp,{dataArray:a.groupedData,title:"Stock Item Name",columns:[{Field_Name:"stock_item_name",ColumnHeader:"Stock Item Name",Fied_Data:"string",isVisible:1},{Field_Name:"Bags",Fied_Data:"number",isVisible:1},{Field_Name:"Bal_Act_Qty",ColumnHeader:"Balance Quantity",Fied_Data:"number",isVisible:1},{Field_Name:"godown_name",ColumnHeader:"Godown",Fied_Data:"string",isVisible:1}],EnableSerialNumber:!0,tableMaxHeight:2e3,disablePagination:!0})},tableMaxHeight:3e3,disablePagination:!0})},tableMaxHeight:4e3,disablePagination:!0})},tableMaxHeight:5e3,disablePagination:!0})}),(0,S.jsx)(y.c,{value:"List",sx:{px:0,py:2},children:(0,S.jsx)(s.cp,{dataArray:Object.keys(E).length>0?L:f,columns:W})})]})}),(0,S.jsxs)("div",{className:"col-xxl-2 col-lg-3 col-md-4 d-none d-md-block",children:[(0,S.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,S.jsx)("span",{children:"Filters"}),(0,S.jsx)("span",{children:(0,S.jsx)(m.c,{title:"Clear Filters",children:(0,S.jsx)(p.c,{size:"small",onClick:()=>Q({}),children:(0,S.jsx)(C.c,{})})})})]}),(0,S.jsxs)("div",{className:"border rounded-3 ",children:[W.map(((e,a)=>{var l;return(0,S.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,S.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(l=e.Field_Name)||void 0===l?void 0:l.replace(/_/g," ")}),P(e)]},a)})),(0,S.jsx)("br",{})]})]})]})})]}),(0,S.jsxs)(b.c,{open:H,onClose:()=>O(!1),maxWidth:"sm",fullWidth:!0,children:[(0,S.jsxs)(_.c,{children:[(0,S.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,S.jsx)("span",{children:"Filters"}),(0,S.jsx)("span",{children:(0,S.jsx)(m.c,{title:"Clear Filters",children:(0,S.jsx)(p.c,{size:"small",onClick:()=>Q({}),children:(0,S.jsx)(C.c,{})})})})]}),(0,S.jsxs)("div",{className:"border rounded-3 ",children:[W.map(((e,a)=>{var l;return(0,S.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,S.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(l=e.Field_Name)||void 0===l?void 0:l.replace(/_/g," ")}),P(e)]},a)})),(0,S.jsx)("br",{})]})]}),(0,S.jsx)(h.c,{children:(0,S.jsx)(j.c,{onClick:()=>O(!1),color:"error",children:"close"})})]})]})}}}]);
//# sourceMappingURL=8808.26c778f4.chunk.js.map