"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[6056],{64568:(e,s,a)=>{a.d(s,{c:()=>r});var t=a(82496);const r=()=>(0,t.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},62344:(e,s,a)=>{a.d(s,{o$:()=>n,o5:()=>c,cF:()=>l,iI:()=>r,_8:()=>d});const t=a.p+"static/media/smt.aa4d4f940bbebff07a57.png",r={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},l={menu:(e,s)=>({...e,zIndex:9999}),menuPortal:e=>({...e,zIndex:9999}),groupHeading:e=>({...e,backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold",fontSize:"14px",padding:"8px 12px",borderBottom:"1px solid #ddd",textTransform:"uppercase"}),option:(e,s)=>({...e,backgroundColor:s.isSelected?"#2684FF":s.isFocused?"#E2ECF9":"white",color:s.isSelected?"white":"#333",padding:"10px 12px"})},n=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],c=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:t,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}],d=[{name:"PURCHASE_ORDER"},{name:"PURCHASE_INVOICE"},{name:"SALE_ORDER"},{name:"SALE_INVOICE"},{name:"JOURNAL"},{name:"STOCK_JOURNAL"},{name:"PAYMENT"},{name:"RECEIPT"},{name:"CONTRA"}]},42672:(e,s,a)=>{a.r(s),a.d(s,{default:()=>re});var t=a(69060),r=a(5548),l=a(82656),n=a(26773),c=a(4488),d=a(90048),i=a(28655),o=a(14168),m=a(86e3),h=a(57704),p=a(56480),u=a(77536),x=a(1908),_=a(8436),y=a(45108),j=a(32635),g=a(89e3),T=a(12572),v=a(15786),S=a(56880),b=a(6392),k=a(21280),f=a(70564),I=a(99904),N=a(33856),E=a(58612),C=a(27454),D=a(96464),P=a(27532),w=a(98204),R=a(35880),A=(a(21680),a(67472),a(68424)),O=a(39504),F=a(71448),q=a(52924),B=a(44380),M=a(39308),$=a(64568),L=a(82496);const U=(0,L.jsx)(A.c,{fontSize:"small"}),W=(0,L.jsx)(O.c,{fontSize:"small"}),G=e=>{let{row:s,children:a,openAction:r,reload:i,onCloseFun:o,loadingOn:m,loadingOff:h,onTaskAdded:u}=e;const _=localStorage.getItem("user"),y=JSON.parse(_),j={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:"",Entry_By:null===y||void 0===y?void 0:y.UserId,Company_id:null===y||void 0===y?void 0:y.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[g,T]=(0,t.useState)(!1),[v,S]=(0,t.useState)(!1),[b,k]=(0,t.useState)([]),[f,I]=(0,t.useState)([]),[N,E]=(0,t.useState)([]),[C,D]=(0,t.useState)(j),[P,w]=(0,t.useState)(!1),[R,A]=(0,t.useState)(j);(0,t.useEffect)((()=>{(async()=>{try{const e=await(0,x.q)({address:"taskManagement/tasks/dropdown"});e.success&&k(e.data);const s=await(0,x.q)({address:"masters/taskType/dropDown"});s.success&&I(s.data);const a=await(0,x.q)({address:"taskManagement/parameters"});a.success&&E(a.data)}catch(e){console.error(e)}})()}),[]),(0,t.useEffect)((()=>{T(r)}),[r]),(0,t.useEffect)((()=>{(0,M.CY)(s)?(console.log(s),D((e=>({...e,...s,Task_Group_Id:s.Task_Group_Id||""}))),S(!0)):(D(j),S(!1))}),[s]);const O=()=>{T(!1),o&&o()},G=()=>{w(!1),A(j)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{onClick:()=>T(!0),style:{cursor:"pointer"},children:a}),(0,L.jsxs)(l.c,{open:g,children:[(0,L.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:v?"Edit Task":"Add Task"}),(0,L.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=C.Task_Parameters.map((e=>({...e,Param_Id:e.Paramet_Id})))||[],s={...C,Task_Parameters:e};m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:v?"PUT":"POST",bodyData:s});e.success?(p.m4.success(e.message),D(j),O(),i&&i(),u&&u()):p.m4.error(e.message)}catch(a){console.error(a),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,L.jsx)(c.c,{children:(0,L.jsxs)("div",{className:"row",children:[(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsxs)("label",{children:["Task Name ",(0,L.jsx)($.c,{})]}),(0,L.jsx)("input",{maxLength:150,onChange:e=>D({...C,Task_Name:e.target.value}),required:!0,value:C.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsxs)("label",{children:["Task Group ",(0,L.jsx)($.c,{})]}),(0,L.jsxs)("select",{value:C.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>D({...C,Task_Group_Id:e.target.value}),children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),f.map(((e,s)=>(0,L.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},s)))]})]}),(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsx)("label",{children:"Base Task"}),(0,L.jsxs)("select",{value:C.Under_Task_Id,className:"cus-inpt",onChange:e=>D({...C,Under_Task_Id:e.target.value}),children:[(0,L.jsx)("option",{value:0,children:"Primary"}),b.map(((e,s)=>(0,L.jsx)("option",{value:e.Task_Id,children:e.Task_Name},s)))]})]}),(0,L.jsxs)("div",{className:"col-12",children:[(0,L.jsxs)("label",{children:["Task Description ",(0,L.jsx)($.c,{})]}),(0,L.jsx)("textarea",{className:"cus-inpt",value:C.Task_Desc,rows:"3",onChange:e=>D({...C,Task_Desc:e.target.value})})]}),(0,L.jsx)("div",{className:"col-md-12 p-2",children:(0,L.jsx)(F.c,{multiple:!0,id:"checkboxes-tags-demo",options:N,disableCloseOnSelect:!0,getOptionLabel:e=>`${e.Paramet_Name} - ${e.Paramet_Data_Type}`,value:C.Task_Parameters||[],onChange:(e,s)=>D({...C,Task_Parameters:s}),renderOption:(e,s,a)=>{let{selected:t}=a;return(0,L.jsxs)("li",{...e,children:[(0,L.jsx)(q.c,{icon:U,checkedIcon:W,style:{marginRight:8},checked:t}),`${s.Paramet_Name} - ${s.Paramet_Data_Type}`]})},className:"pt-2",isOptionEqualToValue:(e,s)=>Number(e.Paramet_Id)===Number(s.Paramet_Id),renderInput:e=>(0,L.jsx)(B.c,{...e,label:"Task Parameters",placeholder:"Choose Task Parameters"})})}),C.Task_Parameters.map(((e,s)=>(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsx)("label",{className:"mb-2",children:e.Paramet_Name}),(0,L.jsx)("input",{type:e.Paramet_Data_Type||"text",className:"cus-inpt",onChange:e=>{const a=[...C.Task_Parameters];a[s]={...a[s],Default_Value:e.target.value},D({...C,Task_Parameters:a})},value:e.Default_Value,placeholder:"Default Value"})]},s)))]})}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:O,children:"Cancel"}),(0,L.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]}),(0,L.jsxs)(l.c,{open:P,onClose:G,children:[(0,L.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Edit Task"}),(0,L.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=R.Task_Parameters.map((e=>({...e,Param_Id:e.Paramet_Id})))||[],s={...R,Task_Parameters:e};m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:"PUT",bodyData:s});e.success?(p.m4.success(e.message),G(),i&&i(),u&&u()):p.m4.error(e.message)}catch(a){console.error(a),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,L.jsxs)(c.c,{children:[(0,L.jsx)(B.c,{label:"Task Name",value:R.Task_Name,onChange:e=>A({...R,Task_Name:e.target.value}),fullWidth:!0}),(0,L.jsxs)(B.c,{label:"Task Group",select:!0,value:R.Task_Group_Id,onChange:e=>A({...R,Task_Group_Id:e.target.value}),fullWidth:!0,children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),f.map(((e,s)=>(0,L.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},s)))]})]}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:G,children:"Cancel"}),(0,L.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Save"})]})]})]})]})};var H=a(55888),z=a(99852),J=a(62344);const V=e=>{let{open:s,onClose:a,projectId:r,taskId:i,reload:o,onReload:m,editData:h}=e;const u=localStorage.getItem("user"),_=JSON.parse(u),[y,j]=(0,t.useState)([]),[T,v]=(0,t.useState)(!1),[S,b]=(0,t.useState)([]),k={AN_No:"",Project_Id:r,Sch_Id:i,Assigned_Emp_Id:null===_||void 0===_?void 0:_.UserId,Emp_Id:"",Task_Assign_dt:(new Date).toISOString().split("T")[0],Sch_Period:"",Sch_Time:"",EN_Time:"",Est_Start_Dt:"",Est_End_Dt:"",Ord_By:1,Timer_Based:!1,Sch_Type:"",Invovled_Stat:!0,EmpGet:"- Select -",Is_Repitative:!1,RepeatDays:{Mon:!1,Tue:!1,Wed:!1,Thu:!1,Fri:!1,Sat:!1,Sun:!1}},[f,I]=(0,t.useState)(k);(0,t.useEffect)((()=>{s&&N()}),[r,s,o]);const N=async()=>{v(!0);try{const e=await(0,x.q)({address:`masters/Employeedetails/getusersproject?Project_Id=${r}`}),s=await(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"});e.success&&j(e.data||[]),s.success}catch(e){p.m4.error("Failed to fetch data.")}finally{v(!1)}};(0,t.useEffect)((()=>{s&&(async()=>{v(!0);try{if(h){var e,s;const a=await(0,x.q)({address:`masters/employeedetails/selectedTaskDetails?projectId=${r}&Sch_Id=${i.Sch_Id}&Task_Id=${i.Task_Id}`}),t=null===(e=a.data[0])||void 0===e?void 0:e.Sch_Type_Id,l=null===(s=a.data[0])||void 0===s?void 0:s.Sch_Name;b(t&&l?{value:t,label:l}:{value:"",label:""})}else{var a,t;const e=await(0,x.q)({address:`masters/employeedetails/selectedTaskDetails?projectId=${r}&Sch_Id=${i.TaskSchId}&Task_Id=${i.Task_Id}`}),s=null===(a=e.data[0])||void 0===a?void 0:a.Sch_Type_Id,l=null===(t=e.data[0])||void 0===t?void 0:t.Sch_Name;b(s&&l?{value:s,label:l}:{value:"",label:""})}}catch(l){p.m4.error("Failed to fetch data.")}finally{v(!1)}})()}),[s,h,o,r]),(0,t.useEffect)((()=>{h&&I((e=>({...e,AN_No:h.AN_No,Emp_Id:h.Emp_Id,Sch_Time:h.Sch_Time,EN_Time:h.EN_Time,Est_Start_Dt:h.Est_Start_Dt.split("T")[0],Est_End_Dt:h.Est_End_Dt.split("T")[0],Ord_By:h.Ord_By,Timer_Based:h.Timer_Based,Invovled_Stat:h.Invovled_Stat,Sch_Type_Id:h.Sch_Type,Sch_Type:h.Sch_Type_Name,EmpGet:h.EmployeeName,Is_Repitative:h.Is_Repitative,RepeatDays:{Mon:!!h.IS_Rep_Monday,Tue:!!h.IS_Rep_Tuesday,Wed:!!h.IS_Rep_Wednesday,Thu:!!h.IS_Rep_Thursday,Fri:!!h.Is_Rep_Friday,Sat:!!h.Is_Rep_Saturday,Sun:!!h.Is_Rep_Sunday}})))}),[h]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(l.c,{open:s,maxWidth:"sm",children:[(0,L.jsx)(n.c,{children:h?"Edit Task":"Employee Assign"}),(0,L.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const s=(()=>{const[e,s]=f.Sch_Time.split(":").map(Number),[a,t]=f.EN_Time.split(":").map(Number),r=new Date(0,0,0,e,s),l=new Date(0,0,0,a,t);if(l>r){let e=Math.abs(l-r);const s=Math.floor(e/36e5),a=Math.floor(e/6e4);return`${String(s).padStart(2,"0")}:${String(a).padStart(2,"0")}`}return""})();if(f.Est_End_Dt<f.Est_Start_Dt)p.m4.error("End date must be greater than start date.");else try{const e=h?"masters/employeedetails/updateTask":"masters/employeedetails/assignTask",t={IS_Rep_Monday:f.RepeatDays.Mon?1:null,IS_Rep_Tuesday:f.RepeatDays.Tue?1:null,IS_Rep_Wednesday:f.RepeatDays.Wed?1:null,IS_Rep_Thursday:f.RepeatDays.Thu?1:null,Is_Rep_Friday:f.RepeatDays.Fri?1:null,Is_Rep_Saturday:f.RepeatDays.Sat?1:null,Is_Rep_Sunday:f.RepeatDays.Sun?1:null};(await(0,x.q)({address:e,method:h?"PUT":"POST",bodyData:{...f,Project_Id:r,Sch_Id:h?i.Sch_Id:i.TaskSchId,Task_Levl_Id:i.Task_Levl_Id,Task_Id:Number(i.Task_Id),Assigned_Emp_Id:f.Assigned_Emp_Id,Emp_Id:f.Emp_Id,Sch_Period:s,Sch_Time:f.Sch_Time,EN_Time:f.EN_Time,Est_Start_Dt:f.Est_Start_Dt,Est_End_Dt:f.Est_End_Dt,Ord_By:f.Ord_By,Sch_Type:S.value,Timer_Based:f.Timer_Based?1:0,Invovled_Stat:f.Invovled_Stat?1:0,Is_Repitative:f.Is_Repitative?1:0,RepeatDays:f.Is_Repitative?f.RepeatDays:"",...t}})).success?(p.m4.success(`Task ${h?"updated":"assigned"} successfully!`),I({}),m&&m(),a()):p.m4.error("Please fill the values correctly")}catch(t){p.m4.error("Error during task assignment/update: "+t.message)}},children:[(0,L.jsxs)(c.c,{className:"table-responsive",children:[T&&(0,L.jsx)("div",{children:"Loading..."}),(0,L.jsx)("table",{className:"table",style:{tableLayout:"fixed"},children:(0,L.jsxs)("tbody",{children:[(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Employee"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)(z.cp,{value:{value:f.Emp_Id,label:f.EmpGet},onChange:e=>I({...f,Emp_Id:e.value,EmpGet:e.label}),options:[{value:"",label:"- Select -"},...y.map((e=>({value:e.UserId,label:e.Name})))],styles:J.cF,required:!0,isSearchable:!0,placeholder:"Select User"})})]}),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Sch_Type"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)(z.cp,{value:S?{value:S.value,label:`${S.label}`}:null,styles:{padding:"0.5em"},isDisabled:!0,placeholder:"Select Sch_Type"})})]}),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Start Time"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)("input",{type:"time",className:"cus-inpt",value:f.Sch_Time,required:!0,onChange:e=>I({...f,Sch_Time:e.target.value}),style:{padding:"0.5em"}})})]}),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"End Time"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)("input",{type:"time",className:"cus-inpt",value:f.EN_Time,required:!0,min:f.Sch_Time,onChange:e=>I({...f,EN_Time:e.target.value}),style:{padding:"0.5em"}})})]}),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. Start Date"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_Start_Dt,required:!0,onChange:e=>I({...f,Est_Start_Dt:e.target.value}),style:{padding:"0.5em"}})})]}),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. End Date"}),(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,L.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_End_Dt,required:!0,min:f.Est_Start_Dt,onChange:e=>I({...f,Est_End_Dt:e.target.value}),style:{padding:"0.5em"}})})]}),(0,L.jsx)("tr",{children:(0,L.jsxs)("td",{className:"border-bottom-0 fa-15 text-start",style:{paddingRight:"1em"},children:[(0,L.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,L.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",id:"timerbased",checked:Boolean(Number(null===f||void 0===f?void 0:f.Timer_Based)),onChange:e=>I({...f,Timer_Based:e.target.checked}),style:{marginRight:"0.5em"}}),(0,L.jsx)("label",{className:"form-check-label p-1 ps-2",htmlFor:"timerbased",children:"Timer Based Task?"})]}),h&&(0,L.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,L.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",checked:Boolean(Number(null===f||void 0===f?void 0:f.Invovled_Stat)),onChange:()=>I({...f,Invovled_Stat:!f.Invovled_Stat}),style:{marginRight:"0.5em"}}),(0,L.jsx)("label",{className:"form-check-label p-1 ps-2",children:"Involved Status"})]})]})}),(0,L.jsx)("tr",{children:(0,L.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingRight:"1em"},children:(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"1em"},children:[(0,L.jsx)("input",{type:"checkbox",checked:1===f.Is_Repitative,onChange:e=>{I((s=>({...s,Is_Repitative:e.target.checked?1:0})))},style:{marginRight:"1em"}}),(0,L.jsx)("label",{style:{marginBottom:"0"},children:"Is Repetitive?"})]}),1===f.Is_Repitative&&(0,L.jsx)("div",{style:{display:"inline-flex",gap:"0.5em"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,L.jsxs)("label",{style:{display:"flex",alignItems:"center",marginRight:"1em",width:"30px"},children:[(0,L.jsx)("input",{type:"checkbox",checked:f.RepeatDays[e],onChange:()=>I({...f,RepeatDays:{...f.RepeatDays,[e]:!f.RepeatDays[e]}}),style:{marginRight:"0.5em"}}),e]},e)))})]})})})]})})]}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)(g.c,{onClick:()=>{a(),I(k)},variant:"outlined",children:"Close"}),(0,L.jsx)(g.c,{type:"submit",variant:"contained",children:"Save Changes"})]})]})]})})};var Q=a(63468),Y=a(29504),K=a(63172),Z=a(86848);const X=function(e){let{open:s,onClose:a,taskDetails:d,closeDialogTask:i}=e;const[o,h]=(0,t.useState)(null),[p,x]=(0,t.useState)(!1),[_,y]=(0,t.useState)(!0),{contextObj:j}=(0,t.useContext)(u.a);(0,t.useEffect)((()=>{s&&(h(null),y(!0),setTimeout((()=>{y(!1)}),500))}),[s]);const T=e=>{if(!e)return"N/A";const s=new Date(e);if(isNaN(s.getTime()))return"Invalid Date";return`${String(s.getDate()).padStart(2,"0")}-${String(s.getMonth()+1).padStart(2,"0")}-${s.getFullYear()}`};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(l.c,{open:s,maxWidth:"lg",children:[(0,L.jsx)(n.c,{children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)("span",{children:"Details"}),(0,L.jsx)(g.c,{variant:"contained",color:"primary",onClick:a,children:"Close"})]})}),(0,L.jsx)(c.c,{children:_?(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",width:"500px"},children:(0,L.jsx)(Q.c,{})}):(0,L.jsx)(I.c,{children:(0,L.jsxs)(N.c,{children:[(0,L.jsx)(E.c,{children:(0,L.jsxs)(C.c,{children:[(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Employee"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Assigned By"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Start-End Date"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Start-End Time"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Total Hours"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Timer Based"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Involved Status"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Order By"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:"Action"})]})}),(0,L.jsx)(Y.c,{children:0===d.length?(0,L.jsx)(C.c,{children:(0,L.jsx)(D.c,{colSpan:9,className:"fa-14 text-center",style:{textAlign:"center"},children:"No data found"})}):d.map(((e,s)=>(0,L.jsxs)(C.c,{children:[(0,L.jsx)(D.c,{className:"fa-13 text-center",children:e.EmployeeName||"N/A"}),(0,L.jsx)(D.c,{className:"fa-13 text-center",children:e.AssignedUser||"N/A"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:(0,L.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,L.jsx)(K.c,{className:"fa-18 me-2"}),T(e.Est_Start_Dt)," - ",T(e.Est_End_Dt)]})}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:(0,L.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,L.jsx)(Z.c,{className:"fa-18 me-2"}),e.Sch_Time||"N/A"," - ",e.EN_Time||"N/A"]})}),(0,L.jsx)(D.c,{className:"fa-13 text-center",children:e.Sch_Period||"N/A"}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:(0,L.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white "+(Number(e.Timer_Based)?"bg-success":"bg-warning"),children:Number(e.Timer_Based)?"Yes":"No"})}),(0,L.jsx)(D.c,{className:"fa-14 text-center",children:(0,L.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white "+(Number(e.Invovled_Stat)?"bg-success":"bg-danger"),children:Number(e.Invovled_Stat)?"IN":"OUT"})}),(0,L.jsx)(D.c,{className:"fa-13 text-center",children:e.Ord_By||"N/A"}),1===Number(null===j||void 0===j?void 0:j.Edit_Rights)&&(0,L.jsx)(D.c,{className:"fa-13 text-center",children:(0,L.jsxs)(r.c,{size:"small",onClick:()=>(h(e),void x(!0)),children:[(0,L.jsx)(m.c,{className:"fa-18"}),"Edit"]})})]},s)))})]})})})]}),p&&(0,L.jsx)(V,{open:p,projectId:null===o||void 0===o?void 0:o.Project_Id,taskId:o,editData:o,onClose:()=>{x(!1),a()}})]})};var ee=a(18256),se=a(29720),ae=a(61584);const te=function(e){let{dialogOpen:s,setDialogOpen:a,projectid:i,reload:o,onReload:h,selectedProject:_}=e;const[y,j]=(0,t.useState)(!1),[A,O]=(0,t.useState)(!1),[F,q]=(0,t.useState)(!1),[B,M]=(0,t.useState)(null),[$,U]=(0,t.useState)([]),[W,z]=(0,t.useState)([]),[J,Q]=(0,t.useState)(!1),[Y,K]=(0,t.useState)({Sch_Type_Id:"",Sch_Type:""}),[Z,te]=(0,t.useState)([]),[re,le]=(0,t.useState)(!1),ne=JSON.parse(localStorage.getItem("user")),ce=null===ne||void 0===ne?void 0:ne.UserId,de=null===ne||void 0===ne?void 0:ne.Company_id,[ie,oe]=(0,t.useState)(!1),[me,he]=(0,t.useState)(null),[pe,ue]=(0,t.useState)(null),{contextObj:xe}=(0,t.useContext)(u.a),[_e,ye]=(0,t.useState)(!1),[je,ge]=(0,t.useState)(!1),[Te,ve]=(0,t.useState)("1"),[Se,be]=(0,t.useState)([]),ke=(e,s)=>{ve(s)},fe=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:`taskManagement/tasks/dropdown?Company_id=${de}`});e.success?U(e.data):p.m4.error(e.message)}catch(e){console.error(e)}}),[de]),Ie=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:`taskManagement/project/schedule/ListingDetails?Project_Id=${i}`});e.success?te(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}}),[i]);(0,t.useEffect)((()=>{fe(),Ie(),(async()=>{(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"}).then((e=>{e.success?(console.log("data.data",e.data),be(e.data)):p.m4.error(e.message)}))})()}),[o,i,h]);const Ne=$.map((e=>({value:e.Task_Id,label:e.Task_Name}))),Ee=e=>{const s=Se.find((s=>s.Sch_Type_Id===parseInt(e.target.value)));s&&K({...Y,Sch_Type_Id:s.Sch_Type_Id,Sch_Type:s.Sch_Type})};return(0,L.jsxs)(L.Fragment,{children:[je&&(0,L.jsxs)(l.c,{open:je,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},onClose:()=>ge(!1),children:[(0,L.jsx)(n.c,{children:_e?"Edit Task":"Assign Task"}),(0,L.jsx)(c.c,{children:(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,L.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map(((e,s)=>(0,L.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},s)))]})]})})}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)(g.c,{onClick:()=>ge(!1),children:"Cancel"}),(0,L.jsx)(g.c,{variant:"contained",color:"primary",onClick:()=>(async e=>{const s={Sch_Project_Id:e.Sch_Project_Id,Sch_Id:e.TaskSchId,schtypeid:Y.Sch_Type_Id,Task_Id:e.Task_Id};try{const e=await(0,x.q)({address:"taskManagement/project/schedule/updateScheduleTaskUpdate",method:"PUT",bodyData:s});e.success?(p.m4.success(e.message),ge(!1),ye(!1),h()):(e.status,p.m4.warn(e.message||"Task already exists for this project."))}catch(a){p.m4.error(a)}})(Y),children:"Save"})]})]}),(0,L.jsxs)(l.c,{open:s,fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,L.jsx)(n.c,{children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)("span",{children:null===_||void 0===_?void 0:_.Project_Name}),(0,L.jsx)(g.c,{variant:"contained",color:"primary",onClick:()=>O(!0),children:"Assign Task"})]})}),(0,L.jsx)(T.c,{sx:{width:"100%",typography:"body1"},children:Z.map(((e,s)=>{const a=JSON.parse(e.SchTypes);return(0,L.jsxs)(ee.cp,{value:Te,children:[(0,L.jsx)(T.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,L.jsx)(se.c,{onChange:ke,"aria-label":"Schedule Types",children:Array.isArray(a)&&a.length>0?a.map(((e,s)=>(0,L.jsx)(v.c,{label:e.SchType||"No SchType",value:(e.SchTypeId||s).toString(),id:`tab-${e.SchTypeId||s}`,"aria-controls":`tabpanel-${e.SchTypeId||s}`},`${e.SchTypeId||"index"}-${s}`))):(0,L.jsxs)(S.c,{variant:"body2",color:"textSecondary",sx:{padding:2},children:["No Details Available for ",a]})})}),Array.isArray(a)&&a.map(((e,s)=>(0,L.jsxs)(ae.c,{value:(e.SchTypeId||s).toString(),id:`tabpanel-${e.SchTypeId||s}`,"aria-labelledby":`tab-${e.SchTypeId||s}`,children:[(0,L.jsx)(T.c,{sx:{marginBottom:2,padding:2,backgroundColor:"#f9f9f9",borderRadius:"8px"},children:Array.isArray(e.TaskCountsInSchType)&&e.TaskCountsInSchType.length>0?e.TaskCountsInSchType.map(((s,a)=>(0,L.jsxs)(S.c,{variant:"body1",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsxs)(T.c,{children:["Schedule Type: ",(0,L.jsx)("strong",{children:e.SchType})]}),(0,L.jsxs)(T.c,{textAlign:"right",children:["Total Tasks: ",(0,L.jsx)("strong",{children:s.TotalTasks})," / Completed Tasks: ",(0,L.jsx)("strong",{children:s.CompletedTasks})]})]},a))):(0,L.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No tasks counted for this schedule type."})}),Array.isArray(e.TaskTypeGroups)&&e.TaskTypeGroups.length>0?e.TaskTypeGroups.map((s=>(0,L.jsxs)(b.c,{expanded:me===s.Task_Type_Id,onChange:()=>{return e=s.Task_Type_Id,void he((s=>s===e?null:e));var e},sx:{backgroundColor:"#f0f4ff",boxShadow:"black"},children:[(0,L.jsxs)(k.c,{expandIcon:(0,L.jsx)(H.c,{}),children:[(0,L.jsx)(S.c,{fontWeight:"bold",children:s.Task_Type||"Default Task Type"}),(0,L.jsx)(T.c,{sx:{textAlign:"right",flexGrow:1},children:(0,L.jsxs)(S.c,{variant:"h6",children:[(0,L.jsx)(S.c,{fontWeight:"bold",children:"Completed Task / Total Task"}),Array.isArray(s.TaskMetrics)&&s.TaskMetrics.length>0?s.TaskMetrics.map(((e,s)=>(0,L.jsxs)(S.c,{sx:{textAlign:"right",flexGrow:1},children:[e.CompletedTasks," / ",null===e||void 0===e?void 0:e.TotalTasks]},s))):(0,L.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No task metrics available for this task type."})]})})]}),(0,L.jsx)(f.c,{children:Array.isArray(s.Tasks)&&s.Tasks.length>0?s.Tasks.map((s=>(0,L.jsxs)(b.c,{expanded:pe===s.Task_Id,onChange:()=>{return e=s.Task_Id,void ue((s=>s===e?null:e));var e},sx:{marginBottom:2},children:[(0,L.jsx)(k.c,{expandIcon:(0,L.jsx)(H.c,{}),children:(0,L.jsx)(T.c,{sx:{textAlign:"left",flexGrow:1},children:(0,L.jsx)(S.c,{fontWeight:"bold",children:(null===s||void 0===s?void 0:s.Task_Name)||"DEFAULT TASK"})})}),(0,L.jsx)(f.c,{children:(0,L.jsx)(I.c,{style:{maxHeight:"50vh"},children:(0,L.jsxs)(N.c,{stickyHeader:!0,children:[(0,L.jsx)(E.c,{style:{backgroundColor:"#2C3E50"},children:(0,L.jsxs)(C.c,{style:{backgroundColor:"#2C3E50"},children:[(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task"}),(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task Type"}),(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employees"}),(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employee Assign"}),(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Actions"}),(0,L.jsx)(D.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Details"})]})}),(0,L.jsxs)(C.c,{sx:{backgroundColor:"#BBE6F6"},children:[(0,L.jsx)(D.c,{children:s.Task_Name}),(0,L.jsxs)(D.c,{children:[e.SchType,(0,L.jsx)(r.c,{onClick:()=>{return e=s,ye(!0),K(e),void ge(!0);var e},children:(0,L.jsx)(m.c,{})})]}),(0,L.jsx)(D.c,{children:Array.isArray(s.AssignedEmployees)&&s.AssignedEmployees.length>0?s.AssignedEmployees.map(((e,s)=>(0,L.jsx)(P.c,{label:e.Name,variant:"outlined",size:"small",sx:{margin:"2px",color:"green"}},s))):(0,L.jsx)("span",{children:"No Employees Assigned"})}),(0,L.jsx)(D.c,{children:(0,L.jsx)(r.c,{onClick:()=>(async e=>{M(e),q(!0)})(s),children:(0,L.jsx)(w.c,{})})}),1===Number(null===xe||void 0===xe?void 0:xe.Edit_Rights)&&(0,L.jsx)(D.c,{children:(0,L.jsx)(r.c,{onClick:()=>(M(s),void oe(!0)),children:(0,L.jsx)(m.c,{})})}),(0,L.jsx)(D.c,{children:(0,L.jsx)(r.c,{onClick:()=>(async e=>{if(Q(!0),e.Task_Id&&i)try{const s=await(0,x.q)({address:`masters/employeedetails/assignedTaskDetails?Task_Id=${e.Task_Id}&ProjectId=${i}&LevelId=${e.Task_Levl_Id}`});s.success?z(s.data):console.error(s.message)}catch(s){console.error("Error fetching task details:",s)}else p.m4.error("Task ID and Project ID are required")})(s),children:(0,L.jsx)(R.c,{})})})]},s.Task_Id)]})})})]},s.Task_Id))):(0,L.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No tasks available for this task type."})})]},s.Task_Type_Id))):(0,L.jsx)(S.c,{variant:"body2",color:"textSecondary",children:"No task type groups found for this schedule type."})]},`${e.SchTypeId||"index"}-${s}`)))]},s)}))}),(0,L.jsx)(d.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,L.jsx)(g.c,{variant:"contained",color:"primary",onClick:async()=>{a(!1),K({})},children:"Close"})})]}),(0,L.jsxs)(l.c,{open:A,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,L.jsx)(n.c,{children:"Assign Task"}),(0,L.jsxs)(c.c,{children:[(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,L.jsxs)("select",{id:"task-select",value:Y.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{K((s=>({...s,Task_Id:e.value,TasksGet:e.label})));try{const s=await(0,x.q)({address:`taskManagement/tasks/tasklistsid?Task_Id=${e.value}`});if(s.success){const e=s.data;K((s=>({...s,Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Sch_Type_Id:e.Sch_Type_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()})))}else p.m4.error("Failed to fetch task details")}catch(s){p.m4.error(s)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),Ne.map(((e,s)=>(0,L.jsx)("option",{value:e.value,children:e.label},s)))]}),(0,L.jsx)(r.c,{onClick:()=>j(!0),children:(0,L.jsx)(g.c,{variant:"contained",color:"primary",children:"Create New"})})]})}),(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,L.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map(((e,s)=>(0,L.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},s)))]})]})})]}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)(g.c,{onClick:()=>O(!1),children:"Cancel"}),(0,L.jsx)(g.c,{variant:"contained",color:"primary",onClick:async()=>{if(!Y.Task_Id||!Y.Sch_Type_Id)return void p.m4.error("Please select a task and schedule type before saving.");const e={entryBy:ce,Project_Id:i,Sch_Type_Id:Y.Sch_Type_Id,Sch_Est_Start_Date:Y.Task_Est_Start_Date,Sch_Est_End_Date:Y.Task_Est_End_Date,tasks:[Y]};try{const s=await(0,x.q)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e});s.success?(p.m4.success(s.message),O(!1),K({}),Ie(),h()):(s.status,p.m4.warn(s.message||"Task already exists for this project."))}catch(s){p.m4.error(s)}},children:"Save"})]})]}),(0,L.jsx)(V,{open:F,onClose:()=>q(!1),task:B,projectId:i,entryBy:ce,taskId:B,reload:o,onReload:h}),(0,L.jsxs)(l.c,{open:re,onClose:()=>le(!1),children:[(0,L.jsx)(n.c,{children:"Delete Task"}),(0,L.jsx)(d.c,{children:(0,L.jsx)(g.c,{onClick:()=>le(!1),color:"primary",children:"Cancel"})})]}),(0,L.jsx)(G,{openAction:y,onCloseFun:()=>j(!1),onTaskAdded:fe,Reload:o}),(0,L.jsx)(G,{row:B,openAction:ie,onCloseFun:()=>oe(!1),reload:Ie,Reload:o}),(0,L.jsx)(X,{open:J,onClose:()=>Q(!1),taskDetails:W})]})},re=()=>{const[e,s]=(0,t.useState)(!1),[a,g]=(0,t.useState)([]),[T,v]=(0,t.useState)([]),{contextObj:S}=(0,t.useContext)(u.a),[b,k]=(0,t.useState)(!1),[f,I]=(0,t.useState)(null),[N,E]=(0,t.useState)(!1),[C,D]=(0,t.useState)(0),[P,w]=(0,t.useState)(!1),[R,A]=(0,t.useState)(null),[O,F]=(0,t.useState)(!1),[q,B]=(0,t.useState)(!1),[M,$]=(0,t.useState)(""),[U,W]=(0,t.useState)(!1),G=JSON.parse(localStorage.getItem("user"));(0,t.useEffect)((()=>{z(),J()}),[null===G||void 0===G?void 0:G.Company_id,e]);const H=()=>{s((e=>!e)),W((e=>!e))},z=async()=>{try{const e=await(0,x.q)({address:`taskManagement/project/newProjectAbstract?Company_id=${null===G||void 0===G?void 0:G.Company_id}`});g(e.success?e.data:[])}catch(e){console.error(e),g([])}},J=async()=>{try{const e=await(0,x.q)({address:`taskManagement/project?Company_id=${null===G||void 0===G?void 0:G.Company_id}`});v(e.success?e.data:[])}catch(e){console.error(e),v([])}},V=()=>{R&&(0,x.q)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===R||void 0===R?void 0:R.Project_Id}}).then((a=>{a.success?(s(!e),p.m4.success(a.message)):p.m4.error(a.message)})).catch((e=>console.error("Fetch Error:",e))),w(!1)},Q=[{name:"Project",selector:e=>e.Project_Name,sortable:!0,width:"250px"},{name:"Head",selector:e=>{var s;return null===(s=T.find((s=>s.Project_Id===e.Project_Id)))||void 0===s?void 0:s.Project_Head_Name},sortable:!0},{name:"Status",selector:e=>{var s;return null===(s=T.find((s=>s.Project_Id===e.Project_Id)))||void 0===s?void 0:s.Status},sortable:!0},{name:"End Date",selector:e=>e.Est_End_Dt?new Date(e.Est_End_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"Progress",selector:e=>{return`${s=e.TodayTaskcounts,a=e.CompletedTasks,0===Number(s)?0:(Number(a)/Number(s)*100).toFixed(0)}%`;var s,a},sortable:!0},{name:"Task Details",cell:e=>(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(r.c,{onClick:()=>Z(e),children:(0,L.jsx)(i.c,{})}),e.CompletedTasks," / ",e.TodayTaskcounts]})},{name:"Task Count",selector:e=>null===e||void 0===e?void 0:e.TodayTaskcounts,sortable:!0,sortable:!0},{name:"Assigned",selector:e=>e.TasksAssignedToEmployee},{name:"Employees",cell:e=>(0,L.jsxs)(L.Fragment,{children:[1===Number(null===S||void 0===S?void 0:S.Add_Rights)&&(0,L.jsx)(r.c,{onClick:()=>ee(e.Project_Id),children:(0,L.jsx)(o.c,{})}),e.EmployeesInvolved]})},{name:"Actions",cell:e=>(0,L.jsx)(L.Fragment,{children:1===Number(null===S||void 0===S?void 0:S.Edit_Rights)&&(0,L.jsx)(r.c,{onClick:()=>K(e),children:(0,L.jsx)(m.c,{})})})}],Y=a.filter((e=>{var s,a;const t=(null===(s=T.find((s=>s.Project_Id===e.Project_Id)))||void 0===s?void 0:s.Project_Head_Name)||"",r=(null===(a=T.find((s=>s.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Status)||"";return e.Project_Name.toLowerCase().includes(M.toLowerCase())||t.toLowerCase().includes(M.toLowerCase())||r.toLowerCase().includes(M.toLowerCase())})),K=e=>{I(e),E(!0),k(!0)},Z=e=>{I(e),D(e.Project_Id),B(!0)},X=()=>{k(!1),B(!1),I(null),A(null),w(!1)},ee=e=>{D(e),F(!0)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"fw-bold d-flex align-items-center justify-content-between mt-0 ",children:[(0,L.jsx)("span",{style:{marginLeft:"20px"},children:"Projects"}),(0,L.jsxs)("div",{className:"mb-1",style:{display:"flex",alignItems:"center"},children:[(0,L.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,L.jsx)(h.c,{style:{position:"absolute",left:15,color:"#aaa"}}),(0,L.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>$(e.target.value),style:{paddingLeft:35,marginRight:10,margin:10,borderRadius:4,border:"1px solid black"}})]}),1===Number(null===S||void 0===S?void 0:S.Add_Rights)&&(0,L.jsx)("button",{onClick:()=>{I(null),E(!1),k(!0)},className:"btn btn-primary fa-13 shadow",children:"Create Project"})]})]}),(0,L.jsxs)("div",{className:"card-body p-0 table-container",children:[(0,L.jsx)(j.cp,{columns:Q,data:Y,pagination:!0,highlightOnHover:!0,fixedHeader:!0,paginationPerPage:15,responsive:!0,persistTableHead:!0,customStyles:{headCells:{style:{fontSize:"16px",fontWeight:"bold",padding:"10px",backgroundColor:"#2c3e50",color:"#ecf0f1",position:"sticky",top:0,zIndex:2}},cells:{style:{padding:"8px",fontSize:"14px",backgroundColor:"#f9f9f9",color:"#2c3e50"}},rows:{style:{borderBottom:"1px solid #ddd"}}},style:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"}}),(0,L.jsxs)(l.c,{open:P,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,L.jsx)(n.c,{className:"bg-danger text-white mb-2 px-3 py-2",style:{fontSize:"18px"},children:"Confirm Deletion"}),(0,L.jsxs)(c.c,{className:"p-4",style:{fontSize:"16px"},children:["Are you sure you want to delete the project",(0,L.jsx)("span",{className:"text-primary",children:" "+(null===R||void 0===R?void 0:R.Project_Name)+" "}),"?"]}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)("button",{onClick:()=>w(!1),className:"btn btn-secondary fa-13 shadow",style:{background:"#95a5a6",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Cancel"}),(0,L.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",style:{background:"#e74c3c",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Delete"})]})]})]}),(0,L.jsx)(te,{onClose:X,dialogOpen:q,setDialogOpen:B,isEdit:!1,parseData:G,projectid:C,onReload:H,selectedProject:f,reload:e}),(0,L.jsx)(_.c,{open:b,onClose:X,inputValue:f,isEdit:N,setReload:H,projectData:C}),(0,L.jsx)(y.c,{open:O,onClose:()=>F(!1),projectId:C,onReload:H}),(0,L.jsxs)(l.c,{open:P,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,L.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,L.jsxs)(c.c,{className:"p-4",children:["Do you want to delete the project",(0,L.jsx)("span",{className:"text-primary",children:" "+(null===R||void 0===R?void 0:R.Project_Name)+" "}),"?"]}),(0,L.jsxs)(d.c,{children:[(0,L.jsx)("button",{onClick:()=>w(!1),className:"btn btn-secondary fa-13 shadow",children:"Cancel"}),(0,L.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",children:"Delete"})]})]})]})}},8436:(e,s,a)=>{a.d(s,{c:()=>p});var t=a(69060),r=a(82656),l=a(26773),n=a(4488),c=a(90048),d=a(1908),i=a(56480),o=(a(21680),a(64568)),m=a(39308),h=a(82496);const p=e=>{let{open:s,onClose:a,inputValue:p,isEdit:u,setReload:x}=e;const _=localStorage.getItem("user"),y=JSON.parse(_),[j,g]=(0,t.useState)([]),[T,v]=(0,t.useState)([]),[S,b]=(0,t.useState)({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,m.Q7)(),Est_End_Dt:(0,m.Q7)(),Project_Status:"",Entry_By:null===y||void 0===y?void 0:y.UserId,Company_id:null===y||void 0===y?void 0:y.Company_id});(0,t.useEffect)((()=>{(0,d.q)({address:`masters/users/employee/dropDown?Company_id=${null===y||void 0===y?void 0:y.Company_id}`}).then((e=>{g(e.success?e.data:[])})).catch((e=>console.error("Fetch Error:",e)))}),[null===y||void 0===y?void 0:y.Company_id]),(0,t.useEffect)((()=>{(0,d.q)({address:"taskManagement/statusList"}).then((e=>{e.success&&v(e.data)})).catch((e=>console.error("Fetch Error:",e)))}),[]),(0,t.useEffect)((()=>{s&&(u&&p?b({...p,Project_Head:null===p||void 0===p?void 0:p.Project_Head_Id,Est_Start_Dt:p.Est_Start_Dt?(0,m.Q7)(p.Est_Start_Dt):"",Est_End_Dt:p.Est_End_Dt?(0,m.Q7)(p.Est_End_Dt):"",Project_Status:(null===p||void 0===p?void 0:p.Project_Status)||"",Project_Desc:(null===p||void 0===p?void 0:p.Project_Desc)||"-"}):u||b({Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,m.Q7)(),Est_End_Dt:(0,m.Q7)(),Project_Status:"",Entry_By:null===y||void 0===y?void 0:y.UserId,Company_id:null===y||void 0===y?void 0:y.Company_id}))}),[p,s,u]);const k=e=>{b({...S,[e.target.name]:e.target.value})},f=()=>{const e=["Project_Name","Project_Head","Est_Start_Dt","Est_End_Dt","Project_Status"];for(const s of e)if(!S[s])return i.m4.error(`${s.replace(/_/g," ")} is required`),!1;return!0},I=[{label:"Project Name",elem:"input",type:"text",required:!0,name:"Project_Name",value:S.Project_Name||""},{label:"Project Head",elem:"select",options:j.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))),required:!0,name:"Project_Head",value:S.Project_Head||""},{label:"Estimated Start Date",elem:"input",type:"date",required:!0,name:"Est_Start_Dt",value:S.Est_Start_Dt||""},{label:"Estimated End Date",elem:"input",type:"date",required:!0,name:"Est_End_Dt",value:S.Est_End_Dt||""},{label:"Project Status",elem:"select",options:T.map((e=>({value:e.Status_Id,label:e.Status}))),required:!0,name:"Project_Status",value:S.Project_Status||""},{label:"Description",elem:"textarea",name:"Project_Desc",value:S.Project_Desc||" "}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(r.c,{open:s,onClose:a,children:[(0,h.jsx)(l.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:u?"Edit Project":"Create Project"}),(0,h.jsx)(n.c,{children:(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u?f()&&(0,d.q)({address:"taskManagement/project",method:"PUT",bodyData:S}).then((e=>{e.success?(a(),x((e=>!e)),i.m4.success(e.message)):i.m4.error(e.message)})).catch((e=>console.error("Fetch Error:",e))):(()=>{if(!f())return;const e={...S,Company_id:y.Company_id};(0,d.q)({address:"taskManagement/project",method:"POST",bodyData:e}).then((e=>{e.success?(a(),x((e=>!e)),i.m4.success(e.message)):i.m4.error(e.message)})).catch((e=>{console.error("Fetch Error:",e),i.m4.error("An error occurred while creating the project.")}))})()},children:[(0,h.jsx)("div",{className:"row",children:I.map(((e,s)=>(0,h.jsxs)("div",{className:"col-lg-4 mb-3",children:[(0,h.jsxs)("label",{children:[e.label," ",e.required&&(0,h.jsx)(o.c,{})]}),"textarea"===e.elem?(0,h.jsx)("textarea",{name:e.name,className:"cus-inpt",value:e.value,onChange:k}):"select"===e.elem?(0,h.jsxs)("select",{name:e.name,className:"cus-inpt",value:e.value,onChange:k,children:[(0,h.jsx)("option",{value:"",children:"Select"}),e.options&&e.options.map(((e,s)=>(0,h.jsx)("option",{value:e.value,children:e.label},s)))]}):(0,h.jsx)("input",{type:e.type,name:e.name,className:"cus-inpt",value:e.value,onChange:k})]},s)))}),(0,h.jsxs)(c.c,{children:[(0,h.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:a,children:"Cancel"}),(0,h.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:u?"Update":"Submit"})]})]})})]})})}},45108:(e,s,a)=>{a.d(s,{c:()=>b});var t=a(69060),r=a(82656),l=a(90048),n=a(89e3),c=a(4488),d=a(99904),i=a(33856),o=a(58612),m=a(27454),h=a(96464),p=a(29504),u=a(26773),x=a(71448),_=a(44380),y=a(1908),j=a(56480),g=a(12572),T=a(77536),v=a(76552),S=a(82496);const b=e=>{let{open:s,onClose:a,projectId:b,onReload:k}=e;const f={Name:"",Designation_Name:"",BranchName:""},[I,N]=(0,t.useState)(f),[E,C]=(0,t.useState)(!0),[D,P]=(0,t.useState)(!1),[w,R]=(0,t.useState)([]),[A,O]=(0,t.useState)([]),F=localStorage.getItem("user"),q=JSON.parse(F),{contextObj:B}=(0,t.useContext)(T.a);(0,t.useEffect)((()=>{s&&b&&(M(),$(),L())}),[s,b]);const M=async()=>{C(!0);try{const e=await(0,y.q)({address:`masters/Employeedetails?Project_Id=${b}`});e.success&&N(e.data)}catch(e){console.error(e),j.m4.error("Failed to fetch employee details")}finally{C(!1)}},$=async()=>{C(!0);try{const e=await(0,y.q)({address:`masters/Employeedetails/dropDown?Company_id=${q.Company_id}`});e.success&&R(e.data)}catch(e){console.error(e),j.m4.error("Failed to fetch employees for dropdown")}finally{C(!1)}},L=async()=>{C(!0);try{const e=await(0,y.q)({address:`masters/Employeedetails?Project_Id=${b}`});e.success&&O(e.data)}catch(e){console.error(e),j.m4.error("Failed to fetch assigned employees")}finally{C(!1)}},U=()=>{a(),N(f)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(r.c,{open:s,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsxs)(g.c,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,marginInlineStart:2,children:[(0,S.jsx)("span",{children:"Employee Details"}),(0,S.jsx)(l.c,{children:(0,S.jsx)(n.c,{variant:"contained",color:"primary",onClick:()=>{P(!0)},sx:{mr:1},children:"Add"})})]}),(0,S.jsx)(c.c,{children:E?(0,S.jsx)("p",{children:"Loading..."}):(0,S.jsx)(d.c,{children:(0,S.jsxs)(i.c,{children:[(0,S.jsx)(o.c,{children:(0,S.jsxs)(m.c,{children:[(0,S.jsx)(h.c,{children:"Employee Name"}),(0,S.jsx)(h.c,{children:"Position"}),(0,S.jsx)(h.c,{children:"Department"})]})}),(0,S.jsx)(p.c,{children:Array.isArray(I)&&I.length>0?I.map((e=>(0,S.jsxs)(m.c,{children:[(0,S.jsx)(h.c,{children:e.Name||"N/A"}),(0,S.jsx)(h.c,{children:e.Designation_Name||"-"}),(0,S.jsx)(h.c,{children:e.BranchName||"-"})]},e.EmployeeId||e.UserId))):(0,S.jsx)(m.c,{children:(0,S.jsx)(h.c,{colSpan:3,children:"No data available"})})})]})})}),(0,S.jsx)(l.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,S.jsx)(n.c,{variant:"contained",color:"primary",onClick:U,children:"Close"})})]}),(0,S.jsxs)(r.c,{open:D,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsx)(u.c,{children:"Add Employee"}),(0,S.jsx)(c.c,{children:(0,S.jsx)(x.c,{multiple:!0,options:w,getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,s)=>e.UserId===s.UserId,onChange:(e,s)=>{const a=s.filter(((e,s,a)=>s===a.findIndex((s=>s.UserId===e.UserId))));O(a)},PopperComponent:e=>(0,S.jsx)(v.c,{...e,placement:"top"}),value:A,onClose:onclose,renderInput:e=>(0,S.jsx)(_.c,{...e,placeholder:"Employees"})})}),(0,S.jsxs)(l.c,{children:[(0,S.jsx)(n.c,{onClick:()=>{P(!1),U(),N(f)},children:"Cancel"}),(0,S.jsx)(n.c,{onClick:async()=>{if(1===Number(null===B||void 0===B?void 0:B.Add_Rights))try{(await(0,y.q)({address:"masters/Employeedetails/employeeAdd",method:"POST",bodyData:{Project_Id:b,UserIds:A.map((e=>e.UserId))}})).success?(j.m4.success("Employees added successfully"),P(!1),await M(),await L(),k()):j.m4.error("Failed to add employees")}catch(e){console.error(e),j.m4.error("Error adding employees")}},variant:"contained",color:"primary",children:"Add"})]})]})]})}}}]);
//# sourceMappingURL=6056.26c09c01.chunk.js.map