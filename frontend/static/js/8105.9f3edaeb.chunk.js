"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8105],{48105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(30800),c=a(69060),r=a(1908),o=a(3358),l=a(5548),d=a(82656),n=a(26773),i=a(4488),m=a(44380),u=a(90048),h=a(87016),_=a(57704),v=a(86e3),x=a(45180),p=a(51560),D=a(56480),j=a(13724),g=a(42136),I=a(39308),w=a(73380),N=a.n(w),b=a(85592),f=a.n(b),S=a(26592),C=a(82496);const R={Fromdate:(0,I.Q7)(),NewDate:""},F=e=>{const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(c)};const P=function(){var e;const[t,a]=(0,c.useState)({Fromdate:R.Fromdate,fetchFrom:R.Fromdate,NewDate:R.NewDate,fetchNew:R.NewDate}),[w,b]=(0,c.useState)(!1),[P,y]=(0,c.useState)({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),[A,B]=(0,c.useState)(!1),[k,E]=(0,c.useState)([]),[O,M]=(0,c.useState)([]),[T,q]=(0,c.useState)([]),Y=(0,p.i6)(),W=(0,p.IT)(),L=new URLSearchParams((0,p.IT)().search),[z,H]=(0,c.useState)(""),[U,V]=(0,c.useState)([]),[Q,G]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const e={Fromdate:L.get("Fromdate")&&(0,I.e8)(L.get("Fromdate"))?L.get("Fromdate"):R.Fromdate,NewDate:L.get("NewDate")&&(0,I.e8)(L.get("NewDate"))?L.get("NewDate"):R.NewDate};a((t=>(0,s.c)((0,s.c)({},t),{},{fetchFrom:e.Fromdate,fetchNew:e.NewDate})))}),[W.search]),(0,c.useEffect)((()=>{(0,r.q)({address:"masters/posRateMaster?FromDate=".concat(null===t||void 0===t?void 0:t.Fromdate)}).then((e=>{e.success&&(V(e),q(e.data))})).catch((e=>console.error(e))),(0,r.q)({address:"masters/posbranch/dropdown"}).then((e=>{e.success&&E(e.data)})).catch((e=>console.error(e)))}),[t.Fromdate,Q]),(0,c.useEffect)((()=>{z&&(async e=>{(0,r.q)({address:"masters/posbrand/productList?Pos_Brand_Id=".concat(e)}).then((e=>{e.success&&M(e.data)})).catch((e=>console.error(e)))})(z)}),[z]),(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"date-inputs",children:(0,C.jsxs)("div",{className:"p-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,C.jsxs)("h5",{className:"m-0 my-1 flex-grow-1 d-flex align-items-center flex-wrap",children:[(0,C.jsx)("span",{className:"mx-2",children:"Rate Master"}),(0,C.jsx)(g.c,{onClick:()=>K(!0),children:"Export To"}),(0,C.jsx)(g.c,{className:"mx-2 btn btn-dark",style:{outline:"none",boxShadow:"none"},onClick:async()=>{const e=T.filter((e=>1===e.Is_Active_Decative));if(0===e.length)return void alert("No active data available for download.");const t=e.reduce(((e,t)=>{const{Pos_Brand_Id:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{});const a=new(f().Workbook),s=a.addWorksheet("PriceList_Data"),c=e.length>0?e[0].Rate_Date.split("T")[0].split("-").reverse().join("-"):"";s.addRow([c,"PriceList"]).font={bold:!0,size:14},Object.entries(t).forEach((e=>{let[t,a]=e;const c=s.addRow([a[0].POS_Brand_Name]).getCell(1);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}},c.font={bold:!0,size:12},a.forEach((e=>{s.addRow([e.Short_Name,e.Rate])}))})),s.columns=[{width:40},{width:15}];const r=await a.xlsx.writeBuffer(),o=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,S.saveAs)(o,"PriceList_Data.xlsx")},children:"Download Excel"})]}),(0,C.jsx)(o.c,{title:"Sync Data",children:(0,C.jsx)(l.c,{onClick:()=>{(0,r.q)({address:"masters/posproductSync"}).then((e=>{e&&D.m4.success(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e)))},children:(0,C.jsx)(h.c,{})})}),(0,C.jsx)("div",{children:(0,C.jsx)("input",{type:"date",value:t.Fromdate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{Fromdate:c,fetchFrom:c}))},className:"cus-inpt w-auto p-1"})}),(0,C.jsx)(l.c,{onClick:()=>{(e=>{const t=new URLSearchParams(e);Y("?".concat(t.toString()),{replace:!0})})({Fromdate:null===t||void 0===t?void 0:t.Fromdate})},variant:"outlined",size:"small",children:(0,C.jsx)(_.c,{})}),(null===t||void 0===t?void 0:t.Fromdate)===N()().format("YYYY-MM-DD")?(0,C.jsx)(g.c,{onClick:()=>b(!0),children:"Add"}):null]})}),(0,C.jsx)(j.cp,{dataArray:T,EnableSerialNumber:!0,isExpendable:!0,maxHeightOption:!0,columns:[(0,j.A5)("Rate_Date","date","Rate Date"),(0,j.A5)("POS_Brand_Name","string","Brand"),(0,j.A5)("Short_Name","string","Product"),(0,j.A5)("Rate","string","Rate"),{Field_Name:"Is_Active_Decative",ColumnHeader:"Status",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;const a=1===t.Is_Active_Decative?"Active":"Inactive";return(0,C.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 text-white",style:{backgroundColor:"Active"===a?"green":"red"},children:a})}},(null===t||void 0===t?void 0:t.Fromdate)===N()().format("YYYY-MM-DD")?{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,C.jsxs)("td",{style:{minWidth:"80px"},children:[(0,C.jsx)(l.c,{onClick:()=>{return e=t,b(!0),y({Id:null===e||void 0===e?void 0:e.Id,Rate_Date:F(e.Rate_Date),Pos_Brand_Id:e.Pos_Brand_Id,Item_Id:e.Item_Id,Rate:e.Rate,Is_Active_Decative:e.Is_Active_Decative,POS_Brand_Name:e.POS_Brand_Name,Product_Name:e.Product_Name}),void H(e.Pos_Brand_Id);var e},size:"small",children:(0,C.jsx)(v.c,{className:"fa-in"})}),(0,C.jsx)(l.c,{onClick:()=>{B(!0),y({Id:t.Id})},size:"small",color:"error",children:(0,C.jsx)(x.c,{className:"fa-in "})})]})}}:{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,C.jsx)("td",{children:"-"})}}]}),(0,C.jsxs)(d.c,{open:w,onClose:()=>b(!1),fullWidth:!0,maxWidth:"sm",children:[(0,C.jsxs)(n.c,{children:[P.Id?"UPDATE":"CREATE"," RATE MASTER"]}),(0,C.jsxs)("form",{onSubmit:e=>{e.preventDefault(),P.Id?(0,r.q)({address:"masters/posRateMaster",method:"PUT",bodyData:(0,s.c)((0,s.c)({},P),{},{Rate_Date:F(P.Rate_Date)})}).then((e=>{e.success?(D.m4.success("Rate Master updated successfully!"),b(!1),G(!Q),y({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),H("")):D.m4.error("Failed to update Rate Master:",e.message)})).catch((e=>{throw e})):(0,r.q)({address:"masters/posRateMaster",method:"POST",bodyData:(0,s.c)((0,s.c)({},P),{},{Pos_Brand_Id:z,Item_Id:P.Item_Id,Rate_Date:F(P.Rate_Date)})}).then((e=>{e.success?(b(!1),D.m4.success(e.message),y({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),H(""),G(!Q)):D.m4.error(e.message)})).catch((e=>console.error(e)))},children:[(0,C.jsxs)(i.c,{children:[(0,C.jsx)("label",{children:"Rate Date"}),(0,C.jsx)("input",{type:"date",value:P.Rate_Date,onChange:e=>y((0,s.c)((0,s.c)({},P),{},{Rate_Date:e.target.value})),className:"cus-inpt"}),(0,C.jsx)("label",{children:"POS Brand"}),(0,C.jsxs)("select",{value:z,onChange:e=>{const t=e.target.value;H(t),y((0,s.c)((0,s.c)({},P),{},{Pos_Brand_Id:t}))},className:"cus-inpt",children:[(0,C.jsx)("option",{value:"",disabled:!0,children:"Select POS Brand"}),k.map(((e,t)=>(0,C.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,C.jsx)("label",{children:"Product"}),(0,C.jsxs)("select",{className:"cus-inpt",disabled:!z,value:P.Item_Id,onChange:e=>{y((0,s.c)((0,s.c)({},P),{},{Item_Id:e.target.value}))},children:[(0,C.jsx)("option",{value:"",disabled:!0,children:"Select Product"}),O.length>0?O.map(((e,t)=>(0,C.jsx)("option",{value:e.value,children:e.label},t))):(0,C.jsx)("option",{value:"",disabled:!0,children:"No products available"})]}),(0,C.jsx)("label",{children:"Rate"}),(0,C.jsx)(m.c,{label:"",value:null!==(e=P.Rate)&&void 0!==e?e:"",onChange:e=>y((0,s.c)((0,s.c)({},P),{},{Rate:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,C.jsx)("label",{children:"Status"}),(0,C.jsxs)("select",{value:P.Is_Active_Decative,onChange:e=>y((0,s.c)((0,s.c)({},P),{},{Is_Active_Decative:e.target.value})),children:[(0,C.jsx)("option",{value:"1",children:"Active"}),(0,C.jsx)("option",{value:"0",children:"Inactive"})]})]}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>{y({}),b(!1)},children:"Cancel"}),(0,C.jsx)(g.c,{type:"submit",variant:"contained",children:"Save"})]})]})]}),(0,C.jsxs)(d.c,{open:A,onClose:()=>B(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,C.jsx)(n.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,C.jsx)(i.c,{children:(0,C.jsx)("b",{children:"Do you want to delete the RateMaster?"})}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>B(!1),children:"Cancel"}),(0,C.jsx)(g.c,{onClick:()=>(P.Id,void(0,r.q)({address:"masters/posRateMaster",method:"DELETE",bodyData:{Id:P.Id}}).then((e=>{e.success?(G(!Q),B(!1),b(!1),y({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"1",POS_Brand_Name:"",Product_Name:""}),H(""),D.m4.success("Rate Master deleted successfully!")):D.m4.error("Failed to delete area:",e.message)})).catch((e=>console.error(e)))),autoFocus:!0,color:"error",children:"Delete"})]})]}),(0,C.jsxs)(d.c,{open:J,onClose:()=>K(!1),fullWidth:!0,maxWidth:"sm",children:[(0,C.jsx)(n.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,C.jsx)(i.c,{children:(0,C.jsxs)("b",{children:["Do you want to export data from:",(0,C.jsxs)("div",{children:[(0,C.jsx)("label",{children:"From Date"}),(0,C.jsx)("input",{type:"date",disabled:!0,value:t.Fromdate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{Fromdate:c,fetchFrom:c}))},className:"cus-inpt w-auto p-1"})]}),(0,C.jsx)("br",{}),(0,C.jsxs)("div",{children:[(0,C.jsx)("label",{children:"New Date"}),(0,C.jsx)("input",{type:"date",value:t.NewDate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{NewDate:c}))},className:"cus-inpt w-auto p-1"})]})]})}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(g.c,{onClick:()=>K(!1),children:"Cancel"}),(0,C.jsx)(g.c,{onClick:()=>(async()=>{if(null===t||void 0===t||!t.Fromdate||null===t||void 0===t||!t.NewDate)throw new Error("Both 'From Date' and 'New Date' are required.");(0,r.q)({address:"masters/exportRateMaster?FromDate=".concat(null===t||void 0===t?void 0:t.Fromdate,"&NewDate=").concat(null===t||void 0===t?void 0:t.NewDate),method:"POST",bodyData:{bulkData:U}}).then((e=>{e.success?(D.m4.success(e.message),K(!1)):D.m4.error(e.message)})).catch((e=>console.error(e)))})(),autoFocus:!0,color:"primary",children:"Export"})]})]})]})}}}]);
//# sourceMappingURL=8105.9f3edaeb.chunk.js.map