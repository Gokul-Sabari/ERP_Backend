"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[3676],{50764:(e,l,a)=>{a.d(l,{c:()=>w});var i=a(69060),t=a(39308),r=a(71448),d=a(52924),s=a(44380),n=a(12572),o=a(89e3),c=a(3358),u=a(5548),m=a(82656),v=a(26773),p=a(4488),x=a(90048),h=a(43692),g=a(85624),y=a(78092),_=a(68424),b=a(39504),j=a(61988),f=a(12120),N=a(74912),F=a(97332),A=a(13724),C=a(82496);(0,F.g0)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});const D=(0,C.jsx)(_.c,{fontSize:"small"}),S=(0,C.jsx)(b.c,{fontSize:"small"}),w=e=>{let{dataArray:l=[],columns:a=[],ExpandableComp:_,enableFilters:b=!1,ExportAllData:F=!1}=e;const[w,M]=(0,i.useState)([]),[k,T]=(0,i.useState)({}),[O,B]=(0,i.useState)(l),L=Object.keys(k).length>0?O:l,[V,I]=(0,i.useState)({filters:!1,columnSettings:!1});(0,i.useEffect)((()=>{const e=a.map(((e,l)=>({Field_Name:null===e||void 0===e?void 0:e.Column_Name,Fied_Data:null===e||void 0===e?void 0:e.Data_Type,isVisible:l<=7?1:0,align:"center",OrderBy:l+1})));M(e)}),[a]);const W=(0,i.useMemo)((()=>[...w].sort(((e,l)=>e.OrderBy-l.OrderBy))),[w]);(0,i.useEffect)((()=>{Q()}),[k]);const E=(e,l)=>{T((a=>({...a,[e]:l})))},Q=()=>{let e=[...l];for(const l of w)if(k[l.Field_Name])if("range"===k[l.Field_Name].type){const{min:a,max:i}=k[l.Field_Name];e=e.filter((e=>{const t=e[l.Field_Name];return(void 0===a||t>=a)&&(void 0===i||t<=i)}))}else if("date"===k[l.Field_Name].type){const{start:a,end:i}=k[l.Field_Name].value;e=e.filter((e=>{const t=new Date(e[l.Field_Name]);return(void 0===a||t>=new Date(a))&&(void 0===i||t<=new Date(i))}))}else if(Array.isArray(k[l.Field_Name])){var a;e=(null===(a=k[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter((e=>k[l.Field_Name].includes(e[l.Field_Name].toLowerCase().trim()))):e}B(e)},R=e=>{const{Field_Name:l,Fied_Data:a}=e;var i,t,n,o,c,u,m,v,p,x;if("number"===a)return(0,C.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,C.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(i=null===(t=k[l])||void 0===t?void 0:t.min)&&void 0!==i?i:"",onChange:e=>E(l,{type:"range",...k[l],min:e.target.value?parseFloat(e.target.value):void 0})}),(0,C.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(n=null===(o=k[l])||void 0===o?void 0:o.max)&&void 0!==n?n:"",onChange:e=>E(l,{type:"range",...k[l],max:e.target.value?parseFloat(e.target.value):void 0})})]});if("date"===a)return(0,C.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,C.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(c=null===(u=k[l])||void 0===u||null===(m=u.value)||void 0===m?void 0:m.start)&&void 0!==c?c:"",onChange:e=>{var a;return E(l,{type:"date",value:{...null===(a=k[l])||void 0===a?void 0:a.value,start:e.target.value||void 0}})}}),(0,C.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(v=null===(p=k[l])||void 0===p||null===(x=p.value)||void 0===x?void 0:x.end)&&void 0!==v?v:"",onChange:e=>{var a;return E(l,{type:"date",value:{...null===(a=k[l])||void 0===a?void 0:a.value,end:e.target.value||void 0}})}})]});if("string"===a){const e=[...new Set(L.map((e=>{var a,i;return null===(a=e[l])||void 0===a||null===(i=a.toLowerCase())||void 0===i?void 0:i.trim()})))];return(0,C.jsx)(r.c,{multiple:!0,id:`${l}-filter`,options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:k[l]||[],onChange:(e,a)=>E(l,a),renderOption:(e,l,a)=>{let{selected:i}=a;return(0,C.jsxs)("li",{...e,children:[(0,C.jsx)(d.c,{icon:D,checkedIcon:S,style:{marginRight:8},checked:i}),l]})},isOptionEqualToValue:(e,l)=>e===l,renderInput:e=>(0,C.jsx)(s.c,{...e,label:l,placeholder:`Select ${null===l||void 0===l?void 0:l.replace(/_/g," ")}`})})}};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(n.c,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:(0,C.jsx)(o.c,{onClick:()=>I((e=>({...e,filters:!0}))),className:b?"d-md-none d-inline":"d-none",startIcon:(0,C.jsx)(j.c,{}),children:"Filters"})}),(0,C.jsxs)("div",{className:"row ",children:[(0,C.jsx)("div",{className:b?"col-xxl-10 col-lg-9 col-md-8":"",children:(0,C.jsx)("div",{className:"p-2",children:(0,C.jsx)(A.cp,{dataArray:L,columns:W,isExpendable:!!_,expandableComp:_||void 0,tableMaxHeight:650,ExcelPrintOption:!0})})}),b&&(0,C.jsxs)("div",{className:"col-xxl-2 col-lg-3 col-md-4 d-none d-md-block",children:[(0,C.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,C.jsx)("span",{children:"Filters"}),(0,C.jsxs)("span",{children:[(0,C.jsx)(c.c,{title:"Column Visiblity",children:(0,C.jsx)(u.c,{size:"small",onClick:()=>I((e=>({...e,columnSettings:!0}))),children:(0,C.jsx)(f.c,{})})}),(0,C.jsx)(c.c,{title:"Clear Filters",children:(0,C.jsx)(u.c,{size:"small",onClick:()=>T({}),children:(0,C.jsx)(N.c,{})})})]})]}),(0,C.jsxs)("div",{className:"border rounded-3 ",style:{maxHeight:"70vh",overflow:"auto"},children:[w.map(((e,l)=>{var a;return(0,C.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,C.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")}),R(e)]},l)})),(0,C.jsx)("br",{})]})]})]}),(0,C.jsxs)(m.c,{open:V.filters,onClose:()=>I((e=>({...e,filters:!1}))),fullWidth:!0,maxWidth:"sm",children:[(0,C.jsx)(v.c,{children:(0,C.jsx)("span",{children:(0,C.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,C.jsx)("span",{children:"Filters"}),(0,C.jsxs)("span",{children:[(0,C.jsx)(c.c,{title:"Column Visiblity",children:(0,C.jsx)(u.c,{size:"small",onClick:()=>I((e=>({...e,filters:!1}))),children:(0,C.jsx)(f.c,{})})}),(0,C.jsx)(c.c,{title:"Clear Filters",children:(0,C.jsx)(u.c,{size:"small",onClick:()=>T({}),children:(0,C.jsx)(N.c,{})})})]})]})})}),(0,C.jsx)(p.c,{children:(0,C.jsxs)("div",{className:"border rounded-3 ",style:{maxHeight:"70vh",overflow:"auto"},children:[w.map(((e,l)=>{var a;return(0,C.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,C.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")}),R(e)]},l)})),(0,C.jsx)("br",{})]})}),(0,C.jsx)(x.c,{children:(0,C.jsx)(o.c,{onClick:()=>I((e=>({...e,filters:!1}))),children:"Close"})})]}),(0,C.jsxs)(m.c,{open:V.columnSettings,onClose:()=>I((e=>({...e,columnSettings:!1}))),maxWidth:"lg",fullWidth:!0,children:[(0,C.jsx)(v.c,{children:"Column Settings"}),(0,C.jsx)(p.c,{children:(0,C.jsx)("div",{className:"row",children:a.map(((e,l)=>{const a=w.find((l=>l.Field_Name===(null===e||void 0===e?void 0:e.Column_Name)));return(0,C.jsx)("div",{className:"col-lg-4 col-md-6 p-2",children:(0,C.jsxs)(h.c,{component:g.c,className:"p-2 d-flex justify-content-between align-items-center flex-wrap "+(l%2!==0?"bg-light":""),children:[(0,C.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap",children:[(0,C.jsx)(y.c,{checked:Boolean(null===a||void 0===a?void 0:a.isVisible),onChange:l=>M((a=>a.map((a=>a.Field_Name===(null===e||void 0===e?void 0:e.Column_Name)?{...a,isVisible:l.target.checked?1:0}:a))))}),(0,C.jsx)("h6",{className:"fa-13 mb-0 fw-bold ",children:null===e||void 0===e?void 0:e.Column_Name})]}),(0,C.jsx)("input",{type:"number",value:(0,t.Q$)(null===a||void 0===a?void 0:a.OrderBy)?null===a||void 0===a?void 0:a.OrderBy:"",onChange:e=>M((l=>l.map((l=>l.Field_Name===(null===a||void 0===a?void 0:a.Field_Name)?{...l,OrderBy:e.target.value}:l)))),label:"Order Value",className:"mt-2 p-1 border-0 cus-inpt",style:{width:"80px"},placeholder:"Order"})]})},l)}))})}),(0,C.jsx)(x.c,{children:(0,C.jsx)(o.c,{onClick:()=>I((e=>({...e,columnSettings:!1}))),color:"error",children:"close"})})]})]})}},93676:(e,l,a)=>{a.r(l),a.d(l,{default:()=>L});var i=a(69060),t=a(43692),r=a(84436),d=a(3358),s=a(5548),n=a(39308),o=a(50764),c=a(13724),u=a(82496);const m=e=>{let{dataArray:l}=e;const a=["Stock_Group","Item_Name_Modified","Y1","M6","M2","LM","Total_Qty"],[t,r]=(0,i.useState)([]),d=(0,i.useMemo)((()=>l.map((e=>{const l=Array.isArray(null===e||void 0===e?void 0:e.StockTransaction)?null===e||void 0===e?void 0:e.StockTransaction:[],i=l[0]||{},t=Object.fromEntries(Object.entries(i).filter((e=>{let[l]=e;return!a.includes(l)&&!isNaN(Number(l))})).map((e=>{let[a]=e;r((e=>e.includes(a)?e:[...e,a]));const i=l.reduce(((e,l)=>e+(Number(l[a])||0)),0);return[a,i]})));return{...e,...t}}))),[l]);return(0,u.jsx)(i.Fragment,{children:(0,u.jsx)(c.cp,{dataArray:d,isExpendable:!0,columns:[(0,c.A5)("Stock_Group","string"),(0,c.A5)("Y1","number"),(0,c.A5)("M6","number"),(0,c.A5)("M2","number"),(0,c.A5)("LM","number"),(0,c.A5)("Total_Qty","number"),...t.map((e=>(0,c.A5)(e,"number",`Day ${e}`)))],expandableComp:e=>{let{row:l}=e;const i=Array.isArray(null===l||void 0===l?void 0:l.StockTransaction)?null===l||void 0===l?void 0:l.StockTransaction:[],t=[(0,c.A5)("Item_Name_Modified","string","Item"),(0,c.A5)("Y1","number"),(0,c.A5)("M6","number"),(0,c.A5)("M2","number"),(0,c.A5)("LM","number"),(0,c.A5)("Total_Qty","number")],r=Object.keys(i[0]||{}).filter((e=>!a.includes(e)&&"Stock_Group"!==e)).map((e=>(0,c.A5)(e,"number")));return(0,u.jsx)(c.cp,{initialPageCount:10,dataArray:i,columns:[...t,...r]})},tableMaxHeight:540})})},v=e=>{let{dataArray:l,days:a}=e;const t=(0,i.useMemo)((()=>l.map((e=>{var l,i,t,r,d;return{...e,M2_Avg:null!==(l=(0,n.yy)(e.ALL_Avg_M2,(0,n.W8)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(i=(0,n.yy)(e.ALL_Avg_M3,(0,n.W8)(3)/3))&&void 0!==i?i:0,M6_Avg:null!==(t=(0,n.yy)(e.ALL_Avg_M6,(0,n.W8)(6)/6))&&void 0!==t?t:0,M9_Avg:null!==(r=(0,n.yy)(e.ALL_Avg_M9,(0,n.W8)(9)/9))&&void 0!==r?r:0,M12_Avg:null!==(d=(0,n.yy)(e.ALL_Avg_One_Year,(0,n.W8)(12)/12))&&void 0!==d?d:0,Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty"),Billed_Avg:(0,n.SW)(e.StockTransaction,"bill_qty")/a,StockTransaction:e.StockTransaction.map((e=>{var l,a,i,t,r;return{...e,Grade_Item_Group:e.Item_Name_Modified,M2_Avg:null!==(l=(0,n.yy)(e.M2_AVG_Qty,(0,n.W8)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(a=(0,n.yy)(e.M3_AVG_Qty,(0,n.W8)(3)/3))&&void 0!==a?a:0,M6_Avg:null!==(i=(0,n.yy)(e.M6_AVG_Qty,(0,n.W8)(6)/6))&&void 0!==i?i:0,M9_Avg:null!==(t=(0,n.yy)(e.M9_AVG_Qty,(0,n.W8)(9)/9))&&void 0!==t?t:0,M12_Avg:null!==(r=(0,n.yy)(e.One_Year_AVG_Qty,(0,n.W8)(12)/12))&&void 0!==r?r:0}}))}})).map((e=>({...e,Billed_Qty:(0,n.SW)(e.StockTransaction,"bill_qty")})))),[l]);return(0,u.jsx)(i.Fragment,{children:(0,u.jsx)(c.cp,{dataArray:t,isExpendable:!0,columns:[{Field_Name:"Stock_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"Billed_Qty",isVisible:1,Fied_Data:"number"},{Field_Name:"Billed_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}],expandableComp:e=>{let{row:l}=e;return(0,u.jsx)(c.cp,{initialPageCount:10,dataArray:Array.isArray(l.StockTransaction)?l.StockTransaction:[],columns:[{Field_Name:"Grade_Item_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"bill_qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}]})},tableMaxHeight:540})})};var p=a(31664),x=a(1908),h=a(71448),g=a(52924),y=a(44380),_=a(82656),b=a(4488),j=a(90048),f=a(89e3),N=a(26773),F=a(85624),A=a(78092),C=a(68424),D=a(39504),S=a(12120),w=a(74912),M=a(61988);const k=(0,u.jsx)(C.c,{fontSize:"small"}),T=(0,u.jsx)(D.c,{fontSize:"small"}),O=e=>{let{row:l,Fromdate:a,Todate:t,DB:r}=e;const[d,s]=(0,i.useState)([]),[n,c]=(0,i.useState)([]),[m,v]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{v(!0),(0,x.q)({address:`reports/salesReport/ledger/itemDetails?Fromdate=${a}&Todate=${t}&Ledger_Id=${null===l||void 0===l?void 0:l.Ledger_Tally_Id}`,headers:{Db:r}}).then((e=>{let{success:l,data:a,others:i}=e;if(l){const{dataTypeInfo:e}=i;s(a),c((l=>({...l,salesInfo:Array.isArray(e)?e:[]})))}else s([])})).catch((e=>console.error(e))).finally((()=>{v(!1)}))}),[null===l||void 0===l?void 0:l.Ledger_Tally_Id,a,t]),m?(0,u.jsx)("h5",{className:"text-center text-primary ",children:"Loading..."}):(0,u.jsx)(o.c,{dataArray:d,columns:n.salesInfo})},B=e=>{let{dataArray:l,colTypes:a,DB:r,Fromdate:o,Todate:m}=e;const[v,p]=(0,i.useState)({}),[x,C]=(0,i.useState)(""),[D,B]=(0,i.useState)([]),[L,V]=(0,i.useState)(!1),[I,W]=(0,i.useState)(!1),E=a.map(((e,l)=>({isVisible:l<10?1:0,Field_Name:null===e||void 0===e?void 0:e.Column_Name,Fied_Data:null===e||void 0===e?void 0:e.Data_Type,OrderBy:l+1}))),[Q,R]=(0,i.useState)(E),z=(0,i.useMemo)((()=>[...Q].sort(((e,l)=>null!==e&&void 0!==e&&e.OrderBy&&null!==l&&void 0!==l&&l.OrderBy?(null===e||void 0===e?void 0:e.OrderBy)-(null===l||void 0===l?void 0:l.OrderBy):(null===l||void 0===l?void 0:l.OrderBy)-(null===e||void 0===e?void 0:e.OrderBy)))),[Q]),G=(0,i.useMemo)((()=>z.filter((e=>(0,n.Qr)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,n.Qr)(null===e||void 0===e?void 0:e.isVisible,1)))),[z]),P=(0,i.useMemo)((()=>{const e=Object.keys(v).length>0,a=!!x,i=e?D:l,t=a?(0,n.ui)(i,x):[],r=G.filter((e=>"number"===(0,n.MP)(e.Fied_Data))).map((e=>e.Field_Name)),d=t.map((e=>({...e,...Object.fromEntries(r.map((l=>{var a,i;return[l,"Total_Qty"===l?null===e||void 0===e||null===(a=e.groupedData)||void 0===a?void 0:a.reduce(((e,a)=>(0,n.Q5)(e,(0,n.gH)(a[l])||0)),0):(0,n.yy)(null===e||void 0===e||null===(i=e.groupedData)||void 0===i?void 0:i.reduce(((e,a)=>(0,n.Q5)(e,(0,n.gH)(a[l])||0)),0),e.groupedData.length)]})))})));return a?d:i}),[v,l,D,x,G]);(0,i.useEffect)((()=>{H()}),[v]);const $=(e,l)=>{p((a=>({...a,[e]:l})))},H=()=>{let e=[...l];for(const l of z)if(v[l.Field_Name])if("range"===v[l.Field_Name].type){const{min:a,max:i}=v[l.Field_Name];e=e.filter((e=>{const t=e[l.Field_Name];return(void 0===a||t>=a)&&(void 0===i||t<=i)}))}else if("date"===v[l.Field_Name].type){const{start:a,end:i}=v[l.Field_Name].value;e=e.filter((e=>{const t=new Date(e[l.Field_Name]);return(void 0===a||t>=new Date(a))&&(void 0===i||t<=new Date(i))}))}else if(Array.isArray(v[l.Field_Name])){var a;e=(null===(a=v[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter((e=>{var a;return v[l.Field_Name].includes(null===(a=e[l.Field_Name])||void 0===a?void 0:a.toLowerCase().trim())})):e}B(e)},q=e=>{const{Field_Name:a,Fied_Data:i}=e;var t,r,d,s,n,o,c,m,p,x;if("number"===i)return(0,u.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,u.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(t=null===(r=v[a])||void 0===r?void 0:r.min)&&void 0!==t?t:"",onChange:e=>$(a,{type:"range",...v[a],min:e.target.value?parseFloat(e.target.value):void 0})}),(0,u.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(d=null===(s=v[a])||void 0===s?void 0:s.max)&&void 0!==d?d:"",onChange:e=>$(a,{type:"range",...v[a],max:e.target.value?parseFloat(e.target.value):void 0})})]});if("date"===i)return(0,u.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,u.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(n=null===(o=v[a])||void 0===o||null===(c=o.value)||void 0===c?void 0:c.start)&&void 0!==n?n:"",onChange:e=>{var l;return $(a,{type:"date",value:{...null===(l=v[a])||void 0===l?void 0:l.value,start:e.target.value||void 0}})}}),(0,u.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(m=null===(p=v[a])||void 0===p||null===(x=p.value)||void 0===x?void 0:x.end)&&void 0!==m?m:"",onChange:e=>{var l;return $(a,{type:"date",value:{...null===(l=v[a])||void 0===l?void 0:l.value,end:e.target.value||void 0}})}})]});if("string"===i){const e=[...new Set(l.map((e=>{var l,i;return null===(l=e[a])||void 0===l||null===(i=l.toLowerCase())||void 0===i?void 0:i.trim()})))];return(0,u.jsx)(h.c,{multiple:!0,id:`${a}-filter`,options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:v[a]||[],onChange:(e,l)=>$(a,l),renderOption:(e,l,a)=>{let{selected:i}=a;return(0,u.jsxs)("li",{...e,children:[(0,u.jsx)(g.c,{icon:k,checkedIcon:T,style:{marginRight:8},checked:i}),l]})},isOptionEqualToValue:(e,l)=>e===l,renderInput:e=>(0,u.jsx)(y.c,{...e,label:a,placeholder:`Select ${null===a||void 0===a?void 0:a.replace(/_/g," ")}`})})}},Y=()=>{V(!1),W(!1)};return(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(c.cp,{title:"LOL - Sales Reports",headerFontSizePx:12,bodyFontSizePx:12,ButtonArea:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.c,{title:"Column Visiblity",children:(0,u.jsx)(s.c,{size:"small",onClick:()=>V(!0),children:(0,u.jsx)(S.c,{})})}),(0,u.jsx)(d.c,{title:"Clear Filters",children:(0,u.jsx)(s.c,{size:"small",onClick:()=>p({}),children:(0,u.jsx)(w.c,{})})}),(0,u.jsx)(d.c,{title:"Filters",children:(0,u.jsx)(s.c,{onClick:()=>W(!0),size:"small",children:(0,u.jsx)(M.c,{})})}),(0,u.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:x,onChange:e=>C(e.target.value),children:[(0,u.jsx)("option",{value:"",children:"Group By"}),G.filter((e=>"string"===(0,n.MP)(e.Fied_Data)&&"Ledger_Name"!==(null===e||void 0===e?void 0:e.Field_Name))).map(((e,l)=>{var a;return(0,u.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")},l)}))]})]}),ExcelPrintOption:!0,columns:x?G.filter((e=>P.length>0&&Object.keys(P[0]).includes(e.Field_Name))).map((e=>({...e,ColumnHeader:e.Field_Name===x?x:e.ColumnHeader}))):G,dataArray:P,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return x?(0,u.jsx)(c.cp,{title:l[x]+" - Ledgers",dataArray:Array.isArray(null===l||void 0===l?void 0:l.groupedData)?null===l||void 0===l?void 0:l.groupedData:[],columns:G,ExcelPrintOption:!0,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,u.jsx)(O,{row:l,DB:r,Fromdate:o,Todate:m})}}):(0,u.jsx)(O,{row:l,DB:r,Fromdate:o,Todate:m})},maxHeightOption:!0}),(0,u.jsxs)(_.c,{open:I,onClose:Y,maxWidth:"sm",fullWidth:!0,children:[(0,u.jsxs)(b.c,{children:[(0,u.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,u.jsx)("span",{children:"Filters"}),(0,u.jsxs)("span",{children:[(0,u.jsx)(d.c,{title:"Column Visiblity",children:(0,u.jsx)(s.c,{size:"small",onClick:()=>V(!0),children:(0,u.jsx)(S.c,{})})}),(0,u.jsx)(d.c,{title:"Clear Filters",children:(0,u.jsx)(s.c,{size:"small",onClick:()=>p({}),children:(0,u.jsx)(w.c,{})})})]})]}),(0,u.jsxs)("div",{className:"border rounded-3 ",children:[G.map(((e,l)=>{var a;return(0,u.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,u.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")}),q(e)]},l)})),(0,u.jsx)("br",{})]})]}),(0,u.jsx)(j.c,{children:(0,u.jsx)(f.c,{onClick:Y,color:"error",children:"close"})})]}),(0,u.jsxs)(_.c,{open:L,onClose:()=>V(!1),maxWidth:"lg",fullWidth:!0,children:[(0,u.jsx)(N.c,{children:"Column Settings"}),(0,u.jsx)(b.c,{children:(0,u.jsx)("div",{className:"row",children:Q.map(((e,l)=>(0,u.jsx)("div",{className:"col-lg-4 col-md-6 p-2",children:(0,u.jsxs)(t.c,{component:F.c,className:"p-2 d-flex justify-content-between align-items-center flex-wrap "+(l%2!==0?"bg-light":""),children:[(0,u.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap",children:[(0,u.jsx)(A.c,{checked:Boolean(null===e||void 0===e?void 0:e.isDefault)||Boolean(null===e||void 0===e?void 0:e.isVisible),disabled:Boolean(null===e||void 0===e?void 0:e.isDefault),onChange:l=>R((a=>a.map((a=>a.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?{...a,isVisible:l.target.checked?1:0}:a))))}),(0,u.jsx)("h6",{className:"fa-13 mb-0 fw-bold ",children:null===e||void 0===e?void 0:e.Field_Name})]}),(0,u.jsx)("input",{type:"number",value:(0,n.Q$)(null===e||void 0===e?void 0:e.OrderBy)?null===e||void 0===e?void 0:e.OrderBy:"",onChange:l=>R((a=>a.map((a=>a.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?{...a,OrderBy:l.target.value}:a)))),label:"Order Value",className:"mt-2 p-1 border-0 cus-inpt",style:{width:"80px"},placeholder:"Order"})]})},l)))})}),(0,u.jsxs)(j.c,{children:[(0,u.jsx)(f.c,{onClick:()=>R(E),variant:"outlined",children:"Reset"}),(0,u.jsx)(f.c,{onClick:()=>V(!1),color:"error",children:"close"})]})]})]})},L=e=>{let{loadingOn:l,loadingOff:a}=e;const o=JSON.parse(localStorage.getItem("user")),[c,h]=(0,i.useState)(null),[g,y]=(0,i.useState)({salesInfo:[],salesItemInfo:[]}),[_,b]=(0,i.useState)(null),[j,f]=(0,i.useState)({Fromdate:(0,n.SO)(1),Todate:(0,n.Q7)(),ReportType:"LedgerBased",filterDialog:!1,reload:!0});(0,i.useEffect)((()=>{h(null),b(null),y({salesInfo:[],salesItemInfo:[]}),(0,x.q)({address:`reports/salesReport/ledger?Fromdate=${null===j||void 0===j?void 0:j.Fromdate}&Todate=${null===j||void 0===j?void 0:j.Todate}`,headers:{Db:null===o||void 0===o?void 0:o.Company_id}}).then((e=>{let{success:l,data:a,others:i}=e;if(l){const{dataTypeInfo:e}=i;h(a),y((l=>({...l,salesInfo:Array.isArray(e)?e:[]})))}else h([])})).catch(console.error),(0,x.q)({address:`reports/salesReport/products?Fromdate=${null===j||void 0===j?void 0:j.Fromdate}&Todate=${null===j||void 0===j?void 0:j.Todate}`,headers:{Db:null===o||void 0===o?void 0:o.Company_id}}).then((e=>{if(e.success){var l;const{dataTypeInfo:a}=null===e||void 0===e?void 0:e.others,i=Array.isArray(null===e||void 0===e||null===(l=e.others)||void 0===l?void 0:l.LOSAbstract)?e.others.LOSAbstract.map((l=>({...l,StockTransaction:Array.isArray(e.data)?[...e.data].filter((e=>e.Stock_Group===l.Stock_Group)):[]}))):[];y((e=>({...e,salesItemInfo:Array.isArray(a)?a:[]}))),b(i)}else b([])})).catch((e=>console.error(e)))}),[j.reload]);const N=()=>{f((e=>({...e,filterDialog:!1})))},F=(0,n.Oe)(new Date(j.Fromdate),new Date(j.Todate));return(0,u.jsx)(i.Fragment,{children:(0,u.jsxs)(t.c,{className:"mt-3",children:[(0,u.jsxs)("div",{className:"px-3 py-2 d-flex justify-content-between align-items-center fw-bold text-dark",style:{backgroundColor:"#eae0cc"},children:[(0,u.jsx)("span",{children:null===o||void 0===o?void 0:o.Company_Name}),(0,u.jsx)("span",{children:(0,u.jsxs)("select",{value:j.ReportType,className:"cus-inpt ps-3 w-100 rounded-5 border-0",onChange:e=>f((l=>({...l,ReportType:e.target.value}))),children:[(0,u.jsx)("option",{value:"LedgerBased",children:"Ledger Based"}),(0,u.jsx)("option",{value:"ProductBased",children:"Product Based"})]})})]}),(0,u.jsxs)(r.c,{children:[(0,u.jsx)("div",{className:"mb-3",children:(0,u.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f((e=>({...e,reload:!e.reload})))},children:[(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5 me-1",value:j.Fromdate,onChange:e=>f((l=>({...l,Fromdate:e.target.value})))}),(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5",value:j.Todate,onChange:e=>f((l=>({...l,Todate:e.target.value})))}),(0,u.jsx)(d.c,{title:"Reload Data",children:(0,u.jsx)(s.c,{size:"small",className:"ms-2",type:"submit",children:(0,u.jsx)(p.c,{})})})]})}),null===c&&"LedgerBased"===j.ReportType&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Ledger Based data..."}),null===_&&("ProductBased"===j.ReportType||"ProductDayAverage"===j.ReportType)&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Product Based data..."}),"LedgerBased"===j.ReportType&&Array.isArray(c)&&(0,u.jsx)(B,{filterDialog:j.filterDialog,closeDialog:N,dataArray:c,colTypes:g.salesInfo,DB:null===o||void 0===o?void 0:o.Company_id,Fromdate:null===j||void 0===j?void 0:j.Fromdate,Todate:null===j||void 0===j?void 0:j.Todate,loadingOn:l,loadingOff:a}),"ProductBased"===j.ReportType&&Array.isArray(_)&&(0,u.jsx)(m,{filterDialog:j.filterDialog,closeDialog:N,dataArray:_,fromDate:j.Fromdate,toDate:j.Todate}),"ProductDayAverage"===j.ReportType&&Array.isArray(_)&&(0,u.jsx)(v,{filterDialog:j.filterDialog,closeDialog:N,dataArray:_,days:F})]})]})})}}}]);
//# sourceMappingURL=3676.6ad0d390.chunk.js.map