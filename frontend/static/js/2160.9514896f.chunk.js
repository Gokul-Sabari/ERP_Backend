"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[2160],{8364:(e,l,t)=>{t.r(l),t.d(l,{default:()=>N});var a=t(30800),o=t(69060),c=t(3358),d=t(5548),s=t(89e3),i=t(82656),r=t(26773),n=t(4488),u=t(90048),v=t(40656),h=t(62344),m=t(39308),p=t(91924),x=t(61988),b=t(57704),j=t(1908),g=t(13724),y=t(51560),C=t(82496);const T={Fromdate:(0,m.Q7)(),Todate:(0,m.Q7)()},N=e=>{let{loadingOn:l,loadingOff:t}=e;JSON.parse(localStorage.getItem("user"));const N=(0,y.i6)(),_=(0,y.IT)(),F=_.state,f=new URLSearchParams((0,y.IT)().search),[S,A]=(0,o.useState)([]),[R,w]=(0,o.useState)([]),[L,B]=(0,o.useState)([]),[D,k]=(0,o.useState)({}),[V,E]=(0,o.useState)(!1),[P,I]=(0,o.useState)([]),[Q,M]=(0,o.useState)([]),[G,O]=(0,o.useState)([]),[H,z]=(0,o.useState)(!1),[U,q]=(0,o.useState)(!1),[W,J]=(0,o.useState)({Fromdate:(0,m.Q7)(),Todate:(0,m.Q7)(),Retailer:{value:"",label:"ALL"},CollectionType:{value:"",label:"ALL"},CollectedBy:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:0}),[Y,K]=(0,o.useState)({filters:!1,orderDetails:!1});(0,o.useEffect)((()=>{var e,a,o,c;l&&l(),(0,j.q)({address:"reports/collectionReport?Fromdate=".concat(null===W||void 0===W?void 0:W.Fromdate,"&Todate=").concat(null===W||void 0===W?void 0:W.Todate,"&retailer_id=").concat(null===W||void 0===W||null===(e=W.Retailer)||void 0===e?void 0:e.value,"&collected_by=").concat(null===W||void 0===W||null===(a=W.CollectedBy)||void 0===a?void 0:a.value,"&collection_type=").concat(null===W||void 0===W||null===(o=W.CollectionType)||void 0===o?void 0:o.value,"&voucher_id=").concat(null===W||void 0===W||null===(c=W.VoucherType)||void 0===c?void 0:c.value,"&Cancel_status=").concat(null===W||void 0===W?void 0:W.Cancel_status)}).then((e=>{e.success&&A(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e))).finally((()=>{t&&t()}))}),[V]),(0,o.useEffect)((()=>{var e,a,o,c;U&&(l&&l(),(0,j.q)({address:"reports/cummulativeReport?Fromdate=".concat(null===W||void 0===W?void 0:W.Fromdate,"&Todate=").concat(null===W||void 0===W?void 0:W.Todate,"&retailer_id=").concat(null===W||void 0===W||null===(e=W.Retailer)||void 0===e?void 0:e.value,"&collected_by=").concat(null===W||void 0===W||null===(a=W.CollectedBy)||void 0===a?void 0:a.value,"&collection_type=").concat(null===W||void 0===W||null===(o=W.CollectionType)||void 0===o?void 0:o.value,"&voucher_id=").concat(null===W||void 0===W||null===(c=W.VoucherType)||void 0===c?void 0:c.value,"&Cancel_status=").concat(null===W||void 0===W?void 0:W.Cancel_status)}).then((e=>{e.success&&O(e.data)})).catch((e=>{console.error(e)})).finally((()=>{t&&t(),q(!1)})))}),[U]),(0,o.useEffect)((()=>{(0,j.q)({address:"receipt/filterValues"}).then((e=>{e.success&&e.others&&(B(e.others.voucherType||[]),w(e.others.retailers||[]),I(e.others.collectionType||[]),M(e.others.collectedBy||[]))})).catch((e=>{console.error("Failed to fetch filter values",e)}))}),[]),(0,o.useEffect)((()=>{const e={Fromdate:f.get("Fromdate")&&(0,m.e8)(f.get("Fromdate"))?f.get("Fromdate"):T.Fromdate,Todate:f.get("Todate")&&(0,m.e8)(f.get("Todate"))?f.get("Todate"):T.Todate};J((l=>(0,a.c)((0,a.c)({},l),{},{Fromdate:e.Fromdate,Todate:e.Todate})))}),[_.search]),(0,o.useEffect)((()=>{const e=null!==F&&void 0!==F&&F.Fromdate&&(0,m.e8)(null===F||void 0===F?void 0:F.Fromdate)?(0,m.Q7)(null===F||void 0===F?void 0:F.Fromdate):null,l=null!==F&&void 0!==F&&F.Todate&&(0,m.e8)(null===F||void 0===F?void 0:F.Todate)?(0,m.Q7)(null===F||void 0===F?void 0:F.Todate):null;e&&l&&(X({Fromdate:e,Todate:l}),J((e=>(0,a.c)((0,a.c)({},e),{},{Fromdate:(0,m.Q7)(F.Fromdate),Todate:F.Todate}))),E((e=>!e)))}),[F]);const X=e=>{const l=new URLSearchParams(e);N("?".concat(l.toString()),{replace:!0})},Z=()=>{K((0,a.c)((0,a.c)({},Y),{},{filters:!1,orderDetails:!1}))},$=(0,o.useMemo)((()=>S.reduce(((e,l)=>{const t=(l.Receipts||[]).reduce(((e,l)=>e+(l.collected_amount||0)),0);return(0,m.Q5)(e,t)}),0)),[S]);return(0,C.jsxs)(C.Fragment,{children:[H?(0,C.jsx)(g.cp,{title:"Collection Report",dataArray:S,EnableSerialNumber:!0,columns:[(0,g.A5)("RetailerGet","string","Retailer"),(0,g.A5)("collection_inv_no","string","collection_inv_no"),{ColumnHeader:"CollectionDate",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=l.collection_date;let a="Undefined";if(t){const e=new Date(t);isNaN(e)||(a="".concat(e.getDate().toString().padStart(2,"0"),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getFullYear()))}return(0,C.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 ".concat(t?"bg-success text-white":"bg-secondary text-white"),children:a})}},{ColumnHeader:"Receipts",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=(l.Receipts||[]).reduce(((e,l)=>e+(l.collected_amount||0)),0);return(0,C.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 ".concat(t?"bg-success text-white":"bg-secondary text-white"),children:t||"Undefined"})}},(0,g.A5)("CollectedByGet","string","Collected_By"),(0,g.A5)("collection_type","string","Collection_Type")],ButtonArea:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(c.c,{title:"Filters",children:(0,C.jsx)(d.c,{size:"small",onClick:()=>K((0,a.c)((0,a.c)({},Y),{},{filters:!0})),children:(0,C.jsx)(x.c,{})})}),Number($)>0&&(0,C.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",$]}),(0,C.jsx)(s.c,{onClick:()=>{z(!1),q(!1)},children:"Cummulative Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.Receipts||[];return(0,C.jsx)(C.Fragment,{children:0===t.length?(0,C.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map(((e,l)=>(0,C.jsx)("table",{className:"table mb-3",children:(0,C.jsxs)("tbody",{children:[(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Do_Inv_No"}),(0,C.jsx)("td",{className:"border p-2",children:e.Do_Inv_No}),(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Do_Date"}),(0,C.jsx)("td",{className:"border p-2",children:e.Do_Date}),(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Total Invoice Value"}),(0,C.jsx)("td",{className:"border p-2",children:e.Total_Invoice_value})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Collected Amount"}),(0,C.jsx)("td",{className:"border p-2",children:e.collected_amount}),(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Bill Amount"}),(0,C.jsx)("td",{className:"border p-2",children:e.bill_amount}),(0,C.jsx)("td",{className:"border p-2 bg-light",children:"Total Receipt Amount"}),(0,C.jsx)("td",{className:"border p-2",children:e.total_receipt_amount})]})]})},l)))})}}):(0,C.jsx)(g.cp,{title:"Cummulative Report",dataArray:G,EnableSerialNumber:!0,columns:[(0,g.A5)("collection_type","string","collection_type"),(0,g.A5)("total_collected","string","total_collected")],ButtonArea:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(c.c,{title:"Filters",children:(0,C.jsx)(d.c,{size:"small",onClick:()=>K((0,a.c)((0,a.c)({},Y),{},{filters:!0})),children:(0,C.jsx)(x.c,{})})}),Number($)>0&&(0,C.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",$]}),(0,C.jsx)(s.c,{onClick:()=>{z(!0),q(!0)},children:"Collection Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.retailers||[];return(0,C.jsx)(C.Fragment,{children:0===t.length?(0,C.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map(((e,l)=>(0,C.jsx)("table",{className:"table mb-3",children:(0,C.jsx)("tbody",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"collection_inv_no"}),(0,C.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.collection_inv_no}),(0,C.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"RetailerGet"}),(0,C.jsx)("td",{className:"border p-2",style:{width:"250px"},children:e.RetailerGet}),(0,C.jsx)("td",{className:"border p-2 bg-light",style:{width:"180px"},children:"CollectedByGet"}),(0,C.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.CollectedByGet})]})})},l)))})}}),Object.keys(D).length>0&&(0,C.jsx)(p.c,{orderDetails:null===D||void 0===D?void 0:D.orderDetails,orderProducts:null===D||void 0===D?void 0:D.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>k({}),TitleText:"Sale Order"}),(0,C.jsxs)(i.c,{open:Y.filters,onClose:Z,fullWidth:!0,maxWidth:"sm",children:[(0,C.jsx)(r.c,{children:"Filters"}),(0,C.jsx)(n.c,{children:(0,C.jsx)("div",{className:"table-responsive pb-4",children:(0,C.jsx)("table",{className:"table",children:(0,C.jsxs)("tbody",{children:[(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,C.jsx)("td",{children:(0,C.jsx)("input",{type:"date",value:W.Fromdate,onChange:e=>J((0,a.c)((0,a.c)({},W),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,C.jsx)("td",{children:(0,C.jsx)("input",{type:"date",value:W.Todate,onChange:e=>J((0,a.c)((0,a.c)({},W),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,C.jsx)("td",{children:(0,C.jsx)(v.cp,{value:null===W||void 0===W?void 0:W.Retailer,onChange:e=>J((0,a.c)((0,a.c)({},W),{},{Retailer:e})),options:[{value:"",label:"ALL"},...R.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:h.cF,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected By"}),(0,C.jsx)("td",{children:(0,C.jsx)(v.cp,{value:null===W||void 0===W?void 0:W.CollectedBy,onChange:e=>J((l=>(0,a.c)((0,a.c)({},W),{},{CollectedBy:e}))),options:[{value:"",label:"ALL"},...Q.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:h.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected Type"}),(0,C.jsx)("td",{children:(0,C.jsx)(v.cp,{value:null===W||void 0===W?void 0:W.CollectionType,onChange:e=>J((l=>(0,a.c)((0,a.c)({},W),{},{CollectionType:e}))),options:[{value:"",label:"ALL"},...P.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:h.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,C.jsx)("td",{children:(0,C.jsx)(v.cp,{value:null===W||void 0===W?void 0:W.VoucherType,onChange:e=>J((0,a.c)((0,a.c)({},W),{},{VoucherType:e})),options:[{value:"",label:"ALL"},...L.filter((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:h.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name"})})]})]})})})}),(0,C.jsxs)(u.c,{children:[(0,C.jsx)(s.c,{onClick:Z,children:"close"}),(0,C.jsx)(s.c,{onClick:()=>{Z();const e={Fromdate:null===W||void 0===W?void 0:W.Fromdate,Todate:null===W||void 0===W?void 0:W.Todate};X(e),E((e=>!e)),q(!0)},startIcon:(0,C.jsx)(b.c,{}),variant:"outlined",children:"Search"})]})]})]})}},14499:(e,l,t)=>{t.d(l,{c:()=>c});var a=t(27664),o=t(82496);const c=(0,a.c)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},61988:(e,l,t)=>{t.d(l,{c:()=>c});var a=t(27664),o=t(82496);const c=(0,a.c)((0,o.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},57704:(e,l,t)=>{t.d(l,{c:()=>c});var a=t(27664),o=t(82496);const c=(0,a.c)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=2160.9514896f.chunk.js.map