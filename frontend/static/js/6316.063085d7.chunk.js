"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[6316,3692],{64568:(e,l,s)=>{s.d(l,{c:()=>t});var a=s(82496);const t=()=>(0,a.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},86316:(e,l,s)=>{s.r(l),s.d(l,{default:()=>C});var a=s(30800),t=s(43692),d=s(89e3),o=s(84436),i=s(39308),c=s(1908),r=s(40656),n=s(69060),u=s(51560);const v=(0,i.gV)().user,h={collection_id:"",collection_inv_no:"",voucher_id:"",collection_no:"",year_id:"",retailer_id:"",payed_by:"",collection_date:(0,i.Q7)(),collection_type:"CASH",payment_status:"",latitude:"",longitude:"",collected_by:"",total_amount:0,created_on:"",alterd_on:"",narration:"",verify_status:0,bank_date:"",created_by:v.UserId,updated_by:v.UserId,verified_by:v.UserId,verified_at:""},m={auto_id:"",collection_id:"",bill_id:"",bill_amount:0,collected_amount:0};var p=s(82496);var x=s(56480),j=s(64568);const b=(0,s(27664).c)((0,p.jsx)("path",{d:"M2.81 2.81 1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20M7.94 5.12 6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.46-1.46C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12"}),"HideSource");var _=s(30796);const N=e=>{var l,s,t;let{row:o={},receiptsPaymentInfo:c=[],setReceiptsPaymentInfo:r,Sno:u}=e;const[v,h]=(0,n.useState)(!1),[x,N]=(0,n.useState)(!1),y=(0,n.useMemo)((()=>{const e=c.find((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===o||void 0===o?void 0:o.Do_Id)));return(0,i.CY)(e)?e:{}}),[c,o]),C=(0,n.useMemo)((()=>c.findIndex((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===o||void 0===o?void 0:o.Do_Id)))),[c,o]),g=(e,l)=>{r((s=>{const t=[...s];if(-1===C){const s=(0,a.c)({},m);return s.bill_id=null===o||void 0===o?void 0:o.Do_Id,s.bill_amount=(0,i.gH)(null===o||void 0===o?void 0:o.Total_Invoice_value),s[e]=l,[...t,s]}return t[C][e]=l,t}))},f=(0,n.useMemo)((()=>{var e;return Array.isArray(null===o||void 0===o?void 0:o.Payments)?null===o||void 0===o||null===(e=o.Payments)||void 0===e?void 0:e.reduce(((e,l)=>(0,i.Q5)(e,l.collected_amount)),0):0}),[o]),S=(0,i.Q$)(null===y||void 0===y?void 0:y.bill_id);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"border",children:u}),(0,p.jsx)("td",{className:"border",children:(0,p.jsx)("div",{children:(0,p.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:S,onChange:()=>{S?r((e=>e.filter((e=>!(0,i.Qr)(e.bill_id,null===o||void 0===o?void 0:o.Do_Id))))):g("bill_amount",(0,i.gH)(null===o||void 0===o?void 0:o.Total_Invoice_value))}})})}),(0,p.jsx)("td",{className:"border",children:null===o||void 0===o?void 0:o.Do_Inv_No}),(0,p.jsx)("td",{className:"border",children:(0,i.uy)(null===o||void 0===o?void 0:o.Do_Date)}),(0,p.jsx)("td",{className:"border",children:(0,i.gH)(null===o||void 0===o?void 0:o.Total_Invoice_value)}),(0,p.jsx)("td",{className:"border",children:f}),(0,p.jsx)("td",{className:"border",children:null===o||void 0===o?void 0:o.pendingAmount}),(0,p.jsx)("td",{className:"border",children:(0,i.gH)(null===o||void 0===o||null===(l=o.Payments)||void 0===l?void 0:l.length)})]}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,children:(0,p.jsxs)("div",{className:"d-flex align-items-end flex-wrap",children:[(0,p.jsxs)("div",{className:"flex-grow-1",children:[(0,p.jsxs)("label",{className:"fa-14 w-100",children:["Receipt Amount (\u20b9)",S&&(0,p.jsx)(j.c,{})]}),(0,p.jsx)("input",{onInput:i.Gk,disabled:!S,value:null!==y&&void 0!==y&&y.collected_amount?(0,i.gH)(null===y||void 0===y?void 0:y.collected_amount):"",onChange:e=>g("collected_amount",e.target.value),style:{width:"100%",maxWidth:"350px"},className:"cus-inpt border p-2",placeholder:"Enter Receipt Amount",max:(0,i.gH)(null===o||void 0===o?void 0:o.pendingAmount),required:S})]}),(0,p.jsxs)(d.c,{startIcon:x?(0,p.jsx)(b,{}):(0,p.jsx)(_.c,{}),onClick:()=>N((e=>!e)),children:[x?"Hide":"Show"," Invoice"]}),(0,p.jsxs)(d.c,{startIcon:v?(0,p.jsx)(b,{}):(0,p.jsx)(_.c,{}),onClick:()=>h((e=>!e)),disabled:!Array.isArray(null===o||void 0===o?void 0:o.Payments)||0===(0,i.gH)(null===o||void 0===o||null===(s=o.Payments)||void 0===s?void 0:s.length),children:[v?"Hide":"Previous"," Receipts"]})]})})}),x&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{colSpan:8,children:["Bill Details of - ",null===o||void 0===o?void 0:o.Do_Inv_No]})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"p-0",children:(0,p.jsx)("div",{className:"table-responsive fa-13 m-0",children:(0,p.jsxs)("table",{className:"table m-0",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["SNo","Item","Quantity","Rate","Pack","Tax","Amount"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light",children:e},l)))})}),(0,p.jsx)("tbody",{children:Array.isArray(null===o||void 0===o?void 0:o.Products_List)&&o.Products_List.map(((e,l)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:l+1}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.UOM}),(0,p.jsx)("td",{children:(0,i.Q5)(null===e||void 0===e?void 0:e.Cgst_Amo,null===e||void 0===e?void 0:e.Sgst_Amo)||(0,i.gH)(null===e||void 0===e?void 0:e.Igst_Amo)}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount})]},l)))})]})})})})]}),v&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{colSpan:8,children:["Previous Receipts of - ",null===o||void 0===o?void 0:o.Do_Inv_No]})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"p-0 border-0",children:(0,p.jsx)("div",{className:"table-responsive fa-13",children:(0,p.jsxs)("table",{className:"table m-0",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["SNo","Collected By","Amount","Date","Receipt Type","payment_status","Verify Status"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light border",children:e},l)))})}),(0,p.jsx)("tbody",{children:null===(t=Array.isArray(null===o||void 0===o?void 0:o.Payments)?null===o||void 0===o?void 0:o.Payments:[])||void 0===t?void 0:t.filter((e=>!(0,i.Qr)(e.auto_id,null===o||void 0===o?void 0:o.auto_id))).map(((e,l)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"border",children:l+1}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.CreatedByGet}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collected_amount}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_date}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.verify_status})]},l)))})]})})})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"border-0"})})]})]})},y=[{type:"CASH",default:"CREATED-CASH",statusOptions:["CREATED-CASH","CASH-PROCESSING","CASH-MISSING"]},{type:"UPI",default:"CREATED-UPI",statusOptions:["CREATED-UPI","UPI-PROCESSING","UPI-NOT-RECEIVED"]},{type:"CHECK",default:"CREATED-CHECK",statusOptions:["CREATED-CHECK","CHECK-PROCESSING","CHECK-BOUNCE"]},{type:"BANK ACCOUNT",default:"CREATED-BANK-TRANSFER",statusOptions:["CREATED-BANK-TRANSFER","BANK-PROCESSING","BANK-NOT-RECEIVED"]}],C=e=>{let{loadingOn:l,loadingOff:s}=e;(0,i.gV)().user;const v=(0,u.i6)(),[m,b]=((0,u.IT)().state,new URLSearchParams((0,u.IT)().search),(0,n.useState)([])),[_,C]=(0,n.useState)([]),[g,f]=(0,n.useState)({salesPerson:[],voucherData:[]}),[S,R]=(0,n.useState)(h),[A,I]=(0,n.useState)([]),[P,E]=(0,n.useState)({Fromdate:(0,i.Q7)(),Todate:(0,i.Q7)(),Retailer:{value:"",label:"Search by Retailer..."}}),H=y.find((e=>e.type===(null===S||void 0===S?void 0:S.collection_type))).statusOptions;(0,n.useEffect)((()=>{(0,c.q)({address:"receipt/getRetailersWhoHasBills"}).then((e=>{e.success?C(e.data):C([])})).catch((e=>console.error(e))),(0,c.q)({address:"masters/users/salesPerson/dropDown"}).then((e=>{e.success?f((l=>(0,a.c)((0,a.c)({},l),{},{salesPerson:e.data}))):f((e=>(0,a.c)((0,a.c)({},e),{},{salesPerson:[]})))})).catch((e=>console.error(e))),(0,c.q)({address:"masters/voucher"}).then((e=>{e.success?f((l=>(0,a.c)((0,a.c)({},l),{},{voucherData:e.data}))):f((e=>(0,a.c)((0,a.c)({},e),{},{voucherData:[]})))})).catch((e=>console.error(e)))}),[]),(0,n.useEffect)((()=>{(0,i.Q$)(S.retailer_id)&&(l&&l(),(0,c.q)({address:"receipt/retailerBills?retailer_id=".concat(S.retailer_id)}).then((e=>{e.success?b(e.data):b([])})).catch((e=>console.error(e))).finally((()=>{s&&s()})))}),[S.retailer_id]);const D=()=>{l&&l(),(0,c.q)({address:"receipt/collectionReceipts",method:(0,i.Q$)(S.collection_id)&&S.collection_id>0?"PUT":"POST",bodyData:(0,a.c)((0,a.c)({},S),{},{Collections:A})}).then((e=>{e.success?(x.m4.success((null===e||void 0===e?void 0:e.message)||"Receipt Created"),E((e=>(0,a.c)((0,a.c)({},e),{},{Retailer:{value:"",label:"Search by Retailer..."}}))),R(h),I([]),b([])):x.m4.error((null===e||void 0===e?void 0:e.message)||"Failed to create Receipt")})).catch((e=>console.error(e))).finally((()=>{s&&s()}))};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(t.c,{children:(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),D()},children:[(0,p.jsxs)("div",{className:"px-3 py-2 d-flex align-items-center",children:[(0,p.jsx)("h5",{className:"m-0 flex-grow-1",children:"Receipt Creation"}),(0,p.jsx)(d.c,{variant:"outlined",type:"button",className:"me-1",onClick:()=>v("/erp/receipts/listReceipts"),children:"Back"}),(0,p.jsx)(d.c,{variant:"outlined",type:"submit",disabled:0===A.length||A.every((e=>(0,i.gH)(e.collected_amount)<=0)),children:"save receipt"})]}),(0,p.jsxs)(o.c,{children:[(0,p.jsx)("label",{children:"Retailer"}),(0,p.jsx)("div",{className:"d-flex",children:(0,p.jsx)("div",{style:{width:"100%",maxWidth:"400px"},children:(0,p.jsx)(r.cp,{menuPortalTarget:document.body,options:[{value:"",label:"select",isDisabled:!0},..._.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],value:P.Retailer,menu:!0,onChange:e=>{E((l=>(0,a.c)((0,a.c)({},l),{},{Retailer:e}))),R((l=>(0,a.c)((0,a.c)({},l),{},{retailer_id:e.value})))},placeholder:"Search by Retailer"})})}),(0,p.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Date",(0,p.jsx)(j.c,{})]}),(0,p.jsx)("input",{type:"date",className:"cus-inpt border p-2",value:S.collection_date,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{collection_date:e.target.value}))),required:!0})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Payment Type",(0,p.jsx)(j.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.collection_type,required:!0,onChange:e=>R((l=>{var s;return(0,a.c)((0,a.c)({},l),{},{collection_type:e.target.value,payment_status:null===(s=y.find((l=>l.type===e.target.value)))||void 0===s?void 0:s.default})})),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,p.jsx)("option",{value:"CASH",children:"CASH"}),(0,p.jsx)("option",{value:"UPI",children:"UPI"}),(0,p.jsx)("option",{value:"CHECK",children:"CHECK"}),(0,p.jsx)("option",{value:"BANK ACCOUNT",children:"BANK ACCOUNT"})]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Payment Status",(0,p.jsx)(j.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.payment_status,required:!0,disabled:!S.collection_type,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{payment_status:e.target.value}))),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),H.map(((e,l)=>(0,p.jsx)("option",{value:e,children:e},l))),(0,p.jsx)("option",{value:"Completed",children:"Completed"})]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsx)("label",{children:"Payed By"}),(0,p.jsx)("input",{className:"cus-inpt border p-2",value:S.payed_by,placeholder:"Owner, Shop Keeper..",onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{payed_by:e.target.value})))})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Voucher",(0,p.jsx)(j.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.voucher_id,required:!0,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{voucher_id:e.target.value}))),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),g.voucherData.map(((e,l)=>(0,p.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Amount Received By",(0,p.jsx)(j.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.collected_by,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{collected_by:e.target.value}))),required:!0,children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),g.salesPerson.map(((e,l)=>(0,p.jsx)("option",{value:e.UserId,children:e.Name},l)))]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,p.jsx)("label",{className:"fa-14",children:"Verify Date"}),(0,p.jsx)("input",{type:"date",value:null!==S&&void 0!==S&&S.bank_date?null===S||void 0===S?void 0:S.bank_date:"",onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{bank_date:e.target.value}))),className:"cus-inpt border border p-2"})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,p.jsx)("label",{className:"fa-14",children:"Verify Status"}),(0,p.jsxs)("select",{value:null===S||void 0===S?void 0:S.verify_status,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{verify_status:e.target.value}))),className:"cus-inpt border border p-2",children:[(0,p.jsx)("option",{value:0,children:"Not-verified"}),(0,p.jsx)("option",{value:1,children:"verified"})]})]}),(0,p.jsxs)("div",{className:"col-12 p-1",children:[(0,p.jsx)("label",{className:"fa-14 w-100",children:"Narration"}),(0,p.jsx)("textarea",{style:{width:"100%",maxWidth:"450px"},className:"cus-inpt border p-2",value:null===S||void 0===S?void 0:S.narration,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{narration:e.target.value}))),placeholder:"Narration..."})]})]}),(0,p.jsx)("div",{className:"table-responsive",children:(0,p.jsxs)("table",{className:"table table-bordered",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["Sno","#","Invoice No","Date","Invoice Value","Paid","Pending","Receipts"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light fa-13 border",children:e},l)))})}),(0,p.jsx)("tbody",{children:m.map(((e,l)=>(0,p.jsx)(N,{row:e,Sno:l+1,receiptsPaymentInfo:A,setReceiptsPaymentInfo:I},l)))})]})})]})]})})})}},30796:(e,l,s)=>{s.d(l,{c:()=>d});var a=s(27664),t=s(82496);const d=(0,a.c)((0,t.jsx)("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List")},84436:(e,l,s)=>{s.d(l,{c:()=>x});var a=s(45072),t=s(95656),d=s(69060),o=s(79736),i=s(21412),c=s(12556),r=s(49836),n=s(10099),u=s(33448);function v(e){return(0,u.cp)("MuiCardContent",e)}(0,n.c)("MuiCardContent",["root"]);var h=s(82496);const m=["className","component"],p=(0,c.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=d.forwardRef((function(e,l){const s=(0,r.C)({props:e,name:"MuiCardContent"}),{className:d,component:c="div"}=s,n=(0,t.c)(s,m),u=(0,a.c)({},s,{component:c}),x=(e=>{const{classes:l}=e;return(0,i.c)({root:["root"]},v,l)})(u);return(0,h.jsx)(p,(0,a.c)({as:c,className:(0,o.c)(x.root,d),ownerState:u,ref:l},n))}))},43692:(e,l,s)=>{s.d(l,{c:()=>j});var a=s(45072),t=s(95656),d=s(69060),o=s(79736),i=s(21412),c=s(12556),r=s(49836),n=s(85624),u=s(10099),v=s(33448);function h(e){return(0,v.cp)("MuiCard",e)}(0,u.c)("MuiCard",["root"]);var m=s(82496);const p=["className","raised"],x=(0,c.cp)(n.c,{name:"MuiCard",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({overflow:"hidden"}))),j=d.forwardRef((function(e,l){const s=(0,r.C)({props:e,name:"MuiCard"}),{className:d,raised:c=!1}=s,n=(0,t.c)(s,p),u=(0,a.c)({},s,{raised:c}),v=(e=>{const{classes:l}=e;return(0,i.c)({root:["root"]},h,l)})(u);return(0,m.jsx)(x,(0,a.c)({className:(0,o.c)(v.root,d),elevation:c?8:void 0,ref:l,ownerState:u},n))}))}}]);
//# sourceMappingURL=6316.063085d7.chunk.js.map