"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[3028],{23028:(e,c,t)=>{t.r(c),t.d(c,{default:()=>V});var n=t(69060),a=t(12572),l=t(85624),r=t(5548),s=t(56880),o=t(60476),i=t(99904),d=t(33856),h=t(58612),u=t(27454),x=t(96464),m=t(29504),p=t(3358),v=t(82656),j=t(26773),g=t(4488),f=t(44380),N=t(71448),C=t(90048),b=t(89e3),y=t(63468),D=t(22727),w=t(99768),_=t(27664),A=t(82496);const L=(0,_.c)((0,A.jsx)("path",{d:"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z"}),"AccountTree"),S=(0,_.c)((0,A.jsx)("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"}),"AccountBalance");var z=t(68256),k=t(56084),M=t(37956),F=t(1908);const I=e=>{var c,t;let n=0,a=0;return null!==(c=e.accounts)&&void 0!==c&&c.length&&e.accounts.forEach((e=>{n+=Number(e.Debit_Amount||0),a+=Number(e.Credit_Amount||0)})),null!==(t=e.children)&&void 0!==t&&t.length&&e.children.forEach((e=>{const c=I(e);n+=c.debit,a+=c.credit})),{debit:n,credit:a,balance:n-a}},E=e=>{var c,t;let{node:p,depth:v=0}=e;const[j,g]=(0,n.useState)(0===v),f=I(p),N=(null===(c=p.children)||void 0===c?void 0:c.length)>0,C=(null===(t=p.accounts)||void 0===t?void 0:t.length)>0;return(0,A.jsx)(a.c,{sx:{ml:2*v},children:(0,A.jsxs)(l.c,{sx:{mb:1,p:1,backgroundColor:0===v?"#f5f5f5":"white"},children:[(0,A.jsxs)(a.c,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{cursor:N||C?"pointer":"default"},onClick:()=>(N||C)&&g(!j),children:[(0,A.jsxs)(a.c,{display:"flex",alignItems:"center",children:[(N||C)&&(0,A.jsx)(r.c,{size:"small",sx:{mr:1},children:j?(0,A.jsx)(D.c,{}):(0,A.jsx)(w.c,{})}),N?(0,A.jsx)(L,{color:"primary",sx:{mr:1}}):(0,A.jsx)(S,{color:"secondary",sx:{mr:1}}),(0,A.jsx)(s.c,{fontWeight:"medium",children:p.group_name})]}),(0,A.jsxs)(a.c,{display:"flex",gap:3,sx:{mr:2},children:[(0,A.jsxs)(s.c,{variant:"body2",children:["Debit: ",f.debit.toFixed(2)]}),(0,A.jsxs)(s.c,{variant:"body2",children:["Credit: ",f.credit.toFixed(2)]}),(0,A.jsxs)(s.c,{variant:"body2",sx:{fontWeight:"bold",color:f.balance>=0?"green":"red"},children:["Balance: ",f.balance.toFixed(2)]})]})]}),(0,A.jsxs)(o.c,{in:j,children:[C&&(0,A.jsx)(i.c,{sx:{mt:1,mb:1},children:(0,A.jsxs)(d.c,{size:"small",children:[(0,A.jsx)(h.c,{children:(0,A.jsxs)(u.c,{sx:{backgroundColor:"#eeeeee"},children:[(0,A.jsx)(x.c,{children:"Account"}),(0,A.jsx)(x.c,{align:"right",children:"Debit"}),(0,A.jsx)(x.c,{align:"right",children:"Credit"}),(0,A.jsx)(x.c,{align:"right",children:"Balance"})]})}),(0,A.jsx)(m.c,{children:p.accounts.map((e=>{var c,t;return(0,A.jsxs)(u.c,{children:[(0,A.jsx)(x.c,{children:(0,A.jsxs)(a.c,{display:"flex",alignItems:"center",children:[(0,A.jsx)(z.c,{fontSize:"small",sx:{mr:1}}),e.Account_Name]})}),(0,A.jsx)(x.c,{align:"right",children:(null===(c=e.Debit_Amount)||void 0===c?void 0:c.toFixed(2))||"0.00"}),(0,A.jsx)(x.c,{align:"right",children:(null===(t=e.Credit_Amount)||void 0===t?void 0:t.toFixed(2))||"0.00"}),(0,A.jsx)(x.c,{align:"right",children:((e.Debit_Amount||0)-(e.Credit_Amount||0)).toFixed(2)})]},e.Acc_Id)}))})]})}),N&&(0,A.jsx)(a.c,{children:p.children.map((e=>(0,A.jsx)(E,{node:e,depth:v+1},e.group_id)))})]})]})})},V=()=>{const e=(new Date).toISOString().split("T")[0],[c,t]=(0,n.useState)([]),[o,i]=(0,n.useState)([]),[d,h]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[m,D]=(0,n.useState)({accountNames:[]}),[w,_]=(0,n.useState)({fromDate:e,toDate:e,accountName:null});(0,n.useEffect)((()=>{if(o.length>0){const e=new Set,c=new Set,t=(new Set,n=>{n.forEach((n=>{var a,l;n.group_name&&e.add(n.group_name),null!==(a=n.accounts)&&void 0!==a&&a.length&&n.accounts.forEach((e=>{e.Account_Name&&c.add(e.Account_Name)})),null!==(l=n.children)&&void 0!==l&&l.length&&t(n.children)}))});t(o),D({accountNames:Array.from(c)})}}),[o]);const L=e=>e?e.reduce(((e,c)=>{var t,n,a,l,r;const s={...c};null!==(t=s.accounts)&&void 0!==t&&t.length&&(s.accounts=s.accounts.filter((e=>{var c,t,n;return!(w.accountName&&(null===(c=e.Account_Name)||void 0===c||!c.toLowerCase().includes(w.accountName.toLowerCase())))&&!!(!w.ledgerName||null!==(t=e.Debit_Ledger_Name)&&void 0!==t&&t.toLowerCase().includes(w.ledgerName.toLowerCase())||null!==(n=e.Credit_Ledger_Name)&&void 0!==n&&n.toLowerCase().includes(w.ledgerName.toLowerCase()))}))),null!==(n=s.children)&&void 0!==n&&n.length&&(s.children=L(s.children));const o=!w.groupName||(null===(a=s.group_name)||void 0===a?void 0:a.toLowerCase().includes(w.groupName.toLowerCase())),i=(null===(l=s.accounts)||void 0===l?void 0:l.length)>0,d=(null===(r=s.children)||void 0===r?void 0:r.length)>0;return o&&(i||d)&&e.push(s),e}),[]):[];return(0,n.useEffect)((()=>{(async()=>{try{h(!0);const e=new URLSearchParams({fromDate:w.fromDate,toDate:w.toDate}).toString(),c=(await(0,F.q)({address:`/reports/expenseReport?${e}`})).data||[];i(c),t(c),x(!1)}catch(e){console.error("Error fetching expenses:",e)}finally{h(!1)}})()}),[w.fromDate,w.toDate]),(0,A.jsxs)(a.c,{sx:{p:3},children:[(0,A.jsxs)(a.c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,A.jsx)(s.c,{variant:"h5",children:"Expense Hierarchy"}),(0,A.jsxs)(a.c,{children:[(0,A.jsx)(p.c,{title:"Reset filters",children:(0,A.jsx)(r.c,{onClick:()=>{_({fromDate:e,toDate:e,groupName:null,accountName:null,ledgerName:null}),t(o)},sx:{mr:1},children:(0,A.jsx)(k.c,{})})}),(0,A.jsx)(p.c,{title:"Filter options",children:(0,A.jsx)(r.c,{color:"primary",onClick:()=>x(!0),sx:{backgroundColor:"rgba(25, 118, 210, 0.04)"},children:(0,A.jsx)(M.c,{})})})]})]}),(0,A.jsxs)(v.c,{open:u,onClose:()=>x(!1),maxWidth:"sm",fullWidth:!0,children:[(0,A.jsx)(j.c,{children:"Filter Options"}),(0,A.jsx)(g.c,{children:(0,A.jsxs)(a.c,{display:"flex",flexDirection:"column",gap:2,sx:{pt:2},children:[(0,A.jsx)(f.c,{type:"date",label:"From Date",value:w.fromDate,onChange:e=>_({...w,fromDate:e.target.value}),InputLabelProps:{shrink:!0},fullWidth:!0}),(0,A.jsx)(f.c,{type:"date",label:"To Date",value:w.toDate,onChange:e=>_({...w,toDate:e.target.value}),InputLabelProps:{shrink:!0},fullWidth:!0}),(0,A.jsx)(N.c,{options:m.accountNames,value:w.accountName,onChange:(e,c)=>_({...w,accountName:c}),renderInput:e=>(0,A.jsx)(f.c,{...e,label:"Account Name",fullWidth:!0}),freeSolo:!0})]})}),(0,A.jsxs)(C.c,{children:[(0,A.jsx)(b.c,{onClick:()=>x(!1),children:"Cancel"}),(0,A.jsx)(b.c,{variant:"contained",onClick:()=>{if(w.groupName||w.accountName||w.ledgerName){const e=L(JSON.parse(JSON.stringify(o)));t(e)}else t(o);x(!1)},disabled:d,children:"Apply Filters"})]})]}),d?(0,A.jsx)(a.c,{display:"flex",justifyContent:"center",p:4,children:(0,A.jsx)(y.c,{})}):0===c.length?(0,A.jsx)(l.c,{sx:{p:2,textAlign:"center"},children:(0,A.jsx)(s.c,{children:"No expense data available"})}):c.map((e=>(0,A.jsx)(E,{node:e},e.group_id)))]})}},68256:(e,c,t)=>{t.d(c,{c:()=>l});var n=t(27664),a=t(82496);const l=(0,n.c)((0,a.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney")},56084:(e,c,t)=>{t.d(c,{c:()=>l});var n=t(27664),a=t(82496);const l=(0,n.c)((0,a.jsx)("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll")},22727:(e,c,t)=>{t.d(c,{c:()=>l});var n=t(27664),a=t(82496);const l=(0,n.c)((0,a.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")},99768:(e,c,t)=>{t.d(c,{c:()=>l});var n=t(27664),a=t(82496);const l=(0,n.c)((0,a.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore")},37956:(e,c,t)=>{t.d(c,{c:()=>l});var n=t(27664),a=t(82496);const l=(0,n.c)((0,a.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList")},12572:(e,c,t)=>{t.d(c,{c:()=>i});var n=t(0),a=t(31152),l=t(46712),r=t(83068);const s=(0,t(10099).c)("MuiBox",["root"]),o=(0,l.c)(),i=(0,n.c)({themeId:r.c,defaultTheme:o,defaultClassName:s.root,generateClassName:a.c.generate})},0:(e,c,t)=>{t.d(c,{c:()=>x});var n=t(45072),a=t(95656),l=t(69060),r=t(79736),s=t(7592),o=t(6868),i=t(47100),d=t(47664),h=t(82496);const u=["className","component"];function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:c,defaultTheme:t,defaultClassName:x="MuiBox-root",generateClassName:m}=e,p=(0,s.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(o.c);return l.forwardRef((function(e,l){const s=(0,d.c)(t),o=(0,i.c)(e),{className:v,component:j="div"}=o,g=(0,a.c)(o,u);return(0,h.jsx)(p,(0,n.c)({as:j,ref:l,className:(0,r.c)(v,m?m(x):x),theme:c&&s[c]||s},g))}))}}}]);
//# sourceMappingURL=3028.7546e375.chunk.js.map