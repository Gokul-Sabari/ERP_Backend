"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[312],{20312:(e,a,l)=>{l.r(a),l.d(a,{default:()=>P});var t=l(30800),n=l(18256),i=l(29720),o=l(61584),r=l(5548),d=l(12572),s=l(15786),m=l(69060),c=l(39308),u=l(57704),_=l(1908),p=l(13724),v=l(71448),N=l(52924),x=l(44380),g=l(3358),y=l(82656),h=l(4488),b=l(90048),C=l(89e3),j=l(26773),f=l(43692),F=l(85624),D=l(78092),T=l(68424),w=l(39504),S=l(12120),O=l(74912),k=l(61988),B=l(82496);const Q=(0,B.jsx)(T.c,{fontSize:"small"}),E=(0,B.jsx)(w.c,{fontSize:"small"}),G=e=>{let{loadingOn:a,loadingOff:l,Fromdate:n,Todate:i,api:o="itemWise",defaultGrouping:d="",storageStockColumns:s=[],groupingOption:u=!0}=e;const[T,w]=(0,m.useState)([]),[G,A]=(0,m.useState)({}),[L,P]=(0,m.useState)(d),[z,I]=(0,m.useState)([]),[W,M]=(0,m.useState)(!1),[V,q]=(0,m.useState)(!1),[H,R]=(0,m.useState)([]),J=s.map(((e,a)=>({isVisible:a<11?1:0,Field_Name:null===e||void 0===e?void 0:e.Column_Name,Fied_Data:null===e||void 0===e?void 0:e.Data_Type,OrderBy:a+1,isEnabled:!0}))),[$,K]=(0,m.useState)(J),U=JSON.parse(localStorage.getItem("user")),X=null===U||void 0===U?void 0:U.Company_id;(0,m.useEffect)((()=>{a();const e=(0,_.q)({address:"reports/storageStock/".concat(o,"?Fromdate=").concat(n,"&Todate=").concat(i)}).then((e=>{e.success&&w((0,c.dq)(e.data))})),r=(0,_.q)({address:"masters/displayLosColumn?company_id=".concat(X)}).then((e=>{if(e.success){const a=(0,c.dq)(e.data);R(a),K((e=>e.map(((e,l)=>{const n=a.find((a=>{var l,t,n,i;return(null===(l=a.Column_Name)||void 0===l?void 0:l.toLowerCase())===(null===(t=e.Field_Name)||void 0===t?void 0:t.toLowerCase())||(null===(n=a.ColumnName)||void 0===n?void 0:n.toLowerCase())===(null===(i=e.Field_Name)||void 0===i?void 0:i.toLowerCase())})),i=Number(null===n||void 0===n?void 0:n.status),o=l<5;return(0,t.c)((0,t.c)({},e),{},{isEnabled:!!o||(!n||1===i),isVisible:o||n&&1===i?1:0})}))))}}));Promise.all([e,r]).catch((e=>console.error("Fetch error:",e))).finally((()=>l()))}),[n,i,X,o,a,l]);const Y=(0,m.useMemo)((()=>[...$].sort(((e,a)=>null!==e&&void 0!==e&&e.OrderBy&&null!==a&&void 0!==a&&a.OrderBy?(null===e||void 0===e?void 0:e.OrderBy)-(null===a||void 0===a?void 0:a.OrderBy):(null===a||void 0===a?void 0:a.OrderBy)-(null===e||void 0===e?void 0:e.OrderBy)))),[$]),Z=(0,m.useMemo)((()=>Y.filter((e=>((0,c.Qr)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,c.Qr)(null===e||void 0===e?void 0:e.isVisible,1))&&!0===e.isEnabled))),[Y]),ee=(0,m.useMemo)((()=>{const e=Object.keys(G).length>0,a=!!L,l=e?z:T,n=a?(0,c.ui)(l,L):[],i=Z.filter((e=>"number"===(0,c.MP)(e.Fied_Data))).map((e=>e.Field_Name)),o=n.map((e=>(0,t.c)((0,t.c)({},e),Object.fromEntries(i.map((a=>{var l;return[a,null===e||void 0===e||null===(l=e.groupedData)||void 0===l?void 0:l.reduce(((e,l)=>(0,c.Q5)(e,(0,c.gH)(l[a])||0)),0)]}))))));return a?o:l}),[G,T,z,L,Z]),ae=e=>{if(!e)return"";const a=H.find((a=>{var l,t;return(null===(l=a.Column_Name)||void 0===l?void 0:l.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())||(null===(t=a.ColumnName)||void 0===t?void 0:t.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())}));if(null!==a&&void 0!==a&&a.Alias_Name)return a.Alias_Name;const l=s.find((a=>{var l;return(null===(l=a.Column_Name)||void 0===l?void 0:l.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())}));return null!==l&&void 0!==l&&l.Alias_Name?l.Alias_Name:null===e||void 0===e?void 0:e.replace(/_/g," ")};(0,m.useEffect)((()=>{te()}),[G]);const le=(e,a)=>{A((l=>(0,t.c)((0,t.c)({},l),{},{[e]:a})))},te=()=>{let e=[...T];for(const l of Y)if(G[l.Field_Name])if("range"===G[l.Field_Name].type){const{min:a,max:t}=G[l.Field_Name];e=e.filter((e=>{const n=e[l.Field_Name];return(void 0===a||n>=a)&&(void 0===t||n<=t)}))}else if("date"===G[l.Field_Name].type){const{start:a,end:t}=G[l.Field_Name].value;e=e.filter((e=>{const n=new Date(e[l.Field_Name]);return(void 0===a||n>=new Date(a))&&(void 0===t||n<=new Date(t))}))}else if(Array.isArray(G[l.Field_Name])){var a;e=(null===(a=G[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter((e=>{var a;return G[l.Field_Name].includes(null===(a=e[l.Field_Name])||void 0===a?void 0:a.toLowerCase().trim())})):e}I(e)},ne=e=>{const{Field_Name:a,Fied_Data:l}=e;var n,i,o,r,d,s,m,c,u,_;if("number"===l)return(0,B.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(n=null===(i=G[a])||void 0===i?void 0:i.min)&&void 0!==n?n:"",onChange:e=>le(a,(0,t.c)((0,t.c)({type:"range"},G[a]),{},{min:e.target.value?parseFloat(e.target.value):void 0}))}),(0,B.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(o=null===(r=G[a])||void 0===r?void 0:r.max)&&void 0!==o?o:"",onChange:e=>le(a,(0,t.c)((0,t.c)({type:"range"},G[a]),{},{max:e.target.value?parseFloat(e.target.value):void 0}))})]});if("date"===l)return(0,B.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(d=null===(s=G[a])||void 0===s||null===(m=s.value)||void 0===m?void 0:m.start)&&void 0!==d?d:"",onChange:e=>{var l;return le(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=G[a])||void 0===l?void 0:l.value),{},{start:e.target.value||void 0})})}}),(0,B.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(c=null===(u=G[a])||void 0===u||null===(_=u.value)||void 0===_?void 0:_.end)&&void 0!==c?c:"",onChange:e=>{var l;return le(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=G[a])||void 0===l?void 0:l.value),{},{end:e.target.value||void 0})})}})]});if("string"===l){const e=[...new Set(T.map((e=>{var l,t;return null===(l=e[a])||void 0===l||null===(t=l.toLowerCase())||void 0===t?void 0:t.trim()})))];return(0,B.jsx)(v.c,{multiple:!0,id:"".concat(a,"-filter"),options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:G[a]||[],onChange:(e,l)=>le(a,l),renderOption:(e,a,l)=>{let{selected:n}=l;return(0,B.jsxs)("li",(0,t.c)((0,t.c)({},e),{},{children:[(0,B.jsx)(N.c,{icon:Q,checkedIcon:E,style:{marginRight:8},checked:n}),a]}))},isOptionEqualToValue:(e,a)=>e===a,renderInput:e=>(0,B.jsx)(x.c,(0,t.c)((0,t.c)({},e),{},{label:ae(a),placeholder:"Select ".concat(ae(a))}))})}},ie=()=>{M(!1),q(!1)};return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(p.cp,{title:"Item Wise",EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,maxHeightOption:!0,ButtonArea:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(g.c,{title:"Column Visibility",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>M(!0),children:(0,B.jsx)(S.c,{})})}),(0,B.jsx)(g.c,{title:"Clear Filters",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>A({}),children:(0,B.jsx)(O.c,{})})}),(0,B.jsx)(g.c,{title:"Filters",children:(0,B.jsx)(r.c,{onClick:()=>q(!0),size:"small",children:(0,B.jsx)(k.c,{})})}),u&&(0,B.jsxs)("div",{className:"d-flex align-items-center flex-wrap",children:[(0,B.jsx)("span",{children:"Group-By: "}),(0,B.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:L,onChange:e=>P(e.target.value),children:[(0,B.jsx)("option",{value:"",children:"select group"}),Z.filter((e=>"string"===(0,c.MP)(e.Fied_Data)&&"Ledger_Name"!==(null===e||void 0===e?void 0:e.Field_Name)&&e.isEnabled)).map(((e,a)=>(0,B.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:ae(null===e||void 0===e?void 0:e.Field_Name)},a)))]})]})]}),ExcelPrintOption:!0,dataArray:ee,columns:L?Z.filter((e=>ee.length>0&&Object.keys(ee[0]).includes(e.Field_Name)&&e.isEnabled)).map((e=>(0,t.c)((0,t.c)({},e),{},{ColumnHeader:ae(e.Field_Name)}))):Z.filter((e=>e.isEnabled)).map((e=>(0,t.c)((0,t.c)({},e),{},{ColumnHeader:ae(e.Field_Name)}))),isExpendable:!!L,expandableComp:e=>{let{row:a}=e;return(0,B.jsx)(p.cp,{EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,dataArray:(0,c.dq)(null===a||void 0===a?void 0:a.groupedData),columns:Z.filter((e=>!(0,c.m2)(e.Field_Name,L)&&e.isEnabled)).map((e=>(0,t.c)((0,t.c)({},e),{},{ColumnHeader:ae(e.Field_Name)})))})}}),(0,B.jsxs)(y.c,{open:V,onClose:ie,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsxs)(h.c,{children:[(0,B.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("span",{children:"Filters"}),(0,B.jsxs)("span",{children:[(0,B.jsx)(g.c,{title:"Column Visibility",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>M(!0),children:(0,B.jsx)(S.c,{})})}),(0,B.jsx)(g.c,{title:"Clear Filters",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>A({}),children:(0,B.jsx)(O.c,{})})})]})]}),(0,B.jsxs)("div",{className:"border rounded-3",children:[Z.filter((e=>e.isEnabled)).map(((e,a)=>(0,B.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,B.jsx)("label",{className:"mt-2 mb-1",children:ae(null===e||void 0===e?void 0:e.Field_Name)}),ne(e)]},a))),(0,B.jsx)("br",{})]})]}),(0,B.jsx)(b.c,{children:(0,B.jsx)(C.c,{onClick:ie,color:"error",children:"Close"})})]}),(0,B.jsxs)(y.c,{open:W,onClose:()=>M(!1),maxWidth:"lg",fullWidth:!0,children:[(0,B.jsx)(j.c,{children:"Column Settings"}),(0,B.jsx)(h.c,{children:(0,B.jsx)("div",{className:"row",children:$.map(((e,a)=>(0,B.jsx)("div",{className:"col-lg-4 col-md-6 p-2",children:(0,B.jsxs)(f.c,{component:F.c,className:"p-2 d-flex justify-content-between align-items-center flex-wrap ".concat(a%2!==0?"bg-light":""," ").concat(e.isEnabled?"":"opacity-50"),children:[(0,B.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap",children:[(0,B.jsx)(D.c,{checked:Boolean(null===e||void 0===e?void 0:e.isVisible)&&e.isEnabled,onChange:a=>e.isEnabled&&K((l=>l.map((l=>l.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.c)((0,t.c)({},l),{},{isVisible:a.target.checked?1:0}):l))))}),(0,B.jsxs)("h6",{className:"fa-13 mb-0 fw-bold",children:[ae(e.Field_Name),!e.isEnabled&&(0,B.jsx)("span",{className:"text-muted small"})]})]}),(0,B.jsx)("input",{type:"number",value:(0,c.Q$)(null===e||void 0===e?void 0:e.OrderBy)?null===e||void 0===e?void 0:e.OrderBy:"",onChange:a=>e.isEnabled&&K((l=>l.map((l=>l.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.c)((0,t.c)({},l),{},{OrderBy:a.target.value}):l)))),disabled:!e.isEnabled,className:"mt-2 p-1 border-0 cus-inpt",style:{width:"80px"},placeholder:"Order"})]})},a)))})}),(0,B.jsxs)(b.c,{children:[(0,B.jsx)(C.c,{onClick:()=>{K(J)},variant:"outlined",children:"Reset"}),(0,B.jsx)(C.c,{onClick:()=>M(!1),color:"error",children:"Close"})]})]})]})},A=[{Column_Name:"Trans_Date",Data_Type:"date"},{Column_Name:"Group_Name",Data_Type:"string"},{Column_Name:"stock_item_name",Data_Type:"string"},{Column_Name:"OB_Bal_Qty",Data_Type:"number"},{Column_Name:"OB_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Qty",Data_Type:"number"},{Column_Name:"Sal_Qty",Data_Type:"number"},{Column_Name:"Bal_Qty",Data_Type:"number"},{Column_Name:"Bal_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Act_Qty",Data_Type:"number"},{Column_Name:"Sal_Act_Qty",Data_Type:"number"},{Column_Name:"Stock_Item",Data_Type:"string"},{Column_Name:"Group_ST",Data_Type:"string"},{Column_Name:"Bag",Data_Type:"string"},{Column_Name:"Stock_Group",Data_Type:"string"},{Column_Name:"Product_Rate",Data_Type:"number"},{Column_Name:"S_Sub_Group_1",Data_Type:"string"},{Column_Name:"Grade_Item_Group",Data_Type:"string"},{Column_Name:"Item_Name_Modified",Data_Type:"string"}],L=[{Column_Name:"Godown_Name",Data_Type:"string"},{Column_Name:"stock_item_name",Data_Type:"string"},{Column_Name:"OB_Bal_Qty",Data_Type:"number"},{Column_Name:"OB_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Qty",Data_Type:"number"},{Column_Name:"Sal_Qty",Data_Type:"number"},{Column_Name:"Bal_Qty",Data_Type:"number"},{Column_Name:"Act_Bal_Qty",Data_Type:"number"},{Column_Name:"Pur_Act_Qty",Data_Type:"number"},{Column_Name:"Sal_Act_Qty",Data_Type:"number"},{Column_Name:"Stock_Item",Data_Type:"string"},{Column_Name:"Group_ST",Data_Type:"string"},{Column_Name:"Bag",Data_Type:"string"},{Column_Name:"Stock_Group",Data_Type:"string"},{Column_Name:"Product_Rate",Data_Type:"number"},{Column_Name:"S_Sub_Group_1",Data_Type:"string"},{Column_Name:"Grade_Item_Group",Data_Type:"string"},{Column_Name:"Item_Name_Modified",Data_Type:"string"}],P=e=>{let{loadingOn:a,loadingOff:l}=e;const[_,p]=(0,m.useState)(1),[v,N]=(0,m.useState)({Fromdate:(0,c.Q7)(),Todate:(0,c.Q7)(),FilterFromDate:(0,c.Q7)(),FilterTodate:(0,c.Q7)()}),x=[{name:"Item Wise",component:(0,B.jsx)(G,{loadingOn:a,loadingOff:l,Fromdate:v.Fromdate,Todate:v.Todate,api:"itemWise",defaultGrouping:"",storageStockColumns:A})},{name:"Godown Wise",component:(0,B.jsx)(G,{loadingOn:a,loadingOff:l,Fromdate:v.Fromdate,Todate:v.Todate,api:"godownWise",defaultGrouping:"Godown_Name",storageStockColumns:L,groupingOption:!1})}];return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-3",children:[(0,B.jsx)("label",{htmlFor:"from",className:"me-1 fw-bold ",children:"Fromdate: "}),(0,B.jsx)("input",{type:"date",id:"from",className:"cus-inpt p-2 w-auto me-2",value:v.FilterFromDate,onChange:e=>N((a=>(0,t.c)((0,t.c)({},a),{},{FilterFromDate:e.target.value})))}),(0,B.jsx)("label",{htmlFor:"to",className:"me-1 fw-bold ",children:"Todate: "}),(0,B.jsx)("input",{type:"date",id:"to",className:"cus-inpt p-2 w-auto",value:v.FilterTodate,onChange:e=>N((a=>(0,t.c)((0,t.c)({},a),{},{FilterTodate:e.target.value})))}),(0,B.jsx)(r.c,{size:"small",onClick:()=>N((e=>(0,t.c)((0,t.c)({},e),{},{Fromdate:e.FilterFromDate?e.FilterFromDate:e.Fromdate,Todate:e.FilterTodate?e.FilterTodate:e.Todate}))),children:(0,B.jsx)(u.c,{})})]}),(0,B.jsxs)(n.cp,{value:_,children:[(0,B.jsx)(d.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,B.jsx)(i.c,{indicatorColor:"transparant",onChange:(e,a)=>p(a),variant:"scrollable",scrollButtons:"auto",children:x.map(((e,a)=>(0,B.jsx)(s.c,{sx:_===a+1?{backgroundColor:"#c6d7eb"}:{},label:e.name,value:a+1},a)))})}),x.map(((e,a)=>(0,B.jsx)(o.c,{value:a+1,sx:{p:0,pt:2},children:e.component},a)))]})]})}}}]);
//# sourceMappingURL=312.d5410cea.chunk.js.map