"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5228],{64568:(e,l,s)=>{s.d(l,{c:()=>t});var a=s(82496);const t=()=>(0,a.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},35228:(e,l,s)=>{s.r(l),s.d(l,{default:()=>y,payTypeAndStatus:()=>_});var a=s(43692),t=s(89e3),d=s(84436),i=s(39308),o=s(1908),c=s(99852),n=s(69060),r=s(51560),u=s(83612),v=s(56480),h=s(64568),m=s(27664),p=s(82496);const x=(0,m.c)((0,p.jsx)("path",{d:"M2.81 2.81 1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20M7.94 5.12 6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.46-1.46C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12"}),"HideSource");var j=s(30796);const b=e=>{var l,s,a;let{row:d={},receiptsPaymentInfo:o=[],setReceiptsPaymentInfo:c,Sno:r}=e;const[v,m]=(0,n.useState)(!1),[b,_]=(0,n.useState)(!1),y=(0,n.useMemo)((()=>{const e=o.find((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===d||void 0===d?void 0:d.Do_Id)));return(0,i.CY)(e)?e:{}}),[o,d]),N=(0,n.useMemo)((()=>o.findIndex((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===d||void 0===d?void 0:d.Do_Id)))),[o,d]),g=(e,l)=>{c((s=>{const a=[...s];if(-1===N){const s={...u.I};return s.bill_id=null===d||void 0===d?void 0:d.Do_Id,s.bill_amount=(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value),s[e]=l,[...a,s]}return a[N][e]=l,a}))},C=(0,n.useMemo)((()=>{var e;return Array.isArray(null===d||void 0===d?void 0:d.Payments)?null===d||void 0===d||null===(e=d.Payments)||void 0===e?void 0:e.reduce(((e,l)=>(0,i.Q5)(e,l.collected_amount)),0):0}),[d]),f=(0,i.Q$)(null===y||void 0===y?void 0:y.bill_id);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"border",children:r}),(0,p.jsx)("td",{className:"border",children:(0,p.jsx)("div",{children:(0,p.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:f,onChange:()=>{f?c((e=>e.filter((e=>!(0,i.Qr)(e.bill_id,null===d||void 0===d?void 0:d.Do_Id))))):g("bill_amount",(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value))}})})}),(0,p.jsx)("td",{className:"border",children:null===d||void 0===d?void 0:d.Do_Inv_No}),(0,p.jsx)("td",{className:"border",children:(0,i.uy)(null===d||void 0===d?void 0:d.Do_Date)}),(0,p.jsx)("td",{className:"border",children:(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value)}),(0,p.jsx)("td",{className:"border",children:C}),(0,p.jsx)("td",{className:"border",children:null===d||void 0===d?void 0:d.pendingAmount}),(0,p.jsx)("td",{className:"border",children:(0,i.gH)(null===d||void 0===d||null===(l=d.Payments)||void 0===l?void 0:l.length)})]}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,children:(0,p.jsxs)("div",{className:"d-flex align-items-end flex-wrap",children:[(0,p.jsxs)("div",{className:"flex-grow-1",children:[(0,p.jsxs)("label",{className:"fa-14 w-100",children:["Receipt Amount (\u20b9)",f&&(0,p.jsx)(h.c,{})]}),(0,p.jsx)("input",{onInput:i.Gk,disabled:!f,value:null!==y&&void 0!==y&&y.collected_amount?(0,i.gH)(null===y||void 0===y?void 0:y.collected_amount):"",onChange:e=>g("collected_amount",e.target.value),style:{width:"100%",maxWidth:"350px"},className:"cus-inpt border p-2",placeholder:"Enter Receipt Amount",max:(0,i.gH)(null===d||void 0===d?void 0:d.pendingAmount),required:f})]}),(0,p.jsxs)(t.c,{startIcon:b?(0,p.jsx)(x,{}):(0,p.jsx)(j.c,{}),onClick:()=>_((e=>!e)),children:[b?"Hide":"Show"," Invoice"]}),(0,p.jsxs)(t.c,{startIcon:v?(0,p.jsx)(x,{}):(0,p.jsx)(j.c,{}),onClick:()=>m((e=>!e)),disabled:!Array.isArray(null===d||void 0===d?void 0:d.Payments)||0===(0,i.gH)(null===d||void 0===d||null===(s=d.Payments)||void 0===s?void 0:s.length),children:[v?"Hide":"Previous"," Receipts"]})]})})}),b&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{colSpan:8,children:["Bill Details of - ",null===d||void 0===d?void 0:d.Do_Inv_No]})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"p-0",children:(0,p.jsx)("div",{className:"table-responsive fa-13 m-0",children:(0,p.jsxs)("table",{className:"table m-0",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["SNo","Item","Quantity","Rate","Pack","Tax","Amount"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light",children:e},l)))})}),(0,p.jsx)("tbody",{children:Array.isArray(null===d||void 0===d?void 0:d.Products_List)&&d.Products_List.map(((e,l)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:l+1}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.UOM}),(0,p.jsx)("td",{children:(0,i.Q5)(null===e||void 0===e?void 0:e.Cgst_Amo,null===e||void 0===e?void 0:e.Sgst_Amo)||(0,i.gH)(null===e||void 0===e?void 0:e.Igst_Amo)}),(0,p.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount})]},l)))})]})})})})]}),v&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{colSpan:8,children:["Previous Receipts of - ",null===d||void 0===d?void 0:d.Do_Inv_No]})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"p-0 border-0",children:(0,p.jsx)("div",{className:"table-responsive fa-13",children:(0,p.jsxs)("table",{className:"table m-0",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["SNo","Collected By","Amount","Date","Receipt Type","payment_status","Verify Status"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light border",children:e},l)))})}),(0,p.jsx)("tbody",{children:null===(a=Array.isArray(null===d||void 0===d?void 0:d.Payments)?null===d||void 0===d?void 0:d.Payments:[])||void 0===a?void 0:a.filter((e=>!(0,i.Qr)(e.auto_id,null===d||void 0===d?void 0:d.auto_id))).map(((e,l)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"border",children:l+1}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.CreatedByGet}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collected_amount}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_date}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,p.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.verify_status})]},l)))})]})})})}),(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:8,className:"border-0"})})]})]})},_=[{type:"CASH",default:"CREATED-CASH",statusOptions:["CREATED-CASH","CASH-PROCESSING","CASH-MISSING"]},{type:"UPI",default:"CREATED-UPI",statusOptions:["CREATED-UPI","UPI-PROCESSING","UPI-NOT-RECEIVED"]},{type:"CHEQUE",default:"CREATED-CHEQUE",statusOptions:["CREATED-CHEQUE","CHEQUE-PROCESSING","CHEQUE-BOUNCE"]},{type:"BANK",default:"CREATED-BANK-TRANSFER",statusOptions:["CREATED-BANK-TRANSFER","BANK-PROCESSING","BANK-NOT-RECEIVED"]}],y=e=>{var l;let{loadingOn:s,loadingOff:m}=e;const x=(0,r.i6)(),[j,y]=(0,n.useState)([]),[N,g]=(0,n.useState)([]),[C,f]=(0,n.useState)({salesPerson:[],voucherData:[],creditAccount:[]}),[S,A]=(0,n.useState)(u.Y),[R,I]=(0,n.useState)([]),[E,P]=(0,n.useState)({Fromdate:(0,i.Q7)(),Todate:(0,i.Q7)(),Retailer:{value:"",label:"Search by Retailer..."}}),H=(null===(l=_.find((e=>e.type===(null===S||void 0===S?void 0:S.collection_type))))||void 0===l?void 0:l.statusOptions)||{};(0,n.useEffect)((()=>{(0,o.q)({address:"receipt/getRetailersWhoHasBills"}).then((e=>{e.success?g(e.data):g([])})).catch((e=>console.error(e))),(0,o.q)({address:"masters/users/salesPerson/dropDown"}).then((e=>{e.success?f((l=>({...l,salesPerson:e.data}))):f((e=>({...e,salesPerson:[]})))})).catch((e=>console.error(e))),(0,o.q)({address:"masters/voucher"}).then((e=>{e.success?f((l=>({...l,voucherData:e.data}))):f((e=>({...e,voucherData:[]})))})).catch((e=>console.error(e))),(0,o.q)({address:"receipt/creditAccounts"}).then((e=>{e.success?f((l=>({...l,creditAccount:e.data}))):f((e=>({...e,creditAccount:[]})))})).catch((e=>console.error(e)))}),[]),(0,n.useEffect)((()=>{(0,i.Q$)(S.retailer_id)&&(s&&s(),(0,o.q)({address:`receipt/retailerBills?retailer_id=${S.retailer_id}`}).then((e=>{e.success?y(e.data):y([])})).catch((e=>console.error(e))).finally((()=>{m&&m()})))}),[S.retailer_id]);const D=(0,n.useMemo)((()=>R.reduce(((e,l)=>(0,i.Q5)(e,null===l||void 0===l?void 0:l.collected_amount)),0)),[R]),T=()=>{s&&s(),(0,o.q)({address:"receipt/collectionReceipts",method:(0,i.Q$)(S.collection_id)&&S.collection_id>0?"PUT":"POST",bodyData:{...S,Collections:R}}).then((e=>{e.success?(v.m4.success((null===e||void 0===e?void 0:e.message)||"Receipt Created"),P((e=>({...e,Retailer:{value:"",label:"Search by Retailer..."}}))),A(u.Y),I([]),y([])):v.m4.error((null===e||void 0===e?void 0:e.message)||"Failed to create Receipt")})).catch((e=>console.error(e))).finally((()=>{m&&m()}))};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(a.c,{children:(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),T()},children:[(0,p.jsxs)("div",{className:"px-3 py-2 d-flex align-items-center",children:[(0,p.jsx)("h5",{className:"m-0 flex-grow-1",children:"Receipt Creation"}),(0,p.jsx)(t.c,{variant:"outlined",type:"button",className:"me-1",onClick:()=>x("/erp/crm/paymentCollection"),children:"Back"}),(0,p.jsx)(t.c,{variant:"outlined",type:"submit",disabled:0===R.length||R.every((e=>(0,i.gH)(e.collected_amount)<=0)),children:"save receipt"})]}),(0,p.jsxs)(d.c,{children:[(0,p.jsx)("label",{children:"Retailer"}),(0,p.jsx)("div",{className:"d-flex",children:(0,p.jsx)("div",{style:{width:"100%",maxWidth:"400px"},children:(0,p.jsx)(c.cp,{menuPortalTarget:document.body,options:[{value:"",label:"select",isDisabled:!0},...N.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],value:E.Retailer,menu:!0,onChange:e=>{P((l=>({...l,Retailer:e}))),A((l=>({...l,retailer_id:e.value})))},placeholder:"Search by Retailer"})})}),(0,p.jsxs)("div",{className:"row fa-13 pb-3 mt-2",children:[(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Date",(0,p.jsx)(h.c,{})]}),(0,p.jsx)("input",{type:"date",className:"cus-inpt border p-2",value:S.collection_date,onChange:e=>A((l=>({...l,collection_date:e.target.value}))),required:!0})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Voucher",(0,p.jsx)(h.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.voucher_id,required:!0,onChange:e=>A((l=>({...l,voucher_id:e.target.value}))),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),C.voucherData.filter((e=>(0,i.m2)(e.Type,"Receipt"))).map(((e,l)=>(0,p.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})]})]}),(0,p.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Payment Type",(0,p.jsx)(h.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.collection_type,required:!0,onChange:e=>A((l=>{var s;return{...l,collection_type:e.target.value,payment_status:null===(s=_.find((l=>l.type===e.target.value)))||void 0===s?void 0:s.default}})),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,p.jsx)("option",{value:"CASH",children:"CASH"}),(0,p.jsx)("option",{value:"UPI",children:"UPI"}),(0,p.jsx)("option",{value:"CHEQUE",children:"CHEQUE"}),(0,p.jsx)("option",{value:"BANK",children:"BANK"})]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Payment Account ",(0,p.jsx)(h.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.collection_account,required:!0,disabled:!S.collection_type,onChange:e=>A((l=>({...l,collection_account:e.target.value}))),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),C.creditAccount.filter((e=>(0,i.m2)(S.collection_type,"CASH")?(0,i.m2)(e.Type,"CASH"):!(0,i.m2)(e.Type,"CASH"))).map(((e,l)=>(0,p.jsx)("option",{value:null===e||void 0===e?void 0:e.Id,children:null===e||void 0===e?void 0:e.Bank_Name},l)))]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Payment Status",(0,p.jsx)(h.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.payment_status,required:!0,disabled:!S.collection_type,onChange:e=>A((l=>({...l,payment_status:e.target.value}))),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),H.map(((e,l)=>(0,p.jsx)("option",{value:e,children:e},l))),(0,p.jsx)("option",{value:"Canceled",children:"Canceled"}),(0,p.jsx)("option",{value:"Completed",children:"Completed"})]})]})]}),(0,p.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsx)("label",{children:"Payed By"}),(0,p.jsx)("input",{className:"cus-inpt border p-2",value:S.payed_by,placeholder:"Owner, Shop Keeper..",onChange:e=>A((l=>({...l,payed_by:e.target.value})))})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,p.jsxs)("label",{children:["Amount Received By",(0,p.jsx)(h.c,{})]}),(0,p.jsxs)("select",{className:"cus-inpt border p-2",value:S.collected_by,onChange:e=>A((l=>({...l,collected_by:e.target.value}))),required:!0,children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select"}),C.salesPerson.map(((e,l)=>(0,p.jsx)("option",{value:e.UserId,children:e.Name},l)))]})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,p.jsx)("label",{className:"fa-14",children:"Verify Date"}),(0,p.jsx)("input",{type:"date",value:null!==S&&void 0!==S&&S.bank_date?null===S||void 0===S?void 0:S.bank_date:"",onChange:e=>A((l=>({...l,bank_date:e.target.value}))),className:"cus-inpt border border p-2"})]}),(0,p.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,p.jsx)("label",{className:"fa-14",children:"Verify Status"}),(0,p.jsxs)("select",{value:null===S||void 0===S?void 0:S.verify_status,onChange:e=>A((l=>({...l,verify_status:e.target.value}))),className:"cus-inpt border border p-2",children:[(0,p.jsx)("option",{value:0,children:"Not-verified"}),(0,p.jsx)("option",{value:1,children:"verified"})]})]}),(0,p.jsxs)("div",{className:"col-lg-6 col-sm-8 p-1",children:[(0,p.jsx)("label",{className:"fa-14 w-100",children:"Narration"}),(0,p.jsx)("textarea",{style:{width:"100%",maxWidth:"450px"},className:"cus-inpt border p-2",value:null===S||void 0===S?void 0:S.narration,onChange:e=>A((l=>({...l,narration:e.target.value}))),placeholder:"Narration..."})]}),(0,p.jsxs)("div",{className:"col-lg-6 col-sm-4 p-1 text-end",children:[(0,p.jsx)("label",{className:"fa-14 w-100",children:"Total Receipt Amount"}),(0,p.jsx)("input",{className:"cus-inpt bg-white p-2 w-auto border border-primary text-primary",value:(0,i.kR)(D),disabled:!0})]})]}),(0,p.jsx)("div",{className:"table-responsive",children:(0,p.jsxs)("table",{className:"table table-bordered",children:[(0,p.jsx)("thead",{children:(0,p.jsx)("tr",{children:["Sno","#","Invoice No","Date","Invoice Value","Paid","Pending","Receipts"].map(((e,l)=>(0,p.jsx)("th",{className:"bg-light fa-13 border",children:e},l)))})}),(0,p.jsx)("tbody",{children:j.map(((e,l)=>(0,p.jsx)(b,{row:e,Sno:l+1,receiptsPaymentInfo:R,setReceiptsPaymentInfo:I},l)))})]})})]})]})})})}},83612:(e,l,s)=>{s.d(l,{I:()=>i,Y:()=>d});var a=s(39308);const t=(0,a.gV)().user,d={collection_id:"",collection_inv_no:"",voucher_id:"",collection_no:"",year_id:"",retailer_id:"",payed_by:"",collection_date:(0,a.Q7)(),collection_type:"CASH",collection_account:"",payment_status:"",latitude:"",longitude:"",collected_by:"",total_amount:0,created_on:"",alterd_on:"",narration:"",verify_status:0,bank_date:"",created_by:t.UserId,updated_by:t.UserId,verified_by:t.UserId,verified_at:""},i={auto_id:"",collection_id:"",bill_id:"",bill_amount:0,collected_amount:0}},30796:(e,l,s)=>{s.d(l,{c:()=>d});var a=s(27664),t=s(82496);const d=(0,a.c)((0,t.jsx)("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List")},84436:(e,l,s)=>{s.d(l,{c:()=>x});var a=s(45072),t=s(95656),d=s(69060),i=s(79736),o=s(21412),c=s(12556),n=s(49836),r=s(10099),u=s(33448);function v(e){return(0,u.cp)("MuiCardContent",e)}(0,r.c)("MuiCardContent",["root"]);var h=s(82496);const m=["className","component"],p=(0,c.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=d.forwardRef((function(e,l){const s=(0,n.C)({props:e,name:"MuiCardContent"}),{className:d,component:c="div"}=s,r=(0,t.c)(s,m),u=(0,a.c)({},s,{component:c}),x=(e=>{const{classes:l}=e;return(0,o.c)({root:["root"]},v,l)})(u);return(0,h.jsx)(p,(0,a.c)({as:c,className:(0,i.c)(x.root,d),ownerState:u,ref:l},r))}))}}]);
//# sourceMappingURL=5228.a55e4610.chunk.js.map