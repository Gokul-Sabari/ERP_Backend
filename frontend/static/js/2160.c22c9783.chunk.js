"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[2160],{8364:(e,l,t)=>{t.r(l),t.d(l,{default:()=>T});var a=t(69060),o=t(3358),d=t(5548),s=t(89e3),i=t(82656),r=t(26773),c=t(4488),n=t(90048),u=t(99852),v=t(62344),h=t(39308),m=t(91924),p=t(61988),x=t(57704),b=t(1908),j=t(13724),g=t(51560),y=t(82496);const C={Fromdate:(0,h.Q7)(),Todate:(0,h.Q7)()},T=e=>{let{loadingOn:l,loadingOff:t}=e;JSON.parse(localStorage.getItem("user"));const T=(0,g.i6)(),N=(0,g.IT)(),_=N.state,F=new URLSearchParams((0,g.IT)().search),[f,S]=(0,a.useState)([]),[A,R]=(0,a.useState)([]),[w,L]=(0,a.useState)([]),[$,B]=(0,a.useState)({}),[D,k]=(0,a.useState)(!1),[V,E]=(0,a.useState)([]),[P,I]=(0,a.useState)([]),[Q,M]=(0,a.useState)([]),[G,O]=(0,a.useState)(!1),[H,z]=(0,a.useState)(!1),[U,q]=(0,a.useState)({Fromdate:(0,h.Q7)(),Todate:(0,h.Q7)(),Retailer:{value:"",label:"ALL"},CollectionType:{value:"",label:"ALL"},CollectedBy:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:0}),[W,J]=(0,a.useState)({filters:!1,orderDetails:!1});(0,a.useEffect)((()=>{var e,a,o,d;l&&l(),(0,b.q)({address:`reports/collectionReport?Fromdate=${null===U||void 0===U?void 0:U.Fromdate}&Todate=${null===U||void 0===U?void 0:U.Todate}&retailer_id=${null===U||void 0===U||null===(e=U.Retailer)||void 0===e?void 0:e.value}&collected_by=${null===U||void 0===U||null===(a=U.CollectedBy)||void 0===a?void 0:a.value}&collection_type=${null===U||void 0===U||null===(o=U.CollectionType)||void 0===o?void 0:o.value}&voucher_id=${null===U||void 0===U||null===(d=U.VoucherType)||void 0===d?void 0:d.value}&Cancel_status=${null===U||void 0===U?void 0:U.Cancel_status}`}).then((e=>{e.success&&S(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e))).finally((()=>{t&&t()}))}),[D]),(0,a.useEffect)((()=>{var e,a,o,d;H&&(l&&l(),(0,b.q)({address:`reports/cummulativeReport?Fromdate=${null===U||void 0===U?void 0:U.Fromdate}&Todate=${null===U||void 0===U?void 0:U.Todate}&retailer_id=${null===U||void 0===U||null===(e=U.Retailer)||void 0===e?void 0:e.value}&collected_by=${null===U||void 0===U||null===(a=U.CollectedBy)||void 0===a?void 0:a.value}&collection_type=${null===U||void 0===U||null===(o=U.CollectionType)||void 0===o?void 0:o.value}&voucher_id=${null===U||void 0===U||null===(d=U.VoucherType)||void 0===d?void 0:d.value}&Cancel_status=${null===U||void 0===U?void 0:U.Cancel_status}`}).then((e=>{e.success&&M(e.data)})).catch((e=>{console.error(e)})).finally((()=>{t&&t(),z(!1)})))}),[H]),(0,a.useEffect)((()=>{(0,b.q)({address:"receipt/filterValues"}).then((e=>{e.success&&e.others&&(L(e.others.voucherType||[]),R(e.others.retailers||[]),E(e.others.collectionType||[]),I(e.others.collectedBy||[]))})).catch((e=>{console.error("Failed to fetch filter values",e)}))}),[]),(0,a.useEffect)((()=>{const e={Fromdate:F.get("Fromdate")&&(0,h.e8)(F.get("Fromdate"))?F.get("Fromdate"):C.Fromdate,Todate:F.get("Todate")&&(0,h.e8)(F.get("Todate"))?F.get("Todate"):C.Todate};q((l=>({...l,Fromdate:e.Fromdate,Todate:e.Todate})))}),[N.search]),(0,a.useEffect)((()=>{const e=null!==_&&void 0!==_&&_.Fromdate&&(0,h.e8)(null===_||void 0===_?void 0:_.Fromdate)?(0,h.Q7)(null===_||void 0===_?void 0:_.Fromdate):null,l=null!==_&&void 0!==_&&_.Todate&&(0,h.e8)(null===_||void 0===_?void 0:_.Todate)?(0,h.Q7)(null===_||void 0===_?void 0:_.Todate):null;e&&l&&(Y({Fromdate:e,Todate:l}),q((e=>({...e,Fromdate:(0,h.Q7)(_.Fromdate),Todate:_.Todate}))),k((e=>!e)))}),[_]);const Y=e=>{const l=new URLSearchParams(e);T(`?${l.toString()}`,{replace:!0})},K=()=>{J({...W,filters:!1,orderDetails:!1})},X=(0,a.useMemo)((()=>f.reduce(((e,l)=>{const t=(l.Receipts||[]).reduce(((e,l)=>e+(l.collected_amount||0)),0);return(0,h.Q5)(e,t)}),0)),[f]);return(0,y.jsxs)(y.Fragment,{children:[G?(0,y.jsx)(j.cp,{title:"Collection Report",dataArray:f,EnableSerialNumber:!0,columns:[(0,j.A5)("RetailerGet","string","Retailer"),(0,j.A5)("collection_inv_no","string","collection_inv_no"),{ColumnHeader:"CollectionDate",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=l.collection_date;let a="Undefined";if(t){const e=new Date(t);isNaN(e)||(a=`${e.getDate().toString().padStart(2,"0")}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getFullYear()}`)}return(0,y.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 "+(t?"bg-success text-white":"bg-secondary text-white"),children:a})}},{ColumnHeader:"Receipts",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=(l.Receipts||[]).reduce(((e,l)=>e+(l.collected_amount||0)),0);return(0,y.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 "+(t?"bg-success text-white":"bg-secondary text-white"),children:t||"Undefined"})}},(0,j.A5)("CollectedByGet","string","Collected_By"),(0,j.A5)("collection_type","string","Collection_Type")],ButtonArea:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.c,{title:"Filters",children:(0,y.jsx)(d.c,{size:"small",onClick:()=>J({...W,filters:!0}),children:(0,y.jsx)(p.c,{})})}),Number(X)>0&&(0,y.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",X]}),(0,y.jsx)(s.c,{onClick:()=>{O(!1),z(!1)},children:"Cummulative Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.Receipts||[];return(0,y.jsx)(y.Fragment,{children:0===t.length?(0,y.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map(((e,l)=>(0,y.jsx)("table",{className:"table mb-3",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Do_Inv_No"}),(0,y.jsx)("td",{className:"border p-2",children:e.Do_Inv_No}),(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Do_Date"}),(0,y.jsx)("td",{className:"border p-2",children:e.Do_Date}),(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Total Invoice Value"}),(0,y.jsx)("td",{className:"border p-2",children:e.Total_Invoice_value})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Collected Amount"}),(0,y.jsx)("td",{className:"border p-2",children:e.collected_amount}),(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Bill Amount"}),(0,y.jsx)("td",{className:"border p-2",children:e.bill_amount}),(0,y.jsx)("td",{className:"border p-2 bg-light",children:"Total Receipt Amount"}),(0,y.jsx)("td",{className:"border p-2",children:e.total_receipt_amount})]})]})},l)))})}}):(0,y.jsx)(j.cp,{title:"Cummulative Report",dataArray:Q,EnableSerialNumber:!0,columns:[(0,j.A5)("collection_type","string","collection_type"),(0,j.A5)("total_collected","string","total_collected")],ButtonArea:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.c,{title:"Filters",children:(0,y.jsx)(d.c,{size:"small",onClick:()=>J({...W,filters:!0}),children:(0,y.jsx)(p.c,{})})}),Number(X)>0&&(0,y.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",X]}),(0,y.jsx)(s.c,{onClick:()=>{O(!0),z(!0)},children:"Collection Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.retailers||[];return(0,y.jsx)(y.Fragment,{children:0===t.length?(0,y.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map(((e,l)=>(0,y.jsx)("table",{className:"table mb-3",children:(0,y.jsx)("tbody",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"collection_inv_no"}),(0,y.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.collection_inv_no}),(0,y.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"RetailerGet"}),(0,y.jsx)("td",{className:"border p-2",style:{width:"250px"},children:e.RetailerGet}),(0,y.jsx)("td",{className:"border p-2 bg-light",style:{width:"180px"},children:"CollectedByGet"}),(0,y.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.CollectedByGet})]})})},l)))})}}),Object.keys($).length>0&&(0,y.jsx)(m.c,{orderDetails:null===$||void 0===$?void 0:$.orderDetails,orderProducts:null===$||void 0===$?void 0:$.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>B({}),TitleText:"Sale Order"}),(0,y.jsxs)(i.c,{open:W.filters,onClose:K,fullWidth:!0,maxWidth:"sm",children:[(0,y.jsx)(r.c,{children:"Filters"}),(0,y.jsx)(c.c,{children:(0,y.jsx)("div",{className:"table-responsive pb-4",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,y.jsx)("td",{children:(0,y.jsx)("input",{type:"date",value:U.Fromdate,onChange:e=>q({...U,Fromdate:e.target.value}),className:"cus-inpt"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,y.jsx)("td",{children:(0,y.jsx)("input",{type:"date",value:U.Todate,onChange:e=>q({...U,Todate:e.target.value}),className:"cus-inpt"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,y.jsx)("td",{children:(0,y.jsx)(u.cp,{value:null===U||void 0===U?void 0:U.Retailer,onChange:e=>q({...U,Retailer:e}),options:[{value:"",label:"ALL"},...A.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:v.cF,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected By"}),(0,y.jsx)("td",{children:(0,y.jsx)(u.cp,{value:null===U||void 0===U?void 0:U.CollectedBy,onChange:e=>q((l=>({...U,CollectedBy:e}))),options:[{value:"",label:"ALL"},...P.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:v.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected Type"}),(0,y.jsx)("td",{children:(0,y.jsx)(u.cp,{value:null===U||void 0===U?void 0:U.CollectionType,onChange:e=>q((l=>({...U,CollectionType:e}))),options:[{value:"",label:"ALL"},...V.map((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:v.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,y.jsx)("td",{children:(0,y.jsx)(u.cp,{value:null===U||void 0===U?void 0:U.VoucherType,onChange:e=>q({...U,VoucherType:e}),options:[{value:"",label:"ALL"},...w.filter((e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label})))],styles:v.cF,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name"})})]})]})})})}),(0,y.jsxs)(n.c,{children:[(0,y.jsx)(s.c,{onClick:K,children:"close"}),(0,y.jsx)(s.c,{onClick:()=>{K();const e={Fromdate:null===U||void 0===U?void 0:U.Fromdate,Todate:null===U||void 0===U?void 0:U.Todate};Y(e),k((e=>!e)),z(!0)},startIcon:(0,y.jsx)(x.c,{}),variant:"outlined",children:"Search"})]})]})]})}},14499:(e,l,t)=>{t.d(l,{c:()=>d});var a=t(27664),o=t(82496);const d=(0,a.c)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},61988:(e,l,t)=>{t.d(l,{c:()=>d});var a=t(27664),o=t(82496);const d=(0,a.c)((0,o.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},57704:(e,l,t)=>{t.d(l,{c:()=>d});var a=t(27664),o=t(82496);const d=(0,a.c)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=2160.c22c9783.chunk.js.map