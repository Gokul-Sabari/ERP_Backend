"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8184],{64568:(e,l,s)=>{s.d(l,{c:()=>t});var a=s(82496);const t=()=>(0,a.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},98184:(e,l,s)=>{s.r(l),s.d(l,{default:()=>y,payTypeAndStatus:()=>_});var a=s(30800),t=s(43692),c=s(89e3),d=s(84436),i=s(39308),o=s(1908),n=s(40656),r=s(69060),u=s(51560),v=s(11364),h=s(82496);var m=s(56480),p=s(64568);const x=(0,s(27664).c)((0,h.jsx)("path",{d:"M2.81 2.81 1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20M7.94 5.12 6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.46-1.46C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12"}),"HideSource");var j=s(30796);const b=e=>{var l,s,t;let{row:d={},receiptsPaymentInfo:o=[],setReceiptsPaymentInfo:n,Sno:u}=e;const[m,b]=(0,r.useState)(!1),[_,y]=(0,r.useState)(!1),N=(0,r.useMemo)((()=>{const e=o.find((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===d||void 0===d?void 0:d.Do_Id)));return(0,i.CY)(e)?e:{}}),[o,d]),g=(0,r.useMemo)((()=>o.findIndex((e=>(0,i.Qr)(null===e||void 0===e?void 0:e.bill_id,null===d||void 0===d?void 0:d.Do_Id)))),[o,d]),C=(e,l)=>{n((s=>{const t=[...s];if(-1===g){const s=(0,a.c)({},v.I);return s.bill_id=null===d||void 0===d?void 0:d.Do_Id,s.bill_amount=(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value),s[e]=l,[...t,s]}return t[g][e]=l,t}))},f=(0,r.useMemo)((()=>{var e;return Array.isArray(null===d||void 0===d?void 0:d.Payments)?null===d||void 0===d||null===(e=d.Payments)||void 0===e?void 0:e.reduce(((e,l)=>(0,i.Q5)(e,l.collected_amount)),0):0}),[d]),S=(0,i.Q$)(null===N||void 0===N?void 0:N.bill_id);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border",children:u}),(0,h.jsx)("td",{className:"border",children:(0,h.jsx)("div",{children:(0,h.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:S,onChange:()=>{S?n((e=>e.filter((e=>!(0,i.Qr)(e.bill_id,null===d||void 0===d?void 0:d.Do_Id))))):C("bill_amount",(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value))}})})}),(0,h.jsx)("td",{className:"border",children:null===d||void 0===d?void 0:d.Do_Inv_No}),(0,h.jsx)("td",{className:"border",children:(0,i.uy)(null===d||void 0===d?void 0:d.Do_Date)}),(0,h.jsx)("td",{className:"border",children:(0,i.gH)(null===d||void 0===d?void 0:d.Total_Invoice_value)}),(0,h.jsx)("td",{className:"border",children:f}),(0,h.jsx)("td",{className:"border",children:null===d||void 0===d?void 0:d.pendingAmount}),(0,h.jsx)("td",{className:"border",children:(0,i.gH)(null===d||void 0===d||null===(l=d.Payments)||void 0===l?void 0:l.length)})]}),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:8,children:(0,h.jsxs)("div",{className:"d-flex align-items-end flex-wrap",children:[(0,h.jsxs)("div",{className:"flex-grow-1",children:[(0,h.jsxs)("label",{className:"fa-14 w-100",children:["Receipt Amount (\u20b9)",S&&(0,h.jsx)(p.c,{})]}),(0,h.jsx)("input",{onInput:i.Gk,disabled:!S,value:null!==N&&void 0!==N&&N.collected_amount?(0,i.gH)(null===N||void 0===N?void 0:N.collected_amount):"",onChange:e=>C("collected_amount",e.target.value),style:{width:"100%",maxWidth:"350px"},className:"cus-inpt border p-2",placeholder:"Enter Receipt Amount",max:(0,i.gH)(null===d||void 0===d?void 0:d.pendingAmount),required:S})]}),(0,h.jsxs)(c.c,{startIcon:_?(0,h.jsx)(x,{}):(0,h.jsx)(j.c,{}),onClick:()=>y((e=>!e)),children:[_?"Hide":"Show"," Invoice"]}),(0,h.jsxs)(c.c,{startIcon:m?(0,h.jsx)(x,{}):(0,h.jsx)(j.c,{}),onClick:()=>b((e=>!e)),disabled:!Array.isArray(null===d||void 0===d?void 0:d.Payments)||0===(0,i.gH)(null===d||void 0===d||null===(s=d.Payments)||void 0===s?void 0:s.length),children:[m?"Hide":"Previous"," Receipts"]})]})})}),_&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{colSpan:8,children:["Bill Details of - ",null===d||void 0===d?void 0:d.Do_Inv_No]})}),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:8,className:"p-0",children:(0,h.jsx)("div",{className:"table-responsive fa-13 m-0",children:(0,h.jsxs)("table",{className:"table m-0",children:[(0,h.jsx)("thead",{children:(0,h.jsx)("tr",{children:["SNo","Item","Quantity","Rate","Pack","Tax","Amount"].map(((e,l)=>(0,h.jsx)("th",{className:"bg-light",children:e},l)))})}),(0,h.jsx)("tbody",{children:Array.isArray(null===d||void 0===d?void 0:d.Products_List)&&d.Products_List.map(((e,l)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:l+1}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.UOM}),(0,h.jsx)("td",{children:(0,i.Q5)(null===e||void 0===e?void 0:e.Cgst_Amo,null===e||void 0===e?void 0:e.Sgst_Amo)||(0,i.gH)(null===e||void 0===e?void 0:e.Igst_Amo)}),(0,h.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount})]},l)))})]})})})})]}),m&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{colSpan:8,children:["Previous Receipts of - ",null===d||void 0===d?void 0:d.Do_Inv_No]})}),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:8,className:"p-0 border-0",children:(0,h.jsx)("div",{className:"table-responsive fa-13",children:(0,h.jsxs)("table",{className:"table m-0",children:[(0,h.jsx)("thead",{children:(0,h.jsx)("tr",{children:["SNo","Collected By","Amount","Date","Receipt Type","payment_status","Verify Status"].map(((e,l)=>(0,h.jsx)("th",{className:"bg-light border",children:e},l)))})}),(0,h.jsx)("tbody",{children:null===(t=Array.isArray(null===d||void 0===d?void 0:d.Payments)?null===d||void 0===d?void 0:d.Payments:[])||void 0===t?void 0:t.filter((e=>!(0,i.Qr)(e.auto_id,null===d||void 0===d?void 0:d.auto_id))).map(((e,l)=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"border",children:l+1}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.CreatedByGet}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collected_amount}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_date}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,h.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.verify_status})]},l)))})]})})})}),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:8,className:"border-0"})})]})]})},_=[{type:"CASH",default:"CREATED-CASH",statusOptions:["CREATED-CASH","CASH-PROCESSING","CASH-MISSING"]},{type:"UPI",default:"CREATED-UPI",statusOptions:["CREATED-UPI","UPI-PROCESSING","UPI-NOT-RECEIVED"]},{type:"CHEQUE",default:"CREATED-CHEQUE",statusOptions:["CREATED-CHEQUE","CHEQUE-PROCESSING","CHEQUE-BOUNCE"]},{type:"BANK",default:"CREATED-BANK-TRANSFER",statusOptions:["CREATED-BANK-TRANSFER","BANK-PROCESSING","BANK-NOT-RECEIVED"]}],y=e=>{var l;let{loadingOn:s,loadingOff:x}=e;(0,i.gV)().user;const j=(0,u.i6)(),[y,N]=((0,u.IT)().state,new URLSearchParams((0,u.IT)().search),(0,r.useState)([])),[g,C]=(0,r.useState)([]),[f,S]=(0,r.useState)({salesPerson:[],voucherData:[],creditAccount:[]}),[A,R]=(0,r.useState)(v.Y),[I,E]=(0,r.useState)([]),[P,H]=(0,r.useState)({Fromdate:(0,i.Q7)(),Todate:(0,i.Q7)(),Retailer:{value:"",label:"Search by Retailer..."}}),D=(null===(l=_.find((e=>e.type===(null===A||void 0===A?void 0:A.collection_type))))||void 0===l?void 0:l.statusOptions)||{};(0,r.useEffect)((()=>{(0,o.q)({address:"receipt/getRetailersWhoHasBills"}).then((e=>{e.success?C(e.data):C([])})).catch((e=>console.error(e))),(0,o.q)({address:"masters/users/salesPerson/dropDown"}).then((e=>{e.success?S((l=>(0,a.c)((0,a.c)({},l),{},{salesPerson:e.data}))):S((e=>(0,a.c)((0,a.c)({},e),{},{salesPerson:[]})))})).catch((e=>console.error(e))),(0,o.q)({address:"masters/voucher"}).then((e=>{e.success?S((l=>(0,a.c)((0,a.c)({},l),{},{voucherData:e.data}))):S((e=>(0,a.c)((0,a.c)({},e),{},{voucherData:[]})))})).catch((e=>console.error(e))),(0,o.q)({address:"receipt/creditAccounts"}).then((e=>{e.success?S((l=>(0,a.c)((0,a.c)({},l),{},{creditAccount:e.data}))):S((e=>(0,a.c)((0,a.c)({},e),{},{creditAccount:[]})))})).catch((e=>console.error(e)))}),[]),(0,r.useEffect)((()=>{(0,i.Q$)(A.retailer_id)&&(s&&s(),(0,o.q)({address:"receipt/retailerBills?retailer_id=".concat(A.retailer_id)}).then((e=>{e.success?N(e.data):N([])})).catch((e=>console.error(e))).finally((()=>{x&&x()})))}),[A.retailer_id]);const T=(0,r.useMemo)((()=>I.reduce(((e,l)=>(0,i.Q5)(e,null===l||void 0===l?void 0:l.collected_amount)),0)),[I]),w=()=>{s&&s(),(0,o.q)({address:"receipt/collectionReceipts",method:(0,i.Q$)(A.collection_id)&&A.collection_id>0?"PUT":"POST",bodyData:(0,a.c)((0,a.c)({},A),{},{Collections:I})}).then((e=>{e.success?(m.m4.success((null===e||void 0===e?void 0:e.message)||"Receipt Created"),H((e=>(0,a.c)((0,a.c)({},e),{},{Retailer:{value:"",label:"Search by Retailer..."}}))),R(v.Y),E([]),N([])):m.m4.error((null===e||void 0===e?void 0:e.message)||"Failed to create Receipt")})).catch((e=>console.error(e))).finally((()=>{x&&x()}))};return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(t.c,{children:(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),w()},children:[(0,h.jsxs)("div",{className:"px-3 py-2 d-flex align-items-center",children:[(0,h.jsx)("h5",{className:"m-0 flex-grow-1",children:"Receipt Creation"}),(0,h.jsx)(c.c,{variant:"outlined",type:"button",className:"me-1",onClick:()=>j("/erp/receipts/listReceipts"),children:"Back"}),(0,h.jsx)(c.c,{variant:"outlined",type:"submit",disabled:0===I.length||I.every((e=>(0,i.gH)(e.collected_amount)<=0)),children:"save receipt"})]}),(0,h.jsxs)(d.c,{children:[(0,h.jsx)("label",{children:"Retailer"}),(0,h.jsx)("div",{className:"d-flex",children:(0,h.jsx)("div",{style:{width:"100%",maxWidth:"400px"},children:(0,h.jsx)(n.cp,{menuPortalTarget:document.body,options:[{value:"",label:"select",isDisabled:!0},...g.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],value:P.Retailer,menu:!0,onChange:e=>{H((l=>(0,a.c)((0,a.c)({},l),{},{Retailer:e}))),R((l=>(0,a.c)((0,a.c)({},l),{},{retailer_id:e.value})))},placeholder:"Search by Retailer"})})}),(0,h.jsxs)("div",{className:"row fa-13 pb-3 mt-2",children:[(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Date",(0,h.jsx)(p.c,{})]}),(0,h.jsx)("input",{type:"date",className:"cus-inpt border p-2",value:A.collection_date,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{collection_date:e.target.value}))),required:!0})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Voucher",(0,h.jsx)(p.c,{})]}),(0,h.jsxs)("select",{className:"cus-inpt border p-2",value:A.voucher_id,required:!0,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{voucher_id:e.target.value}))),children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select"}),f.voucherData.filter((e=>(0,i.m2)(e.Type,"Receipt"))).map(((e,l)=>(0,h.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})]})]}),(0,h.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Payment Type",(0,h.jsx)(p.c,{})]}),(0,h.jsxs)("select",{className:"cus-inpt border p-2",value:A.collection_type,required:!0,onChange:e=>R((l=>{var s;return(0,a.c)((0,a.c)({},l),{},{collection_type:e.target.value,payment_status:null===(s=_.find((l=>l.type===e.target.value)))||void 0===s?void 0:s.default})})),children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,h.jsx)("option",{value:"CASH",children:"CASH"}),(0,h.jsx)("option",{value:"UPI",children:"UPI"}),(0,h.jsx)("option",{value:"CHEQUE",children:"CHEQUE"}),(0,h.jsx)("option",{value:"BANK",children:"BANK"})]})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Payment Account ",(0,h.jsx)(p.c,{})]}),(0,h.jsxs)("select",{className:"cus-inpt border p-2",value:A.collection_account,required:!0,disabled:!A.collection_type,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{collection_account:e.target.value}))),children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select"}),f.creditAccount.filter((e=>(0,i.m2)(A.collection_type,"CASH")?(0,i.m2)(e.Type,"CASH"):!(0,i.m2)(e.Type,"CASH"))).map(((e,l)=>(0,h.jsx)("option",{value:null===e||void 0===e?void 0:e.Id,children:null===e||void 0===e?void 0:e.Bank_Name},l)))]})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Payment Status",(0,h.jsx)(p.c,{})]}),(0,h.jsxs)("select",{className:"cus-inpt border p-2",value:A.payment_status,required:!0,disabled:!A.collection_type,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{payment_status:e.target.value}))),children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select"}),D.map(((e,l)=>(0,h.jsx)("option",{value:e,children:e},l))),(0,h.jsx)("option",{value:"Completed",children:"Completed"})]})]})]}),(0,h.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsx)("label",{children:"Payed By"}),(0,h.jsx)("input",{className:"cus-inpt border p-2",value:A.payed_by,placeholder:"Owner, Shop Keeper..",onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{payed_by:e.target.value})))})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,h.jsxs)("label",{children:["Amount Received By",(0,h.jsx)(p.c,{})]}),(0,h.jsxs)("select",{className:"cus-inpt border p-2",value:A.collected_by,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{collected_by:e.target.value}))),required:!0,children:[(0,h.jsx)("option",{value:"",disabled:!0,children:"Select"}),f.salesPerson.map(((e,l)=>(0,h.jsx)("option",{value:e.UserId,children:e.Name},l)))]})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,h.jsx)("label",{className:"fa-14",children:"Verify Date"}),(0,h.jsx)("input",{type:"date",value:null!==A&&void 0!==A&&A.bank_date?null===A||void 0===A?void 0:A.bank_date:"",onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{bank_date:e.target.value}))),className:"cus-inpt border border p-2"})]}),(0,h.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,h.jsx)("label",{className:"fa-14",children:"Verify Status"}),(0,h.jsxs)("select",{value:null===A||void 0===A?void 0:A.verify_status,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{verify_status:e.target.value}))),className:"cus-inpt border border p-2",children:[(0,h.jsx)("option",{value:0,children:"Not-verified"}),(0,h.jsx)("option",{value:1,children:"verified"})]})]}),(0,h.jsxs)("div",{className:"col-lg-6 col-sm-8 p-1",children:[(0,h.jsx)("label",{className:"fa-14 w-100",children:"Narration"}),(0,h.jsx)("textarea",{style:{width:"100%",maxWidth:"450px"},className:"cus-inpt border p-2",value:null===A||void 0===A?void 0:A.narration,onChange:e=>R((l=>(0,a.c)((0,a.c)({},l),{},{narration:e.target.value}))),placeholder:"Narration..."})]}),(0,h.jsxs)("div",{className:"col-lg-6 col-sm-4 p-1 text-end",children:[(0,h.jsx)("label",{className:"fa-14 w-100",children:"Total Receipt Amount"}),(0,h.jsx)("input",{className:"cus-inpt bg-white p-2 w-auto border border-primary text-primary",value:(0,i.kR)(T),disabled:!0})]})]}),(0,h.jsx)("div",{className:"table-responsive",children:(0,h.jsxs)("table",{className:"table table-bordered",children:[(0,h.jsx)("thead",{children:(0,h.jsx)("tr",{children:["Sno","#","Invoice No","Date","Invoice Value","Paid","Pending","Receipts"].map(((e,l)=>(0,h.jsx)("th",{className:"bg-light fa-13 border",children:e},l)))})}),(0,h.jsx)("tbody",{children:y.map(((e,l)=>(0,h.jsx)(b,{row:e,Sno:l+1,receiptsPaymentInfo:I,setReceiptsPaymentInfo:E},l)))})]})})]})]})})})}},11364:(e,l,s)=>{s.d(l,{I:()=>d,Y:()=>c});var a=s(39308);const t=(0,a.gV)().user,c={collection_id:"",collection_inv_no:"",voucher_id:"",collection_no:"",year_id:"",retailer_id:"",payed_by:"",collection_date:(0,a.Q7)(),collection_type:"CASH",collection_account:"",payment_status:"",latitude:"",longitude:"",collected_by:"",total_amount:0,created_on:"",alterd_on:"",narration:"",verify_status:0,bank_date:"",created_by:t.UserId,updated_by:t.UserId,verified_by:t.UserId,verified_at:""},d={auto_id:"",collection_id:"",bill_id:"",bill_amount:0,collected_amount:0}},30796:(e,l,s)=>{s.d(l,{c:()=>c});var a=s(27664),t=s(82496);const c=(0,a.c)((0,t.jsx)("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List")},84436:(e,l,s)=>{s.d(l,{c:()=>x});var a=s(45072),t=s(95656),c=s(69060),d=s(79736),i=s(21412),o=s(12556),n=s(49836),r=s(10099),u=s(33448);function v(e){return(0,u.cp)("MuiCardContent",e)}(0,r.c)("MuiCardContent",["root"]);var h=s(82496);const m=["className","component"],p=(0,o.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=c.forwardRef((function(e,l){const s=(0,n.C)({props:e,name:"MuiCardContent"}),{className:c,component:o="div"}=s,r=(0,t.c)(s,m),u=(0,a.c)({},s,{component:o}),x=(e=>{const{classes:l}=e;return(0,i.c)({root:["root"]},v,l)})(u);return(0,h.jsx)(p,(0,a.c)({as:o,className:(0,d.c)(x.root,c),ownerState:u,ref:l},r))}))}}]);
//# sourceMappingURL=8184.00ed0e63.chunk.js.map