"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8105],{48105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var s=a(30800),c=a(69060),r=a(1908),d=a(5548),o=a(82656),n=a(26773),l=a(4488),i=a(44380),u=a(90048),m=a(57704),h=a(86e3),_=a(45180),x=a(51560),p=a(56480),v=a(13724),D=a(42136),j=a(39308),g=a(85592),w=a.n(g),I=a(26592),N=a(82496);const b={Fromdate:(0,j.Q7)(),NewDate:""},R=e=>{const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(c)};const S=function(){var e;const[t,a]=(0,c.useState)({Fromdate:b.Fromdate,fetchFrom:b.Fromdate,NewDate:b.NewDate,fetchNew:b.NewDate}),[g,S]=(0,c.useState)(!1),[f,P]=(0,c.useState)({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),[F,C]=(0,c.useState)(!1),[B,y]=(0,c.useState)([]),[A,k]=(0,c.useState)([]),[E,O]=(0,c.useState)([]),T=(0,x.i6)(),M=(0,x.IT)(),q=new URLSearchParams((0,x.IT)().search),[W,L]=(0,c.useState)(""),[U,z]=(0,c.useState)([]),[H,Q]=(0,c.useState)(!1),[V,Y]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const e={Fromdate:q.get("Fromdate")&&(0,j.e8)(q.get("Fromdate"))?q.get("Fromdate"):b.Fromdate,NewDate:q.get("NewDate")&&(0,j.e8)(q.get("NewDate"))?q.get("NewDate"):b.NewDate};a((t=>(0,s.c)((0,s.c)({},t),{},{fetchFrom:e.Fromdate,fetchNew:e.NewDate})))}),[M.search]),(0,c.useEffect)((()=>{(0,r.q)({address:"masters/posRateMaster?FromDate=".concat(null===t||void 0===t?void 0:t.Fromdate)}).then((e=>{e.success&&(z(e),O(e.data))})).catch((e=>console.error(e))),(0,r.q)({address:"masters/posbranch/dropdown"}).then((e=>{e.success&&y(e.data)})).catch((e=>console.error(e)))}),[t.Fromdate,H]),(0,c.useEffect)((()=>{W&&(async e=>{(0,r.q)({address:"masters/posbrand/productList?Pos_Brand_Id=".concat(e)}).then((e=>{e.success&&k(e.data)})).catch((e=>console.error(e)))})(W)}),[W]),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:"date-inputs",children:(0,N.jsxs)("div",{className:"p-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,N.jsxs)("h5",{className:"m-0 my-1 flex-grow-1 d-flex align-items-center flex-wrap",children:[(0,N.jsx)("span",{className:"mx-2",children:"Rate Master"}),(0,N.jsx)(D.c,{onClick:()=>Y(!0),children:"Export To"}),(0,N.jsx)(D.c,{className:"mx-2 btn btn-dark",style:{outline:"none",boxShadow:"none"},onClick:async()=>{const e=E.reduce(((e,t)=>{const{Pos_Brand_Id:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{});const t=new(w().Workbook),a=t.addWorksheet("PriceList_Data");a.addRow(["Date","Product_Name","Rate"]).font={bold:!0};const s=[],c=E.length>0?E[0].Rate_Date.split("T")[0]:"";let r=!0;Object.entries(e).forEach((e=>{let[t,d]=e;r?(a.addRow([c,d[0].POS_Brand_Name,""]),r=!1):a.addRow(["",d[0].POS_Brand_Name,""]),s.push(a.rowCount),d.forEach((e=>{a.addRow(["",e.Product_Name,e.Rate])}))})),a.columns=[{width:15},{width:40},{width:15}],s.forEach((e=>{const t=a.getRow(e).getCell(2);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}},t.font={bold:!0}}));const d=await t.xlsx.writeBuffer(),o=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,I.saveAs)(o,"PriceList_Data.xlsx")},children:"Download Excel"})]}),(0,N.jsx)("div",{children:(0,N.jsx)("input",{type:"date",value:t.Fromdate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{Fromdate:c,fetchFrom:c}))},className:"cus-inpt w-auto p-1"})}),(0,N.jsx)(d.c,{onClick:()=>{(e=>{const t=new URLSearchParams(e);T("?".concat(t.toString()),{replace:!0})})({Fromdate:null===t||void 0===t?void 0:t.Fromdate})},variant:"outlined",size:"small",children:(0,N.jsx)(m.c,{})}),(0,N.jsx)(D.c,{onClick:()=>S(!0),children:"Add"})]})}),(0,N.jsx)(v.cp,{dataArray:E,EnableSerialNumber:!0,isExpendable:!0,maxHeightOption:!0,columns:[(0,v.A5)("Rate_Date","date","Rate Date"),(0,v.A5)("POS_Brand_Name","string","Brand"),(0,v.A5)("Product_Name","string","Product"),(0,v.A5)("Rate","string","Rate"),{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,N.jsxs)("td",{style:{minWidth:"80px"},children:[(0,N.jsx)(d.c,{onClick:()=>{return e=t,S(!0),P({Id:null===e||void 0===e?void 0:e.Id,Rate_Date:R(e.Rate_Date),Pos_Brand_Id:e.Pos_Brand_Id,Item_Id:e.Item_Id,Rate:e.Rate,Is_Active_Decative:e.Is_Active_Decative,POS_Brand_Name:e.POS_Brand_Name,Product_Name:e.Product_Name}),void L(e.Pos_Brand_Id);var e},size:"small",children:(0,N.jsx)(h.c,{className:"fa-in"})}),(0,N.jsx)(d.c,{onClick:()=>{C(!0),P({Id:t.Id})},size:"small",color:"error",children:(0,N.jsx)(_.c,{className:"fa-in "})})]})}}]}),(0,N.jsxs)(o.c,{open:g,onClose:()=>S(!1),fullWidth:!0,maxWidth:"sm",children:[(0,N.jsxs)(n.c,{children:[f.Id?"UPDATE":"CREATE"," RATE MASTER"]}),(0,N.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f.Id?(0,r.q)({address:"masters/posRateMaster",method:"PUT",bodyData:(0,s.c)((0,s.c)({},f),{},{Rate_Date:R(f.Rate_Date)})}).then((e=>{e.success?(p.m4.success("Rate Master updated successfully!"),S(!1),Q(!H),P({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),L("")):p.m4.error("Failed to update Rate Master:",e.message)})).catch((e=>{throw e})):(0,r.q)({address:"masters/posRateMaster",method:"POST",bodyData:(0,s.c)((0,s.c)({},f),{},{Pos_Brand_Id:W,Item_Id:f.Item_Id,Rate_Date:R(f.Rate_Date)})}).then((e=>{e.success?(S(!1),p.m4.success(e.message),P({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),L(""),Q(!H)):p.m4.error(e.message)})).catch((e=>console.error(e)))},children:[(0,N.jsxs)(l.c,{children:[(0,N.jsx)("label",{children:"Rate Date"}),(0,N.jsx)("input",{type:"date",value:f.Rate_Date,onChange:e=>P((0,s.c)((0,s.c)({},f),{},{Rate_Date:e.target.value})),className:"cus-inpt"}),(0,N.jsx)("label",{children:"POS Brand"}),(0,N.jsxs)("select",{value:W,onChange:e=>{const t=e.target.value;L(t),P((0,s.c)((0,s.c)({},f),{},{Pos_Brand_Id:t})),console.log("Selected POS Brand:",t)},className:"cus-inpt",children:[(0,N.jsx)("option",{value:"",disabled:!0,children:"Select POS Brand"}),B.map(((e,t)=>(0,N.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,N.jsx)("label",{children:"Product"}),(0,N.jsxs)("select",{className:"cus-inpt",disabled:!W,value:f.Item_Id,onChange:e=>{P((0,s.c)((0,s.c)({},f),{},{Item_Id:e.target.value}))},children:[(0,N.jsx)("option",{value:"",disabled:!0,children:"Select Product"}),A.length>0?A.map(((e,t)=>(0,N.jsx)("option",{value:e.value,children:e.label},t))):(0,N.jsx)("option",{value:"",disabled:!0,children:"No products available"})]}),(0,N.jsx)("label",{children:"Rate"}),(0,N.jsx)(i.c,{label:"",value:null!==(e=f.Rate)&&void 0!==e?e:"",onChange:e=>P((0,s.c)((0,s.c)({},f),{},{Rate:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,N.jsx)("label",{children:"Status"}),(0,N.jsxs)("select",{value:f.Is_Active_Decative,onChange:e=>P((0,s.c)((0,s.c)({},f),{},{Is_Active_Decative:e.target.value})),children:[(0,N.jsx)("option",{value:"0",children:"Active"}),(0,N.jsx)("option",{value:"1",children:"Inactive"})]})]}),(0,N.jsxs)(u.c,{children:[(0,N.jsx)(D.c,{onClick:()=>S(!1),children:"Cancel"}),(0,N.jsx)(D.c,{type:"submit",variant:"contained",children:"Save"})]})]})]}),(0,N.jsxs)(o.c,{open:F,onClose:()=>C(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,N.jsx)(n.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,N.jsx)(l.c,{children:(0,N.jsx)("b",{children:"Do you want to delete the RateMaster?"})}),(0,N.jsxs)(u.c,{children:[(0,N.jsx)(D.c,{onClick:()=>C(!1),children:"Cancel"}),(0,N.jsx)(D.c,{onClick:()=>(f.Id,void(0,r.q)({address:"masters/posRateMaster",method:"DELETE",bodyData:{Id:f.Id}}).then((e=>{e.success?(Q(!H),C(!1),S(!1),P({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"0",POS_Brand_Name:"",Product_Name:""}),L(""),p.m4.success("Rate Master deleted successfully!")):p.m4.error("Failed to delete area:",e.message)})).catch((e=>console.error(e)))),autoFocus:!0,color:"error",children:"Delete"})]})]}),(0,N.jsxs)(o.c,{open:V,onClose:()=>Y(!1),fullWidth:!0,maxWidth:"sm",children:[(0,N.jsx)(n.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,N.jsx)(l.c,{children:(0,N.jsxs)("b",{children:["Do you want to export data from:",(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"From Date"}),(0,N.jsx)("input",{type:"date",disabled:!0,value:t.Fromdate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{Fromdate:c,fetchFrom:c}))},className:"cus-inpt w-auto p-1"})]}),(0,N.jsx)("br",{}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"New Date"}),(0,N.jsx)("input",{type:"date",value:t.NewDate,onChange:e=>{const c=e.target.value;a((0,s.c)((0,s.c)({},t),{},{NewDate:c}))},className:"cus-inpt w-auto p-1"})]})]})}),(0,N.jsxs)(u.c,{children:[(0,N.jsx)(D.c,{onClick:()=>Y(!1),children:"Cancel"}),(0,N.jsx)(D.c,{onClick:()=>(async()=>{if(null===t||void 0===t||!t.Fromdate||null===t||void 0===t||!t.NewDate)throw new Error("Both 'From Date' and 'New Date' are required.");(0,r.q)({address:"masters/exportRateMaster?FromDate=".concat(null===t||void 0===t?void 0:t.Fromdate,"&NewDate=").concat(null===t||void 0===t?void 0:t.NewDate),method:"POST",bodyData:{bulkData:U}}).then((e=>{e.success?(p.m4.success(e.message),Y(!1)):p.m4.error(e.message)})).catch((e=>console.error(e)))})(),autoFocus:!0,color:"primary",children:"Export"})]})]})]})}}}]);
//# sourceMappingURL=8105.b6f6910e.chunk.js.map