"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8105],{48105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var s=a(69060),r=a(1908),l=a(3358),d=a(5548),n=a(82656),o=a(26773),c=a(4488),i=a(44380),u=a(90048),m=a(87016),h=a(57704),x=a(86e3),_=a(45180),v=a(51560),p=a(56480),D=a(13724),j=a(42136),g=a(39308),I=a(73380),R=a.n(I),w=a(85592),N=a.n(w),b=a(26592),f=a(82496);const S={Fromdate:(0,g.Q7)(),NewDate:""},C=e=>{const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`};const F=function(e){var t,a;let{loadingOn:I,loadingOff:w}=e;const[F,P]=(0,s.useState)({Fromdate:S.Fromdate,fetchFrom:S.Fromdate,NewDate:S.NewDate,fetchNew:S.NewDate}),[A,y]=(0,s.useState)(!1),[M,B]=(0,s.useState)({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),[k,O]=(0,s.useState)(!1),[E,T]=(0,s.useState)([]),[q,W]=(0,s.useState)([]),[Y,$]=(0,s.useState)([]),L=(0,v.i6)(),z=(0,v.IT)(),H=new URLSearchParams((0,v.IT)().search),[U,V]=(0,s.useState)(""),[Q,G]=(0,s.useState)([]),[J,K]=(0,s.useState)(!1),[X,Z]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const e={Fromdate:H.get("Fromdate")&&(0,g.e8)(H.get("Fromdate"))?H.get("Fromdate"):S.Fromdate,NewDate:H.get("NewDate")&&(0,g.e8)(H.get("NewDate"))?H.get("NewDate"):S.NewDate};P((t=>({...t,fetchFrom:e.Fromdate,fetchNew:e.NewDate})))}),[z.search]),(0,s.useEffect)((()=>{(0,r.q)({address:`masters/posRateMaster?FromDate=${null===F||void 0===F?void 0:F.Fromdate}`}).then((e=>{e.success&&(G(e),$(e.data))})).catch((e=>console.error(e))),(0,r.q)({address:"masters/posbranch/dropdown"}).then((e=>{e.success&&T(e.data)})).catch((e=>console.error(e)))}),[F.Fromdate,J]),(0,s.useEffect)((()=>{U&&(async e=>{(0,r.q)({address:`masters/posbrand/productList?Pos_Brand_Id=${e}`}).then((e=>{e.success&&W(e.data)})).catch((e=>console.error(e)))})(U)}),[U]),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"date-inputs",children:(0,f.jsxs)("div",{className:"p-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,f.jsxs)("h5",{className:"m-0 my-1 flex-grow-1 d-flex align-items-center flex-wrap",children:[(0,f.jsx)("span",{className:"mx-2",children:"Rate Master"}),(0,f.jsx)(j.c,{onClick:()=>Z(!0),children:"Export To"}),(0,f.jsx)(j.c,{className:"mx-2 btn btn-dark",style:{outline:"none",boxShadow:"none"},onClick:async()=>{const e=Y.filter((e=>1===e.Is_Active_Decative));if(0===e.length)return void alert("No active data available for download.");const t=e.reduce(((e,t)=>{const{Pos_Brand_Id:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{});const a=new(N().Workbook),s=a.addWorksheet("PriceList_Data"),r=e.length>0?e[0].Rate_Date.split("T")[0].split("-").reverse().join("-"):"";s.addRow([r,"PriceList"]).font={bold:!0,size:14},Object.entries(t).forEach((e=>{let[t,a]=e;const r=s.addRow([a[0].POS_Brand_Name]).getCell(1);r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}},r.font={bold:!0,size:12},a.forEach((e=>{s.addRow([e.Short_Name,e.Max_Rate])}))})),s.columns=[{width:40},{width:15}];const l=await a.xlsx.writeBuffer(),d=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,b.saveAs)(d,"PriceList_Data.xlsx")},children:"Download Excel"})]}),(0,f.jsx)(l.c,{title:"Sync Data",children:(0,f.jsx)(d.c,{onClick:()=>{(0,r.q)({address:"masters/posproductSync"}).then((e=>{e&&p.m4.success(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e)))},children:(0,f.jsx)(m.c,{})})}),(0,f.jsx)("div",{children:(0,f.jsx)("input",{type:"date",value:F.Fromdate,onChange:e=>{const t=e.target.value;P({...F,Fromdate:t,fetchFrom:t})},className:"cus-inpt w-auto p-1"})}),(0,f.jsx)(d.c,{onClick:()=>{(e=>{const t=new URLSearchParams(e);L(`?${t.toString()}`,{replace:!0})})({Fromdate:null===F||void 0===F?void 0:F.Fromdate})},variant:"outlined",size:"small",children:(0,f.jsx)(h.c,{})}),(null===F||void 0===F?void 0:F.Fromdate)===R()().format("YYYY-MM-DD")?(0,f.jsx)(j.c,{onClick:()=>y(!0),children:"Add"}):null]})}),(0,f.jsx)(D.cp,{dataArray:Y,EnableSerialNumber:!0,isExpendable:!0,maxHeightOption:!0,columns:[(0,D.A5)("Rate_Date","date","Rate Date"),(0,D.A5)("POS_Brand_Name","string","Brand"),(0,D.A5)("Short_Name","string","Product"),(0,D.A5)("Rate","string","Rate"),(0,D.A5)("Max_Rate","string","MaxRate"),{Field_Name:"Is_Active_Decative",ColumnHeader:"Status",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;const a=1===t.Is_Active_Decative?"Active":"Inactive";return(0,f.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 text-white",style:{backgroundColor:"Active"===a?"green":"red"},children:a})}},(null===F||void 0===F?void 0:F.Fromdate)===R()().format("YYYY-MM-DD")?{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,f.jsxs)("td",{style:{minWidth:"80px"},children:[(0,f.jsx)(d.c,{onClick:()=>{return e=t,y(!0),B({Id:null===e||void 0===e?void 0:e.Id,Rate_Date:C(e.Rate_Date),Pos_Brand_Id:e.Pos_Brand_Id,Item_Id:e.Item_Id,Rate:e.Rate,MaxRate:e.Max_Rate,Is_Active_Decative:e.Is_Active_Decative,POS_Brand_Name:e.POS_Brand_Name,Product_Name:e.Product_Name}),void V(e.Pos_Brand_Id);var e},size:"small",children:(0,f.jsx)(x.c,{className:"fa-in"})}),(0,f.jsx)(d.c,{onClick:()=>{O(!0),B({Id:t.Id})},size:"small",color:"error",children:(0,f.jsx)(_.c,{className:"fa-in "})})]})}}:{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,f.jsx)("td",{children:"-"})}}]}),(0,f.jsxs)(n.c,{open:A,onClose:()=>y(!1),fullWidth:!0,maxWidth:"sm",children:[(0,f.jsxs)(o.c,{children:[M.Id?"UPDATE":"CREATE"," RATE MASTER"]}),(0,f.jsxs)("form",{onSubmit:e=>{e.preventDefault(),M.Id?(0,r.q)({address:"masters/posRateMaster",method:"PUT",bodyData:{...M,Rate_Date:C(M.Rate_Date)}}).then((e=>{e.success?(p.m4.success("Rate Master updated successfully!"),y(!1),K(!J),B({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),V("")):p.m4.error("Failed to update Rate Master:",e.message)})).catch((e=>{throw e})):(0,r.q)({address:"masters/posRateMaster",method:"POST",bodyData:{...M,Pos_Brand_Id:U,Item_Id:M.Item_Id,Rate_Date:C(M.Rate_Date)}}).then((e=>{e.success?(y(!1),p.m4.success(e.message),B({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"-",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),V(""),K(!J)):p.m4.error(e.message)})).catch((e=>console.error(e)))},children:[(0,f.jsxs)(c.c,{children:[(0,f.jsx)("label",{children:"Rate Date"}),(0,f.jsx)("input",{type:"date",value:M.Rate_Date,onChange:e=>B({...M,Rate_Date:e.target.value}),className:"cus-inpt"}),(0,f.jsx)("label",{children:"POS Brand"}),(0,f.jsxs)("select",{value:U,onChange:e=>{const t=e.target.value;V(t),B({...M,Pos_Brand_Id:t})},className:"cus-inpt",children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Select POS Brand"}),E.map(((e,t)=>(0,f.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,f.jsx)("label",{children:"Product"}),(0,f.jsxs)("select",{className:"cus-inpt",disabled:!U,value:M.Item_Id,onChange:e=>{B({...M,Item_Id:e.target.value})},children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Select Product"}),q.length>0?q.map(((e,t)=>(0,f.jsx)("option",{value:e.value,children:e.label},t))):(0,f.jsx)("option",{value:"",disabled:!0,children:"No products available"})]}),(0,f.jsx)("label",{children:"Rate"}),(0,f.jsx)(i.c,{label:"",value:null!==(t=M.Rate)&&void 0!==t?t:"",onChange:e=>B({...M,Rate:e.target.value}),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,f.jsx)("label",{children:"Max Rate"}),(0,f.jsx)(i.c,{label:"",value:null!==(a=M.MaxRate)&&void 0!==a?a:"",onChange:e=>B({...M,MaxRate:e.target.value}),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,f.jsx)("label",{children:"Status"}),(0,f.jsxs)("select",{className:"cus-inpt",value:M.Is_Active_Decative,onChange:e=>B({...M,Is_Active_Decative:e.target.value}),children:[(0,f.jsx)("option",{value:"",disabled:!0,children:"Select "}),(0,f.jsx)("option",{value:"1",children:"Active"}),(0,f.jsx)("option",{value:"0",children:"Inactive"})]})]}),(0,f.jsxs)(u.c,{children:[(0,f.jsx)(j.c,{onClick:()=>{B({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),y(!1)},children:"Cancel"}),(0,f.jsx)(j.c,{type:"submit",variant:"contained",children:"Save"})]})]})]}),(0,f.jsxs)(n.c,{open:k,onClose:()=>O(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,f.jsx)(o.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,f.jsx)(c.c,{children:(0,f.jsx)("b",{children:"Do you want to delete the RateMaster?"})}),(0,f.jsxs)(u.c,{children:[(0,f.jsx)(j.c,{onClick:()=>O(!1),children:"Cancel"}),(0,f.jsx)(j.c,{onClick:()=>(M.Id,void(0,r.q)({address:"masters/posRateMaster",method:"DELETE",bodyData:{Id:M.Id}}).then((e=>{e.success?(K(!J),O(!1),y(!1),B({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),V(""),p.m4.success("Rate Master deleted successfully!")):p.m4.error("Failed to delete area:",e.message)})).catch((e=>console.error(e)))),autoFocus:!0,color:"error",children:"Delete"})]})]}),(0,f.jsxs)(n.c,{open:X,onClose:()=>Z(!1),fullWidth:!0,maxWidth:"sm",children:[(0,f.jsx)(o.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,f.jsx)(c.c,{children:(0,f.jsxs)("b",{children:["Do you want to export data from:",(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{children:"From Date"}),(0,f.jsx)("input",{type:"date",disabled:!0,value:F.Fromdate,onChange:e=>{const t=e.target.value;P({...F,Fromdate:t,fetchFrom:t})},className:"cus-inpt w-auto p-1"})]}),(0,f.jsx)("br",{}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{children:"New Date"}),(0,f.jsx)("input",{type:"date",value:F.NewDate,onChange:e=>{const t=e.target.value;P({...F,NewDate:t})},className:"cus-inpt w-auto p-1"})]})]})}),(0,f.jsxs)(u.c,{children:[(0,f.jsx)(j.c,{onClick:()=>Z(!1),children:"Cancel"}),(0,f.jsx)(j.c,{onClick:()=>(async()=>{if(I&&I(),null===F||void 0===F||!F.Fromdate||null===F||void 0===F||!F.NewDate)throw new Error("Both 'From Date' and 'New Date' are required.");(0,r.q)({address:`masters/exportRateMaster?FromDate=${null===F||void 0===F?void 0:F.Fromdate}&NewDate=${null===F||void 0===F?void 0:F.NewDate}`,method:"POST",bodyData:{bulkData:Q}}).then((e=>{e.success?(p.m4.success(e.message),Z(!1),P({...F,NewDate:""})):p.m4.error(e.message)})).catch((e=>console.error(e))).finally((()=>{w&&w()}))})(),autoFocus:!0,color:"primary",children:"Export"})]})]})]})}}}]);
//# sourceMappingURL=8105.a08d0653.chunk.js.map