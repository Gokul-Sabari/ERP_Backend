"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[120],{20120:(e,a,o)=>{o.r(a),o.d(a,{default:()=>S});var t=o(69060),l=o(51560),n=o(1908),r=o(13724),i=o(39308),d=o(82656),s=o(26773),c=o(4488),u=o(90048),v=o(89e3),g=o(10728),h=o(76491),m=o(61988),T=o(57704),p=o(82496);const D={Fromdate:(0,i.Q7)(),Todate:(0,i.Q7)()},S=e=>{let{loadingOn:a,loadingOff:o}=e;const S=(0,l.i6)(),f=(0,l.IT)(),x=new URLSearchParams((0,l.IT)().search),[j,y]=(0,t.useState)([]),[C,F]=(0,t.useState)({Fromdate:D.Fromdate,Todate:D.Todate,fetchFrom:D.Fromdate,fetchTo:D.Todate,filterDialog:!1,refresh:!1,disablePagination:!1,searchString:"",searchCategory:""});(0,t.useEffect)((()=>{a&&a(),(0,n.q)({address:`dataEntry/costCenter/report?Fromdate=${C.fetchFrom}&Todate=${C.fetchTo}`}).then((e=>{e.success?y(e.data):y([])})).catch((e=>console.error(e))).finally((()=>{o&&o()}))}),[C.fetchFrom,C.fetchTo]),(0,t.useEffect)((()=>{const e={Fromdate:x.get("Fromdate")&&(0,i.e8)(x.get("Fromdate"))?x.get("Fromdate"):D.Fromdate,Todate:x.get("Todate")&&(0,i.e8)(x.get("Todate"))?x.get("Todate"):D.Todate};F((a=>({...a,fetchFrom:e.Fromdate,fetchTo:e.Todate})))}),[f.search]);const b=(0,t.useMemo)((()=>{const e=[...j].filter((e=>C.searchString?(0,i.MP)(Object.values(e).join(" ")).includes((0,i.MP)(C.searchString)):!C.searchCategory||(0,i.MP)(e.CostType||"").includes((0,i.MP)(C.searchCategory||""))));return(0,i.ui)(e,"UserId").map((e=>{var a,o,t,l,n,r,d,s,c,u;return{...e,Name:null!==e&&void 0!==e&&e.groupedData[0]?null===e||void 0===e||null===(a=e.groupedData[0])||void 0===a?void 0:a.Name:" - ",Tonnage:null===e||void 0===e||null===(o=e.groupedData)||void 0===o?void 0:o.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),StockJournalTonnage:null===e||void 0===e||null===(t=e.groupedData)||void 0===t||null===(l=t.filter((e=>(0,i.MP)(e.DataFrom)===(0,i.MP)("Stock Journal"))))||void 0===l?void 0:l.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),TripSheetTonnage:null===e||void 0===e||null===(n=e.groupedData)||void 0===n||null===(r=n.filter((e=>(0,i.MP)(e.DataFrom)===(0,i.MP)("Trip Sheet"))))||void 0===r?void 0:r.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),Invoices:null!==(d=null===e||void 0===e||null===(s=e.groupedData)||void 0===s?void 0:s.length)&&void 0!==d?d:0,DayTransactions:Array.isArray(null===e||void 0===e?void 0:e.groupedData)?(0,i.ui)(null===e||void 0===e?void 0:e.groupedData,"EventDate").sort(((e,a)=>new Date(e.EventDate)-new Date(a.EventDate))):[],StaffInvoices:(0,i.Q$)(null===e||void 0===e||null===(c=e.groupedData)||void 0===c?void 0:c.length)?null===e||void 0===e||null===(u=e.groupedData)||void 0===u?void 0:u.length:0}})).map((e=>{var a;return{...e,DayTransactions:null===e||void 0===e||null===(a=e.DayTransactions)||void 0===a?void 0:a.map((e=>{var a,o,t,l,n,r,d;return{...e,TotalTonnage:null===e||void 0===e||null===(a=e.groupedData)||void 0===a?void 0:a.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),StockJournalTonnage:null===e||void 0===e||null===(o=e.groupedData)||void 0===o||null===(t=o.filter((e=>(0,i.MP)(e.DataFrom)===(0,i.MP)("Stock Journal"))))||void 0===t?void 0:t.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),TripSheetTonnage:null===e||void 0===e||null===(l=e.groupedData)||void 0===l||null===(n=l.filter((e=>(0,i.MP)(e.DataFrom)===(0,i.MP)("Trip Sheet"))))||void 0===n?void 0:n.reduce(((e,a)=>(0,i.Q5)(e,null===a||void 0===a?void 0:a.TotalTonnage)),0),DayInvoices:(0,i.Q$)(null===e||void 0===e||null===(r=e.groupedData)||void 0===r?void 0:r.length)?null===e||void 0===e||null===(d=e.groupedData)||void 0===d?void 0:d.length:0}}))}}))}),[null===j||void 0===j?void 0:j.length,C.searchString,C.searchCategory]),P=(0,t.useMemo)((()=>[...new Set(j.map((e=>e.CostType)))]),[j]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.cp,{title:"Cost Center Report",dataArray:b,columns:[(0,r.A5)("Name","string","Name"),(0,r.A5)("StockJournalTonnage","number","Stock Journal"),(0,r.A5)("TripSheetTonnage","number","Trip Sheet"),(0,r.A5)("Tonnage","number","Total"),(0,r.A5)("Invoices","number","Invoices")],MenuButtons:[{name:"Pagination",icon:C.disablePagination?(0,p.jsx)(g.c,{fontSize:"small"}):(0,p.jsx)(h.c,{fontSize:"small",color:"primary"}),onclick:()=>F((e=>({...e,disablePagination:!e.disablePagination})))},{name:"Filters",icon:(0,p.jsx)(m.c,{fontSize:"small",color:"primary"}),onclick:()=>F((e=>({...e,filterDialog:!0})))}],isExpendable:!0,expandableComp:e=>{let{row:a}=e;return(0,p.jsx)(r.cp,{title:(null===a||void 0===a?void 0:a.Name)+"'s Activity",dataArray:Array.isArray(null===a||void 0===a?void 0:a.DayTransactions)?null===a||void 0===a?void 0:a.DayTransactions:[],columns:[(0,r.A5)("EventDate","date","Date"),(0,r.A5)("StockJournalTonnage","number","Stock Journal"),(0,r.A5)("TripSheetTonnage","number","Trip Sheet"),(0,r.A5)("TotalTonnage","number","Total"),{isVisible:1,ColumnHeader:"Invoices",isCustomCell:!0,Cell:e=>{let{row:a}=e;return null===a||void 0===a?void 0:a.DayInvoices}}],EnableSerialNumber:!0})},ButtonArea:(0,p.jsx)("input",{className:"cus-inpt p-2 fa-13 w-auto",type:"search",value:C.searchString,onChange:e=>F((a=>({...a,searchString:e.target.value}))),placeholder:"Search..."}),EnableSerialNumber:!0,headerFontSizePx:13,bodyFontSizePx:13}),(0,p.jsxs)(d.c,{open:C.filterDialog,onClose:()=>F((e=>({...e,filterDialog:!e.filterDialog}))),maxWidth:"sm",fullWidth:!0,children:[(0,p.jsx)(s.c,{children:"Filters"}),(0,p.jsx)(c.c,{children:(0,p.jsx)("div",{className:"table-responsive",children:(0,p.jsx)("table",{className:"table fa-16 table-borderless",children:(0,p.jsxs)("tbody",{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"From Date"}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"date",value:C.Fromdate,onChange:e=>F({...C,Fromdate:e.target.value}),className:"cus-inpt"})})]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"To Date"}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"date",value:C.Todate,onChange:e=>F({...C,Todate:e.target.value}),className:"cus-inpt"})})]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"Cost Category"}),(0,p.jsx)("td",{children:(0,p.jsxs)("select",{className:"cus-inpt",value:C.searchCategory,onChange:e=>{F((a=>({...a,searchCategory:e.target.value})))},children:[(0,p.jsx)("option",{value:"",children:"All Category"}),P.map(((e,a)=>(0,p.jsx)("option",{value:e,children:e},a)))]})})]})]})})})}),(0,p.jsxs)(u.c,{children:[(0,p.jsx)(v.c,{size:"small",onClick:()=>F((e=>({...e,filterDialog:!1}))),children:"Close"}),(0,p.jsx)(v.c,{onClick:()=>{const e={Fromdate:null===C||void 0===C?void 0:C.Fromdate,Todate:null===C||void 0===C?void 0:C.Todate,filterDialog:!1};F((a=>({...a,...e}))),(e=>{const a=new URLSearchParams(e);S(`?${a.toString()}`,{replace:!0})})(e)},variant:"outlined",size:"small",startIcon:(0,p.jsx)(T.c,{}),children:"Search"})]})]})]})}},61988:(e,a,o)=>{o.d(a,{c:()=>n});var t=o(27664),l=o(82496);const n=(0,t.c)((0,l.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},57704:(e,a,o)=>{o.d(a,{c:()=>n});var t=o(27664),l=o(82496);const n=(0,t.c)((0,l.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=120.a46bcec9.chunk.js.map