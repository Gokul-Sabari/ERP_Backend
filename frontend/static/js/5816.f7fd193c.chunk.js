"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5816],{64568:(e,l,a)=>{a.d(l,{c:()=>s});var t=a(82496);const s=()=>(0,t.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},128:(e,l,a)=>{a.d(l,{O:()=>s});var t=a(39308);const s=function(e,l){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"add";const s=(0,t.gH)(e),d=(0,t.gH)(l),r=d/2;let i,n,o,c;if("zerotax"===a)i=s,n=0,o=s,c=s;else if("add"===a)n=s*d/100,i=s,o=s+n,c=s;else{if("remove"!==a)throw new Error("Invalid type. Use 'add', 'remove', or 'zerotax'.");i=s/(1+d/100),n=s-i,o=s,c=i}const u=(n/2).toFixed(2),m=(n/2).toFixed(2),h=n.toFixed(2);return{base_amount:Number(i).toFixed(2),with_tax:Number(o).toFixed(2),without_tax:Number(c).toFixed(2),tax_per:Number(d),tax_amount:Number(n).toFixed(2),sgst_per:Number(r),sgst_amount:Number(u),cgst_per:Number(r),cgst_amount:Number(m),igst_per:Number(d),igst_amount:Number(h),type:a}}},91164:(e,l,a)=>{a.d(l,{c:()=>w});var t=a(69060),s=a(3358),d=a(5548),r=a(43692),i=a(78092),n=a(84436),o=a(82656),c=a(26773),u=a(4488),m=a(90048),h=a(89e3),v=a(99852),x=a(62344),b=a(39308),_=a(71412),g=a(86e3),j=a(45180),p=a(61988),N=a(1908),S=a(13724),I=a(56480),y=(a(21680),a(55312)),f=a(14499),T=a(49608),C=a(33452),D=a(82496);const P=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:return(0,b.kR)(e*(l/100));case 1:return(0,b.kR)(e-e*(100/(100+l)));default:return 0}},A=e=>{let{orderDetails:l,orderProducts:a,download:s,actionOpen:d,clearDetails:r,children:i,TitleText:n}=e;const[v,x]=(0,t.useState)("A5"),_={width:"200mm",minHeight:"290mm",padding:"10mm",backgroundColor:"#fff",fontSize:"7px",boxSizing:"border-box",boxShadow:"0 0 5mm rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",lineHeight:1.2,display:"flex",flexDirection:"column",flexGrow:1,margin:"0 auto"},g={width:"200mm",minHeight:"146mm",padding:"8mm",backgroundColor:"#fff",fontSize:"5px",boxSizing:"border-box",boxShadow:"0 0 5mm rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",lineHeight:1,display:"flex",flexDirection:"column",flexGrow:1,margin:"0 auto"},j=JSON.parse(localStorage.getItem("user")),[p,S]=(0,t.useState)(!1),[I,y]=(0,t.useState)({}),[A,w]=(0,t.useState)({}),G=(0,t.useRef)(null),R=(0,b.Qr)(l.GST_Inclusive,0),B=(0,b.Qr)(l.GST_Inclusive,1),F=(0,b.Qr)(l.GST_Inclusive,2),Q=(0,b.Qr)(l.IS_IGST,1);(0,t.useEffect)((()=>{(0,N.q)({address:`masters/company?Company_id=${null===j||void 0===j?void 0:j.Company_id}`}).then((e=>{e.success&&w(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})})).catch((e=>console.error(e)))}),[null===j||void 0===j?void 0:j.Company_id]),(0,t.useEffect)((()=>{d&&S(!0)}),[d]),(0,t.useEffect)((()=>{null!==l&&void 0!==l&&l.Retailer_Id&&(0,N.q)({address:`masters/retailers/info?Retailer_Id=${null===l||void 0===l?void 0:l.Retailer_Id}`}).then((e=>{e.success&&y(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})})).catch((e=>console.error(e)))}),[null===l||void 0===l?void 0:l.Retailer_Id]);const O=()=>{S(!1),r&&r()},M=a.filter((e=>(0,b.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0))),U=a.reduce(((e,l)=>{const a=(0,b.kR)(null===l||void 0===l?void 0:l.Item_Rate),t=parseInt(null===l||void 0===l?void 0:l.Bill_Qty)||0;if(F)return e.TotalValue+=(0,b.eX)(t,a),e;const s=Q?null===l||void 0===l?void 0:l.Igst:(0,b.Q5)(null===l||void 0===l?void 0:l.Sgst,null===l||void 0===l?void 0:l.Cgst);if(B){const l=P(1,a,s),d=(0,b.od)(a,l);e.TotalTax+=(0,b.eX)(t,l),e.TotalValue+=(0,b.eX)(t,d)}if(R){const l=P(0,a,s);e.TotalTax+=(0,b.eX)(t,l),e.TotalValue+=(0,b.eX)(t,a)}return e}),{TotalValue:0,TotalTax:0}),V=(0,C.useReactToPrint)({content:()=>G.current,pageStyle:`\n    @page {\n      size: ${"A4"===v?"A4":"A5"};\n      margin-top: 10px;\n      margin-right: 0;\n      margin-bottom: 0;\n      margin-left: 0;\n      \n    }\n\n    @media print {\n      body {\n        margin: 0;\n        padding: 0;\n         margin-top: 10px;\n      }\n\n      .MuiDialog-root,\n      .MuiDialog-container,\n      .MuiPaper-root,\n      .MuiDialogTitle-root {\n        display: none !important;\n      }\n\n    .pagebreak {\n        clear: both;\n        page-break-after: always;\n    }\n\n      .print-content {\n        padding-top: 0;\n         margin-top: 10px;\n      }\n    }\n  `}),H=[{labelOne:"Invoice No",dataOne:null===l||void 0===l?void 0:l.Do_Inv_No,labelTwo:"Dated",dataTwo:(0,b.uy)(null===l||void 0===l?void 0:l.Do_Date)},{labelOne:"Delivery Note",dataOne:"",labelTwo:"Mode/Terms of Payment",dataTwo:""},{labelOne:"Reference No. & Date",dataOne:"",labelTwo:"Other References",dataTwo:""},{labelOne:"Buyer's Order No",dataOne:"",labelTwo:"Dated",dataTwo:""},{labelOne:"Dispatch Doc No",dataOne:"",labelTwo:"Delivery Note Date",dataTwo:""},{labelOne:"Dispatched through",dataOne:"",labelTwo:"Destination",dataTwo:""},{labelOne:"Bill of Lading/LR-RR No",dataOne:"",labelTwo:"Motor Vehicle No",dataTwo:""}],k=null===a||void 0===a?void 0:a.reduce(((e,a)=>{const t=e.findIndex((e=>e.hsnCode==a.HSN_Code)),{Taxable_Amount:s,Cgst_Amo:d,Sgst_Amo:r,Igst_Amo:i,HSN_Code:n,Cgst:o,Sgst:c,Igst:u}=a;if(-1!==t){const a=e[t],n={...a,taxableValue:a.taxableValue+s,cgst:(0,b.Q5)(a.cgst,d),sgst:(0,b.Q5)(a.sgst,r),igst:(0,b.Q5)(a.igst,i),totalTax:a.totalTax+Number(l.IS_IGST?i:(0,b.Q5)(d,r))};return e[t]=n,e}const m={hsnCode:n,taxableValue:s,cgst:d,cgstPercentage:o,sgst:r,sgstPercentage:c,igst:i,igstPercentage:u,totalTax:l.IS_IGST?Number(i):(0,b.Q5)(d,r)};return[...e,m]}),[]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("span",{onClick:()=>{S(!0)},children:i}),(0,D.jsxs)(o.c,{open:p,onClose:O,fullWidth:!0,maxWidth:"xl",sx:{"& .MuiDialog-container":{alignItems:"flex-start",padding:"20px 0",overflow:"auto"},"& .MuiPaper-root":{width:"auto",maxWidth:"95vw",maxHeight:"95vh",margin:0,overflow:"visible"}},children:[(0,D.jsx)(c.c,{sx:{textAlign:"center",fontWeight:"bold",width:"100%",position:"sticky",marginTop:"2px",backgroundColor:"white",zIndex:1},children:"Order Preview"}),(0,D.jsx)(u.c,{ref:G,sx:{padding:0,margin:0,overflow:"auto",display:"flex",justifyContent:"center",width:"100%","@media print":{overflow:"visible",display:"block",height:"auto",marginTop:"2px"}},children:(0,D.jsxs)("div",{style:"A4"===v?_:g,className:"print-container",children:[(0,D.jsx)("h3",{className:"text-center mb-2",children:null!==n&&void 0!==n?n:"Invoice Details"}),(0,D.jsxs)("div",{className:"row",children:[(0,D.jsxs)("div",{className:"col-6 p-0 border border-bottom-0 border-end-0",children:[(0,D.jsxs)("div",{className:"border-bottom p-2",children:[(0,D.jsx)("p",{className:"m-0 fa-17",children:null===A||void 0===A?void 0:A.Company_Name}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["Address: ",null===A||void 0===A?void 0:A.Company_Address]}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["City: ",null===A||void 0===A?void 0:A.Region," - ",null===A||void 0===A?void 0:A.Pincode]}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===A||void 0===A?void 0:A.Gst_Number]}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["State: ",null===A||void 0===A?void 0:A.State]}),(0,D.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]}),(0,D.jsxs)("div",{className:"p-2",children:[(0,D.jsx)("p",{className:"m-0 fa-12",children:"Buyer (Bill to)"}),(0,D.jsx)("p",{className:"m-0 fa-15",children:null===I||void 0===I?void 0:I.Retailer_Name}),(0,D.jsx)("p",{className:"m-0 fa-14",children:(null===I||void 0===I?void 0:I.Mobile_No)+" - "+(null===I||void 0===I?void 0:I.Reatailer_Address)}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:[null===I||void 0===I?void 0:I.Reatailer_City," - ",null===I||void 0===I?void 0:I.PinCode]}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===A||void 0===A?void 0:A.Gstno]}),(0,D.jsxs)("p",{className:"m-0 fa-14",children:["State Name: ",null===A||void 0===A?void 0:A.StateGet]}),(0,D.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]})]}),(0,D.jsx)("div",{className:"col-6 p-0 border border-bottom-0",children:(0,D.jsx)("table",{className:"table m-0",children:(0,D.jsxs)("tbody",{children:[H.map(((e,l)=>(0,D.jsxs)("tr",{children:[(0,D.jsxs)("td",{className:"border-end fa-12 p-0 px-1",children:[(0,D.jsx)("p",{className:"m-0",children:e.labelOne}),(0,D.jsxs)("p",{className:"m-0",children:["\u2003",e.dataOne]})]}),(0,D.jsxs)("td",{className:"fa-12 p-0 px-1",children:[(0,D.jsx)("p",{className:"m-0",children:e.labelTwo}),(0,D.jsxs)("p",{className:"m-0",children:["\u2003",e.dataTwo]})]})]},l))),(0,D.jsx)("tr",{children:(0,D.jsxs)("td",{colSpan:2,className:"border-0 fa-12 p-0",children:[(0,D.jsx)("p",{className:"m-0",children:"Terms of Delivery"}),(0,D.jsx)("p",{className:"m-0"}),(0,D.jsx)("br",{}),(0,D.jsx)("br",{})]})})]})})})]}),(0,D.jsx)("div",{className:"row",children:(0,D.jsx)("div",{className:"col-12 p-0",children:(0,D.jsxs)("table",{className:"table m-0",children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border bg-light fa-14",children:"Sno"}),(0,D.jsx)("td",{className:"border bg-light fa-14",children:"Product"}),(0,D.jsx)("td",{className:"border bg-light fa-14",children:"HSN/SAC"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Quantity"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Rate"}),(0,D.jsxs)("td",{className:"border bg-light fa-14 text-end",children:[(0,D.jsx)("p",{className:"m-2 ",children:"Rate"}),(0,D.jsxs)("p",{className:"m-0 ",children:[(0,b.Qr)(l.GST_Inclusive,1)&&"(Incl. of Tax)",(0,b.Qr)(l.GST_Inclusive,2)&&"(Tax not applicable)",(0,b.Qr)(l.GST_Inclusive,0)&&"(Excl. of Tax)"]})]}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Amount"})]})}),(0,D.jsx)("tbody",{children:(()=>{const e=[];for(let l=0;l<M.length;l+=15)e.push(M.slice(l,l+15));return e.map(((a,s)=>(0,D.jsxs)(t.Fragment,{children:[a.map(((e,a)=>{var t;const d=15*s+a,r=null!==(t=Q?null===e||void 0===e?void 0:e.Igst_P:(null===e||void 0===e?void 0:e.Cgst)+(null===e||void 0===e?void 0:e.Sgst))&&void 0!==t?t:0,i=Number((null===e||void 0===e?void 0:e.Bill_Qty)||0),n=Number((null===e||void 0===e?void 0:e.Item_Rate)||0),o=P(l.GST_Inclusive,n,r);return(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border fa-13",children:d+1}),(0,D.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.Product_Name}),(0,D.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.HSN_Code}),(0,D.jsxs)("td",{className:"border fa-13 text-end",children:[(0,b.SA)(i),(null===e||void 0===e?void 0:e.UOM)&&" ("+(null===e||void 0===e?void 0:e.UOM)+") "]}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)((0,b.Qr)(l.GST_Inclusive,1)?n-o:n)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)((0,b.Qr)(l.GST_Inclusive,1)?n:n+o)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.Taxable_Amount)})]},d)})),s===e.length-1&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("tr",{children:[(0,D.jsxs)("td",{className:"border p-2",rowSpan:Q?4:5,colSpan:4,children:[(0,D.jsx)("p",{className:"m-0 mx-2 p-2 fa-13 fw-bold",children:"Amount Chargeable (in words):"}),(0,D.jsxs)("p",{className:"m-0 fa-13 fw-bold",children:["\u2003 INR ",(0,b.m4)(parseInt(null===l||void 0===l?void 0:l.Total_Invoice_value))," Only."]})]}),(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total Taxable Amount"}),(0,D.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,b.SA)(U.TotalValue)})]}),Q?(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"IGST"}),(0,D.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,b.SA)(l.IGST_Total)})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"CGST"}),(0,D.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,b.SA)(null===l||void 0===l?void 0:l.CSGT_Total)})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"SGST"}),(0,D.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,b.SA)(null===l||void 0===l?void 0:l.SGST_Total)})]})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Round Off"}),(0,D.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,b.SA)(null===l||void 0===l?void 0:l.Round_off)})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total"}),(0,D.jsx)("td",{className:"border p-2 fa-14 text-end fw-bold",children:(0,b.SA)(null===l||void 0===l?void 0:l.Total_Invoice_value)})]})]}),s<e.length-1&&(0,D.jsx)("tr",{style:{pageBreakAfter:"always",height:"0",visibility:"hidden",border:"none"},children:(0,D.jsx)("td",{colSpan:"7",style:{border:"none"}})})]},s)))})()})]})})}),(0,D.jsxs)("table",{className:"table",children:[(0,D.jsxs)("thead",{children:[(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"HSN / SAC"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"Taxable Value"}),(0,b.Qr)(l.IS_IGST,1)?(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"IGST Tax"}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"Central Tax"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"State Tax"})]}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Total"})]}),(0,D.jsxs)("tr",{children:[(0,b.Qr)(l.IS_IGST,1)?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}),(0,D.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Tax Amount"})]})]}),(0,D.jsxs)("tbody",{children:[k.map(((e,a)=>(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border fa-13 text-end",children:null===e||void 0===e?void 0:e.hsnCode}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.taxableValue)}),l.IS_IGST?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.igstPercentage)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.igst)})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.cgstPercentage)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.cgst)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.sgstPercentage)}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.sgst)})]}),(0,D.jsx)("td",{className:"border fa-13 text-end",children:(0,b.SA)(null===e||void 0===e?void 0:e.totalTax)})]},a))),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border fa-13 text-end",children:"Total"}),(0,D.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,b.SA)(k.reduce(((e,l)=>e+Number(l.taxableValue)),0))}),l.IS_IGST?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border fa-13 text-end"}),(0,D.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,b.SA)(k.reduce(((e,l)=>e+Number(l.igst)),0))})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("td",{className:"border fa-13 text-end"}),(0,D.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,b.SA)(k.reduce(((e,l)=>e+Number(l.cgst)),0))}),(0,D.jsx)("td",{className:"border fa-13 text-end"}),(0,D.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,b.SA)(k.reduce(((e,l)=>e+Number(l.sgst)),0))})]}),(0,D.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,b.SA)(k.reduce(((e,l)=>e+Number(l.totalTax)),0))})]}),(0,D.jsx)("tr",{children:(0,D.jsxs)("td",{colSpan:(0,b.Qr)(l.IS_IGST,1)?5:7,className:"border fa-13 fw-bold",children:["Tax Amount (in words) : INR \xa0",(0,b.m4)(parseInt(k.reduce(((e,l)=>e+Number(l.totalTax)),0)))," only."]})})]})]}),(0,D.jsx)("div",{className:"col-12 text-center",children:(0,D.jsx)("p",{children:"This is a Computer Generated Invoice"})})]})}),(0,D.jsxs)(m.c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:2},children:[(0,D.jsxs)("div",{className:"form-check form-switch",children:[(0,D.jsx)("input",{className:"form-check-input",type:"checkbox",id:"pageSizeSwitch",checked:"A4"===v,onChange:()=>{x((e=>"A5"===e?"A4":"A5"))}}),(0,D.jsxs)("label",{className:"form-check-label",htmlFor:"pageSizeSwitch",children:[v," selected"]})]}),(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,D.jsx)(h.c,{startIcon:(0,D.jsx)(f.c,{}),variant:"outlined",color:"error",onClick:O,children:"Close"}),s&&(0,D.jsx)(h.c,{startIcon:(0,D.jsx)(T.c,{}),variant:"outlined",onClick:V,children:"Download"})]})]})]})]})},w=e=>{let{loadingOn:l,loadingOff:a,onToggle:f,reload:T,triggerReload:C}=e;const P=JSON.parse(localStorage.getItem("user")),[w,G]=(0,t.useState)([]),[R,B]=(0,t.useState)([]),[F,Q]=(0,t.useState)([]),[O,M]=(0,t.useState)([]),[U,V]=(0,t.useState)(!0),[H,k]=(0,t.useState)({}),[L,E]=(0,t.useState)({}),[q,z]=(0,t.useState)(!1),[$,W]=(0,t.useState)({}),[X,J]=(0,t.useState)(!1),[Y,K]=(0,t.useState)([]),[Z,ee]=(0,t.useState)({Fromdate:(0,b.SO)(7),Todate:(0,b.Q7)(),Retailer_Id:"",RetailerGet:"ALL",Created_by:"",CreatedByGet:"ALL",Delivery_Person_Id:"",Delivery_Person_Name:"ALL",Sales_Person_Id:"",Sales_Person_Name:"ALL",Cancel_status:0}),[le,ae]=(0,t.useState)(!1),[te,se]=(0,t.useState)({filters:!1,orderDetails:!1});(0,t.useEffect)((()=>{(0,N.q)({address:`delivery/deliveryOrderList?Fromdate=${null===Z||void 0===Z?void 0:Z.Fromdate}&Todate=${null===Z||void 0===Z?void 0:Z.Todate}&Retailer_Id=${null===Z||void 0===Z?void 0:Z.Retailer_Id}&Sales_Person_Id=${null===Z||void 0===Z?void 0:Z.Sales_Person_Id}&Delivery_Person_Id=${null===Z||void 0===Z?void 0:Z.Delivery_Person_Id}&Created_by=${null===Z||void 0===Z?void 0:Z.Created_by}&Cancel_status=${null===Z||void 0===Z?void 0:Z.Cancel_status}`}).then((e=>{e.success&&G(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e)))}),[Z.Fromdate,null===Z||void 0===Z?void 0:Z.Todate,null===Z||void 0===Z?void 0:Z.Retailer_Id,null===Z||void 0===Z?void 0:Z.Delivery_Person_Id,null===Z||void 0===Z?void 0:Z.Created_by,null===Z||void 0===Z?void 0:Z.Cancel_status,null===Z||void 0===Z?void 0:Z.Sales_Person_Id,T,le]),(0,t.useEffect)((()=>{(0,N.q)({address:"dataEntry/costCenter"}).then((e=>{e.success&&K(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:`masters/retailers/dropDown?Company_Id=${null===P||void 0===P?void 0:P.Company_id}`}).then((e=>{e.success&&B(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:`masters/users/salesPerson/dropDown?Company_id=${null===P||void 0===P?void 0:P.Company_id}`}).then((e=>{e.success&&Q(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:`masters/user/dropDown?Company_id=${null===P||void 0===P?void 0:P.Company_id}`}).then((e=>{e.success&&M(e.data)})).catch((e=>console.error(e)))}),[]);const de=[{Field_Name:"Do_Id",ColumnHeader:"Delivery ID",Fied_Data:"string",isVisible:1},{Field_Name:"So_No",ColumnHeader:"Sale Order ID",Fied_Data:"string",isVisible:1},{Field_Name:"Do_Inv_No",ColumnHeader:"Do_Inv_No ",Fied_Data:"string",isVisible:1,align:"center"},{Field_Name:"Retailer_Name",ColumnHeader:"Customer",Fied_Data:"string",isVisible:1},{Field_Name:"SalesDate",ColumnHeader:"Sale Order Date",Fied_Data:"date",isVisible:1,align:"center"},{Field_Name:"Do_Date",ColumnHeader:"Delivery Date",Fied_Data:"date",isVisible:1,align:"center"},{Field_Name:"Total_Before_Tax",ColumnHeader:"Before Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Tax",ColumnHeader:"Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Invoice_value",ColumnHeader:"Invoice Value",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"DeliveryStatusName",ColumnHeader:"Delivery Status ",Fied_Data:"string",isVisible:1,align:"center"},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(s.c,{title:"View Order",children:(0,D.jsx)(d.c,{onClick:()=>{E({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},onFocus:e=>{e.target.blur()},color:"primary",size:"small",children:(0,D.jsx)(_.c,{className:"fa-16"})})}),(0,D.jsx)(s.c,{title:"Edit",children:(0,D.jsx)(d.c,{onClick:()=>{re(),k({...l,isEdit:!0})},size:"small",children:(0,D.jsx)(g.c,{className:"fa-16"})})}),(0,D.jsx)(s.c,{title:"Delete",children:(0,D.jsx)(d.c,{onClick:()=>{return W({So_No:(e=l).So_No,Do_Id:e.Do_Id}),void z(!0);var e},size:"small",children:(0,D.jsx)(j.c,{className:"fa-16"})})})]})}}],re=()=>{V(!U),k({}),J(!X)},ie=()=>{se({...te,filters:!1,orderDetails:!1}),k({}),z(!1)};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(r.c,{children:[(0,D.jsxs)("div",{className:"p-3 py-2 d-flex align-items-center justify-content-between",children:[(0,D.jsx)("h6",{className:"fa-18 m-0 p-0",children:U?"Delivery Orders":(0,b.CY)(H)?"Modify Delivery Order":""}),(0,D.jsxs)("span",{children:[U&&(0,D.jsx)(s.c,{title:"Filters",children:(0,D.jsx)(d.c,{size:"small",onClick:()=>se({...te,filters:!0}),children:(0,D.jsx)(p.c,{})})}),U&&(0,D.jsx)(i.c,{checked:!U,onChange:f,label:"Delivery Details",inputProps:{"aria-label":"controlled"}})]})]}),(0,D.jsx)(n.c,{className:"p-0 ",children:U?(0,D.jsx)(S.cp,{dataArray:w,columns:de,isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)("table",{className:"table",children:(0,D.jsxs)("tbody",{children:[(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,D.jsx)("td",{className:"border p-2",children:l.Branch_Name}),(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Delivery Person"}),(0,D.jsx)("td",{className:"border p-2",children:l.Delivery_Person_Name}),(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,D.jsx)("td",{className:"border p-2",children:l.Round_off})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,D.jsxs)("td",{className:"border p-2",children:[(0,b.Qr)(l.GST_Inclusive,1)&&"Inclusive",(0,b.Qr)(l.GST_Inclusive,0)&&"Exclusive"]}),(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,D.jsxs)("td",{className:"border p-2",children:[(0,b.Qr)(l.IS_IGST,1)&&"IGST",(0,b.Qr)(l.IS_IGST,0)&&"GST"]}),(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,D.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,D.jsx)("td",{className:"border p-2",colSpan:5,children:l.Narration})]})]})})})}}):(0,D.jsx)(y.c,{editValues:H,loadingOn:l,loadingOff:a,reload:()=>{V((e=>!e))},switchScreen:re})})]}),Object.keys(L).length>0&&(0,D.jsx)(A,{orderDetails:null===L||void 0===L?void 0:L.orderDetails,orderProducts:null===L||void 0===L?void 0:L.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>E({}),TitleText:"Delivery Order"}),(0,D.jsxs)(o.c,{open:q,fullWidth:!0,maxWidth:"sm",children:[(0,D.jsx)(c.c,{children:"Delete"}),(0,D.jsx)(u.c,{children:(0,D.jsx)("div",{children:"Are You Want to Delete Delivery Details"})}),(0,D.jsxs)(m.c,{children:[(0,D.jsx)(h.c,{onClick:ie,children:"close"}),(0,D.jsx)(h.c,{onClick:async()=>{if($)try{const e=await(0,N.q)({address:"delivery/deliveryOrder",method:"DELETE",bodyData:{Order_Id:$.So_No,Do_Id:$.Do_Id}});e.success?(I.m4.success("Delivery Deleted successfully"),C(),z(!1),ae((e=>!e)),J(!1)):I.m4.error((null===e||void 0===e?void 0:e.message)||"Deletion failed")}catch(e){I.m4.error("An error occurred while deleting.",e)}finally{z(!1)}},children:"Delete"})]})]}),(0,D.jsxs)(o.c,{open:te.filters,onClose:ie,fullWidth:!0,maxWidth:"sm",children:[(0,D.jsx)(c.c,{children:"Filters"}),(0,D.jsx)(u.c,{children:(0,D.jsx)("div",{className:"table-responsive pb-4",children:(0,D.jsx)("table",{className:"table",children:(0,D.jsxs)("tbody",{children:[(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,D.jsx)("td",{children:(0,D.jsx)(v.cp,{value:{value:null===Z||void 0===Z?void 0:Z.Retailer_Id,label:null===Z||void 0===Z?void 0:Z.RetailerGet},onChange:e=>ee({...Z,Retailer_Id:e.value,RetailerGet:e.label}),options:[{value:"",label:"ALL"},...R.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:x.cF,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"Delivery Person"}),(0,D.jsx)("td",{children:(0,D.jsx)(v.cp,{value:{value:null===Z||void 0===Z?void 0:Z.Delivery_Person_Id,label:null===Z||void 0===Z?void 0:Z.Delivery_Person_Name},onChange:e=>ee({...Z,Delivery_Person_Id:e.value,Delivery_Person_Name:e.label}),options:[{value:"",label:"ALL"},...Y.map((e=>({value:null===e||void 0===e?void 0:e.User_Id,label:null===e||void 0===e?void 0:e.UserGet})))],styles:x.cF,isSearchable:!0,placeholder:"Delivery Person Name"})})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"Sales Person"}),(0,D.jsx)("td",{children:(0,D.jsx)(v.cp,{value:{value:null===Z||void 0===Z?void 0:Z.Sales_Person_Id,label:null===Z||void 0===Z?void 0:Z.Sales_Person_Name},onChange:e=>ee({...Z,Sales_Person_Id:e.value,Sales_Person_Name:e.label}),options:[{value:"",label:"ALL"},...F.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:{...x.cF,menu:e=>({...e,zIndex:9999})},isSearchable:!0,placeholder:"Sales Person Name",menuPortalTarget:document.body,menuPosition:"fixed"})})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,D.jsx)("td",{children:(0,D.jsx)(v.cp,{value:{value:null===Z||void 0===Z?void 0:Z.Created_by,label:null===Z||void 0===Z?void 0:Z.CreatedByGet},onChange:e=>ee({...Z,Created_by:e.value,CreatedByGet:e.label}),options:[{value:"",label:"ALL"},...O.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:x.cF,isSearchable:!0,placeholder:"Delivery Person Name"})})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,D.jsx)("td",{children:(0,D.jsx)("input",{type:"date",value:Z.Fromdate,onChange:e=>ee({...Z,Fromdate:e.target.value}),className:"cus-inpt"})})]}),(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,D.jsx)("td",{children:(0,D.jsx)("input",{type:"date",value:Z.Todate,onChange:e=>ee({...Z,Todate:e.target.value}),className:"cus-inpt"})})]})]})})})}),(0,D.jsx)(m.c,{children:(0,D.jsx)(h.c,{onClick:ie,children:"close"})})]})]})}},55312:(e,l,a)=>{a.d(l,{c:()=>T});var t=a(69060),s=a(89e3),d=a(5548),r=a(82656),i=a(26773),n=a(4488),o=a(90048),c=a(99852),u=a(62344),m=a(56480),h=a(39308),v=a(96064),x=a(86e3),b=a(45180),_=a(80156),g=a(36992),j=a(56084),p=a(1908),N=a(13724),S=a(64568),I=a(128),y=a(82496);const f=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,h.Qr)(e.Product_Id,l))))&&void 0!==e?e:{}},T=e=>{var l,a,T,C;let{editValues:D,loadingOn:P,loadingOff:A,reload:w,switchScreen:G,editOn:R}=e;const B=JSON.parse(localStorage.getItem("user")),[F,Q]=(0,t.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[O,M]=(0,t.useState)([]),[U,V]=(0,t.useState)([]),[H,k]=(0,t.useState)([]),[L,E]=(0,t.useState)([]),[q,z]=(0,t.useState)({}),[$,W]=(0,t.useState)([]),[X,J]=(0,t.useState)([]),Y={Company_Id:null===B||void 0===B?void 0:B.Company_id,Do_Date:(0,h.Q7)(),VoucherType:"",Retailer_Id:"",Retailer_Name:"Select",Delivery_Status:1,Delivery_Person_Id:"",Payment_Ref_No:"",Delivery_Person_Name:"",Payment_Mode:0,Payment_Status:0,Branch_Id:null===B||void 0===B?void 0:B.BranchId,Narration:"",Created_by:null===B||void 0===B?void 0:B.UserId,Product_Array:[],So_No:null===D||void 0===D?void 0:D.So_Id,GST_Inclusive:1,IS_IGST:0},K={Item_Id:"",ItemName:"Search Item",Bill_Qty:0,Item_Rate:0,UOM:"",Units:"",Product:{},Group:"Search Group",GroupID:"",Brand:"Search Brand",BrandID:"",Amount:0},[Z,ee]=(0,t.useState)(Y),[le,ae]=(0,t.useState)([]),[te,se]=(0,t.useState)(K),[de,re]=(0,t.useState)(!1),[ie,ne]=(0,t.useState)(!1),oe=(0,h.Qr)(Z.GST_Inclusive,1),ce=(0,h.Qr)(Z.GST_Inclusive,2),ue=(0,t.useState)(0);(0,t.useEffect)((()=>{var e;(0,h.CY)(D)?(ee((e=>{var l;return{...e,Do_Id:null===D||void 0===D?void 0:D.Do_Id,Do_Date:null!==(l=null===D||void 0===D?void 0:D.Do_Date)&&void 0!==l?l:(0,h.Q7)(),VoucherType:null===D||void 0===D?void 0:D.Voucher_Type,Retailer_Id:null===D||void 0===D?void 0:D.Retailer_Id,Retailer_Name:null===D||void 0===D?void 0:D.Retailer_Name,Delivery_Status:null===D||void 0===D?void 0:D.Delivery_Status,Payment_Status:null===D||void 0===D?void 0:D.Payment_Status,Payment_Mode:null===D||void 0===D?void 0:D.Payment_Mode,Branch_Id:null===D||void 0===D?void 0:D.Branch_Id,Narration:null===D||void 0===D?void 0:D.Narration,Created_by:null===D||void 0===D?void 0:D.Created_by,Payment_Ref_No:null===D||void 0===D?void 0:D.Payment_Ref_No,So_No:null===D||void 0===D?void 0:D.So_Id,GST_Inclusive:null===D||void 0===D?void 0:D.GST_Inclusive,IS_IGST:null===D||void 0===D?void 0:D.IS_IGST}})),ae(null===D||void 0===D||null===(e=D.Products_List)||void 0===e?void 0:e.map((e=>{var l,a,t,s,d,r,i,n,o,c,u,m,v,x,b,_;return{...e,Item_Id:null!==(l=e.Item_Id)&&void 0!==l?l:"",ItemName:null!==(a=null===e||void 0===e?void 0:e.Product_Name)&&void 0!==a?a:"",Bill_Qty:null!==(t=null===e||void 0===e?void 0:e.Bill_Qty)&&void 0!==t?t:0,Item_Rate:null!==(s=null===e||void 0===e?void 0:e.Item_Rate)&&void 0!==s?s:0,UOM:null!==(d=null===e||void 0===e?void 0:e.Unit_Id)&&void 0!==d?d:"",Units:null!==(r=null===e||void 0===e?void 0:e.Units)&&void 0!==r?r:"",Product:{...e,Cgst_P:null!==(i=Number(null===(n=f(U,e.Item_Id))||void 0===n?void 0:n.Cgst_P))&&void 0!==i?i:0,Sgst_P:null!==(o=Number(null===(c=f(U,e.Item_Id))||void 0===c?void 0:c.Sgst_P))&&void 0!==o?o:0,Igst_P:null!==(u=Number(null===(m=f(U,e.Item_Id))||void 0===m?void 0:m.Igst_P))&&void 0!==u?u:0,Gst_P:null!==(v=(0,h.Q5)(null===(x=f(U,e.Item_Id))||void 0===x?void 0:x.Cgst_P,null===(b=f(U,e.Item_Id))||void 0===b?void 0:b.Sgst_P))&&void 0!==v?v:0},Group:"Search Group",GroupID:"",Brand:"Search Brand",BrandID:"",Amount:null!==(_=null===e||void 0===e?void 0:e.Amount)&&void 0!==_?_:0}}))),re(!0),null!==D&&void 0!==D&&D.Latitude&&null!==D&&void 0!==D&&D.Longitude||(async()=>{try{const e=await new Promise(((e,l)=>{navigator.geolocation.getCurrentPosition(e,l)})),{latitude:l,longitude:a}=e.coords;ee((e=>({...e,Delivery_Latitude:l,Delivery_Longitude:a})))}catch(e){m.m4.warn("Unable to fetch location. Allow location access.")}})()):(ee(Y),ae([]),re(!1))}),[D,U]),(0,t.useEffect)((()=>{(0,p.q)({address:`masters/retailers/dropDown?Company_Id=${null===B||void 0===B?void 0:B.Company_id}`}).then((e=>{e.success&&M(e.data)})).catch((e=>console.error(e))),(0,p.q)({address:"masters/uom"}).then((e=>{e.success&&E(e.data)})).catch((e=>console.error(e))),(0,p.q)({address:"masters/products"}).then((e=>{if(e.success){V(e.data);const l=(0,h.Un)(e.data,"Brand",["Brand_Name"]);k(l)}else V([]),k([])})).catch((e=>console.error(e))),(0,p.q)({address:`masters/company?Company_id=${null===B||void 0===B?void 0:B.Company_id}`}).then((e=>{e.success&&z(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})})).catch((e=>console.error(e))),(0,p.q)({address:"purchase/voucherType"}).then((e=>{e.success&&W(e.data)})).catch((e=>console.error(e))),(0,p.q)({address:"masters/branch/dropDown"}).then((e=>{e.success&&J(e.data)})).catch((e=>console.error(e)))}),[null===B||void 0===B?void 0:B.Company_id]);(0,t.useEffect)((()=>{ae((e=>e.map((e=>{const l=f(F.products,e.Item_Id),a=Z.IS_IGST?l.Igst_P:l.Gst_P,t=a>0&&!ce,s=(0,h.eX)(e.Item_Rate,e.Bill_Qty),d=(0,I.O)(s,a,oe?"remove":"add");return{...e,Amount:s,Taxable_Amount:t?d.without_tax:s,Cgst_Amo:t&&!Z.IS_IGST?d.cgst_amount:0,Sgst_Amo:t&&!Z.IS_IGST?d.sgst_amount:0,Igst_Amo:t&&Z.IS_IGST?d.igst_amount:0,Final_Amo:t?d.with_tax:s,Tax_Rate:a,Cgst:Z.IS_IGST?0:d.cgst_per,Sgst:Z.IS_IGST?0:d.sgst_per,Igst:Z.IS_IGST?d.igst_per:0,Taxble:t?1:0}}))))}),[Z.GST_Inclusive,Z.IS_IGST]);const me=(e=>e.reduce(((e,l)=>({taxableAmount:e.taxableAmount+(l.Taxable_Amount||0),cgst:e.cgst+(l.Cgst_Amo||0),sgst:e.sgst+(l.Sgst_Amo||0),igst:e.igst+(l.Igst_Amo||0),finalAmount:e.finalAmount+(l.Final_Amo||0)})),{taxableAmount:0,cgst:0,sgst:0,igst:0,finalAmount:0}))(le),he=Math.round(me.finalAmount)-me.finalAmount,ve=()=>{ne(!1),se(K)};return(0,y.jsxs)(y.Fragment,{children:[R&&(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("h6",{className:"fa-18 m-0 p-3 py-2 d-flex align-items-center justify-content-between",children:"Create Delivery Order"})}),(0,y.jsxs)("div",{className:"p-3 pt-0",children:[(0,y.jsxs)("div",{className:"p-3 bg-light rounded-3 mb-3 shadow-sm",children:[(0,y.jsx)("h5",{className:"border-bottom",children:"From:"}),(0,y.jsxs)("div",{className:"row",children:[(0,y.jsx)("div",{className:"col-lg-8 col-md-7",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsx)("tr",{children:(0,y.jsx)("td",{className:"border-0 bg-light",colSpan:2,children:null===q||void 0===q?void 0:q.Company_Name})}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Address:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:null===q||void 0===q?void 0:q.Company_Address})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Phone:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:null===q||void 0===q?void 0:q.Telephone_Number})]})]})})}),(0,y.jsx)("div",{className:"col-lg-4 col-md-5",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Date:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsx)("input",{type:"date",value:null!==Z&&void 0!==Z&&Z.Do_Date?(0,h.Q7)(null===Z||void 0===Z?void 0:Z.Do_Date):"",onChange:e=>ee({...Z,Do_Date:e.target.value}),className:"cus-inpt p-1"})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Invoice Type:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,GST_Inclusive:Number(e.target.value)}),value:Z.GST_Inclusive,children:[(0,y.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,y.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,y.jsx)("option",{value:2,children:"Not Taxable"})]})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Tax Type:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,IS_IGST:Number(e.target.value)}),value:Z.IS_IGST,children:[(0,y.jsx)("option",{value:"0",children:"GST"}),(0,y.jsx)("option",{value:"1",children:"IGST"})]})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsxs)("td",{className:"border-0 bg-light",children:["Voucher Type ",(0,y.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1 ",onChange:e=>ee({...Z,VoucherType:e.target.value}),value:Z.VoucherType,children:[(0,y.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),$.map(((e,l)=>(0,y.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsxs)("td",{className:"border-0 bg-light",children:["Branch ",(0,y.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,Branch_Id:Number(e.target.value)}),value:Z.Branch_Id,children:[(0,y.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),X.map(((e,l)=>(0,y.jsx)("option",{value:e.BranchId,children:e.BranchName},l)))]})})]})]})})})]})]}),(0,y.jsxs)("div",{className:"p-3 bg-light rounded-3 mb-3 shadow-sm",children:[(0,y.jsx)("h5",{className:"border-bottom",children:"To:"}),(0,y.jsxs)("div",{className:"row ",children:[(0,y.jsx)("div",{className:"col-md-6",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Retailer Name:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsx)(c.cp,{value:{value:null===Z||void 0===Z?void 0:Z.Retailer_Id,label:null===Z||void 0===Z?void 0:Z.Retailer_Name},onChange:e=>ee({...Z,Retailer_Id:e.value,Retailer_Name:e.label}),options:[{value:"",label:"select",isDisabled:!0},...O.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:u.cF,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Address:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:B.Name})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Phone:"}),(0,y.jsx)("td",{className:"border-0 bg-light"})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Delivery_Status:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,Delivery_Status:e.target.value}),value:Z.Delivery_Status?Z.Delivery_Status:1,children:[(0,y.jsx)("option",{value:5,children:"Pending"}),(0,y.jsx)("option",{value:7,children:"Delivered"}),(0,y.jsx)("option",{value:6,children:"Return"})]})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Payment_Mode:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,Payment_Mode:e.target.value}),value:Z.Payment_Mode||0,children:[(0,y.jsx)("option",{value:0}),(0,y.jsx)("option",{value:1,children:"Cash"}),(0,y.jsx)("option",{value:3,children:"QR-Pay"}),(0,y.jsx)("option",{value:2,children:"G-Pay"})]})})]})]})})}),(0,y.jsx)("div",{className:"col-md-6",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Q-Pay:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:10})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Frequency Days:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:20})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Payment_Status:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>ee({...Z,Payment_Status:Number(e.target.value)}),value:Z.Payment_Status,children:[(0,y.jsx)("option",{value:1,children:"Pending"}),(0,y.jsx)("option",{value:3,children:"Complete"})]})})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border-0 bg-light",children:"Payment Reference No:"}),(0,y.jsx)("td",{className:"border-0 bg-light",children:(0,y.jsx)("input",{type:"text",className:"cus-inpt p-1",onChange:e=>ee({...Z,Payment_Ref_No:e.target.value}),value:null===Z||void 0===Z?void 0:Z.Payment_Ref_No,placeholder:"Enter Payment Reference Number"})})]})]})})})]})]}),(0,y.jsx)("div",{className:"d-flex align-items-end justify-content-end flex-wrap mb-3",children:(0,y.jsx)(s.c,{onClick:()=>ne(!0),sx:{ml:1},variant:"outlined",startIcon:(0,y.jsx)(v.c,{}),children:"Add Product"})}),(0,y.jsx)(N.cp,{dataArray:le,columns:[{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;return null===a||void 0===a||null===(l=a.Product)||void 0===l?void 0:l.Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;return null===a||void 0===a||null===(l=a.Product)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;return(null===a||void 0===a?void 0:a.Bill_Qty)+(null!==(l=null===a||void 0===a?void 0:a.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},{Field_Name:"Item_Rate",ColumnHeader:"Rate",Fied_Data:"number",isVisible:1,align:"right"},{ColumnHeader:"Taxable Amount",isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,h.SA)(l.Taxable_Amount||0)},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;const t=(0,h.Q5)(a.Cgst_Amo||0,a.Sgst_Amo||0,a.Igst_Amo||0);return`${(0,h.SA)(t)} (${(null===(l=a.Product)||void 0===l?void 0:l.Tax_Rate)||0}%)`},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,h.SA)(l.Final_Amo||0)},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d.c,{onClick:()=>{const e=l.Product||{},a=l.UOM||e.Unit_Id,t=l.Unit_Name||e.Units||e.Unit_Name;se({Item_Id:l.Item_Id,ItemName:e.Product_Name||l.ItemName,Bill_Qty:l.Bill_Qty,Item_Rate:l.Item_Rate,UOM:a,Units:t,Product:e,Group:e.Pro_Group||l.Group||"",GroupID:e.Product_Group||l.GroupID||"",Brand:e.Brand_Name||l.Brand||"",BrandID:e.Brand||l.BrandID||"",Amount:l.Amount}),ne(!0)},size:"small",children:(0,y.jsx)(x.c,{})}),(0,y.jsx)(d.c,{size:"small",onClick:()=>{ae((e=>e.filter((e=>!(0,h.Qr)(e.Item_Id,l.Item_Id)))))},color:"error",children:(0,y.jsx)(b.c,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),le.length>0&&(0,y.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,y.jsx)("table",{className:"table",children:(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsxs)("td",{className:"border p-2",rowSpan:1===Z.IS_IGST?4:5,children:["Total in words: ",(0,h.m4)(Math.round(me.finalAmount))]}),(0,y.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,y.jsx)("td",{className:"border p-2 text-end",children:(0,h.SA)(me.taxableAmount.toFixed(2))})]}),1===Z.IS_IGST?(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2",children:"IGST"}),(0,y.jsx)("td",{className:"border p-2 text-end",children:(0,h.SA)(me.igst.toFixed(2))})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2",children:"CGST"}),(0,y.jsx)("td",{className:"border p-2 text-end",children:(0,h.SA)(me.cgst.toFixed(2))})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2",children:"SGST"}),(0,y.jsx)("td",{className:"border p-2 text-end",children:(0,h.SA)(me.sgst.toFixed(2))})]})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,y.jsx)("td",{className:"border p-2 text-end",children:(0,h.SA)(he.toFixed(2))})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"border p-2 fw-bold",children:"Total"}),(0,y.jsx)("td",{className:"border p-2 text-end fw-bold",children:(0,h.SA)(Math.round(me.finalAmount))})]})]})})}),(0,y.jsx)("p",{className:"fa-15 mt-3 m-0",children:"Narration"}),(0,y.jsx)("textarea",{className:"cus-inpt ",value:Z.Narration,onChange:e=>ee((l=>({...l,Narration:e.target.value})))}),(0,y.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,y.jsx)(s.c,{variant:"outlined",startIcon:(0,y.jsx)(_.c,{}),onClick:G,children:"cancel"}),(0,y.jsx)(s.c,{onClick:()=>{if((null===le||void 0===le?void 0:le.length)>0&&null!==Z&&void 0!==Z&&Z.Retailer_Id){var e;P(),(0,p.q)({address:"delivery/deliveryOrder",method:de&&!R?"PUT":"POST",bodyData:{...Z,Product_Array:le.filter((e=>(0,h.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0))),Delivery_Person_Id:null!==(e=null!==ue&&void 0!==ue?ue:Number(null===Z||void 0===Z?void 0:Z.Delivery_Person_Id))&&void 0!==e?e:0,Payment_Status:null!==Z&&void 0!==Z&&Z.Payment_Status?Number(null===Z||void 0===Z?void 0:Z.Payment_Status):1,Payment_Ref_No:null===Z||void 0===Z?void 0:Z.Payment_Ref_No,Delivery_Status:null!==Z&&void 0!==Z&&Z.Delivery_Status?Number(null===Z||void 0===Z?void 0:Z.Delivery_Status):1,Payment_Mode:null!==Z&&void 0!==Z&&Z.Payment_Mode?Number(null===Z||void 0===Z?void 0:Z.Payment_Mode):1}}).then((e=>{e.success?(m.m4.success(null===e||void 0===e?void 0:e.message),ee(Y),ae([]),w()):m.m4.error(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e))).finally((()=>A()))}else{if(le.length<=0)return m.m4.error("Enter any one product quantity");if(null===Z||void 0===Z||!Z.Retailer_Id)return m.m4.error("Select Retailer"),m.m4.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,y.jsx)(g.c,{}),disabled:0===(null===le||void 0===le?void 0:le.length)||!(null!==Z&&void 0!==Z&&Z.Retailer_Id),children:"Save"})]})]}),(0,y.jsxs)(r.c,{open:ie,onClose:ve,maxWidth:"sm",fullWidth:!0,children:[(0,y.jsx)(i.c,{className:"border-bottom",children:(0,y.jsx)("span",{children:"Add Products Details"})}),(0,y.jsxs)("form",{onSubmit:e=>{e.preventDefault(),te.Item_Id&&te.Bill_Qty&&te.Item_Rate?(((e,l,a,t,s,d)=>{const r=f(F.products,e),i=Z.IS_IGST?r.Igst_P:r.Gst_P,n=i>0&&!ce,o=(0,h.eX)(l,a),c=(0,I.O)(o,i,oe?"remove":"add"),u=le.findIndex((l=>(0,h.Qr)(l.Item_Id,e))),m={Item_Id:e,Bill_Qty:Number(l),Item_Rate:Number(a),UOM:s,Units:d,Amount:o,Product:t,Taxable_Amount:n?c.without_tax:o,Cgst_Amo:n&&!Z.IS_IGST?c.cgst_amount:0,Sgst_Amo:n&&!Z.IS_IGST?c.sgst_amount:0,Igst_Amo:n&&Z.IS_IGST?c.igst_amount:0,Final_Amo:n?c.with_tax:o,Tax_Rate:i,Cgst:Z.IS_IGST?0:c.cgst_per,Sgst:Z.IS_IGST?0:c.sgst_per,Igst:Z.IS_IGST?c.igst_per:0,Taxble:n?1:0};ae(-1!==u?e=>[...e.slice(0,u),m,...e.slice(u+1)]:e=>[...e,m])})(te.Item_Id,te.Bill_Qty,te.Item_Rate,te.Product,te.UOM,te.Units),ve()):m.m4.warn(te.Item_Id?te.Bill_Qty?"Enter Rate or Amount":"Enter Quantity":"Select Product")},children:[(0,y.jsx)(n.c,{children:(0,y.jsxs)("div",{className:"row pb-5",children:[(0,y.jsxs)("div",{className:"col-6 p-2",children:[(0,y.jsx)("label",{children:"Brand"}),(0,y.jsx)(c.cp,{value:{value:te.BrandID,label:te.Brand},onChange:e=>se((l=>({...l,BrandID:e.value,Brand:e.label}))),options:[{value:"",label:"select",isDisabled:!0},...H.map((e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name})))],styles:u.cF,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200})]}),(0,y.jsxs)("div",{className:"col-6 p-2",children:[(0,y.jsx)("label",{children:"Group"}),(0,y.jsx)(c.cp,{value:{value:te.GroupID,label:te.Group},onChange:e=>se((l=>({...l,GroupID:e.value,Group:e.label}))),options:[{value:"",label:"select",isDisabled:!0},...U.filter((e=>!te.BrandID||(0,h.Qr)(e.Brand,te.BrandID))).reduce(((e,l)=>(e.some((e=>e.value===l.Product_Group))||e.push({value:l.Product_Group,label:l.Pro_Group}),e)),[])],styles:u.cF,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200})]}),(0,y.jsxs)("div",{className:"col-12 p-2",children:[(0,y.jsxs)("label",{children:["Item Name ",(0,y.jsx)(S.c,{})]}),(0,y.jsx)(c.cp,{value:{value:te.Item_Id,label:te.ItemName},onChange:e=>{const l=U.find((l=>(0,h.Qr)(l.Product_Id,e.value)));se((a=>{var t,s,d,r,i,n,o;return{...a,Item_Id:e.value,ItemName:e.label,Product:null!==l&&void 0!==l?l:{},Group:null!==(t=l.Pro_Group)&&void 0!==t?t:a.Group,GroupID:null!==(s=l.Product_Group)&&void 0!==s?s:a.GroupID,Brand:null!==(d=l.Brand_Name)&&void 0!==d?d:a.Brand,BrandID:null!==(r=l.Brand)&&void 0!==r?r:a.BrandID,UOM:null!==(i=l.UOM_Id)&&void 0!==i?i:a.UOM,Units:null!==(n=l.Units)&&void 0!==n?n:a.Units,Item_Rate:null!==(o=l.Item_Rate)&&void 0!==o?o:0,Amount:0,Bill_Qty:0}}))},options:[{value:"",label:"select",isDisabled:!0},...[...U.filter((e=>!te.BrandID||(0,h.Qr)(e.Brand,te.BrandID))).filter((e=>!te.GroupID||(0,h.Qr)(e.Product_Group,te.GroupID)))].map((e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==le.findIndex((l=>(0,h.Qr)(null===l||void 0===l?void 0:l.Item_Id,null===e||void 0===e?void 0:e.Product_Id)))})))],styles:u.cF,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsxs)("label",{children:["Quantity ",(0,y.jsx)(S.c,{})]}),(0,y.jsx)("input",{type:"input",required:!0,value:te.Bill_Qty?te.Bill_Qty:"",onChange:e=>{te.Item_Rate?se((l=>({...l,Amount:(0,h.eX)(te.Item_Rate,e.target.value),Bill_Qty:e.target.value}))):se((l=>({...l,Bill_Qty:e.target.value})))},className:"cus-inpt",placeholder:"Quantity"})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsxs)("label",{children:["Rate ",(0,y.jsx)(S.c,{})]}),(0,y.jsx)("input",{type:"number",required:!0,value:te.Item_Rate?te.Item_Rate:"",onChange:e=>{te.Bill_Qty?se((l=>({...l,Amount:(0,h.eX)(e.target.value,te.Bill_Qty),Item_Rate:e.target.value}))):se((l=>({...l,Item_Rate:e.target.value})))},className:"cus-inpt",placeholder:"Rate"})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsx)("label",{children:"Amount"}),(0,y.jsx)("input",{type:"number",value:te.Amount?te.Amount:"",onChange:e=>{te.Bill_Qty?se((l=>({...l,Item_Rate:(0,h.yy)(e.target.value,te.Bill_Qty),Amount:e.target.value}))):se((l=>({...l,Amount:e.target.value})))},className:"cus-inpt",placeholder:"Amount"})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsx)("label",{children:"UOM"}),(0,y.jsx)(c.cp,{value:{value:te.UOM,label:te.Units},onChange:e=>se((l=>({...l,UOM:e.value,Units:e.label}))),options:[{value:"",label:"select",isDisabled:!0},...L.map((e=>({value:null===e||void 0===e?void 0:e.UOM_Id,label:null===e||void 0===e?void 0:e.UOM_Name})))],styles:u.cF,isSearchable:!0,placeholder:"Select UOM",maxMenuHeight:200})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsx)("label",{children:"HSN Code"}),(0,y.jsx)("input",{type:"text",value:(null===(l=te.Product)||void 0===l?void 0:l.HSN_Code)||"",className:"cus-inpt",readOnly:!0})]}),(0,y.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,y.jsx)("label",{children:"GST %"}),(0,y.jsx)("input",{type:"text",value:Z.IS_IGST?(null===(a=te.Product)||void 0===a?void 0:a.Igst_P)||0:(0,h.Q5)((null===(T=te.Product)||void 0===T?void 0:T.Cgst_P)||0,(null===(C=te.Product)||void 0===C?void 0:C.Sgst_P)||0),className:"cus-inpt",readOnly:!0})]})]})}),(0,y.jsxs)(o.c,{className:"border-top",children:[(0,y.jsx)(s.c,{variant:"outlined",color:"error",startIcon:(0,y.jsx)(j.c,{}),onClick:ve,children:"Clear"}),(0,y.jsx)(s.c,{variant:"outlined",color:"success",startIcon:(0,y.jsx)(g.c,{}),type:"submit",children:"Save"})]})]})]})]})}},80236:(e,l,a)=>{a.d(l,{W:()=>s,o:()=>t});const t=[{id:0,label:"New",color:" bg-info text-white "},{id:1,label:"Verified",color:" bg-warning text-white "},{id:2,label:"Converted",color:" bg-success text-white "},{id:3,label:"Canceled",color:" bg-danger text-white "}],s=[{id:1,label:"New",color:" bg-info text-white "},{id:2,label:"Progess",color:" bg-warning text-white "},{id:3,label:"Completed",color:" bg-success text-white "},{id:4,label:"Canceled",color:" bg-danger text-white "}]}}]);
//# sourceMappingURL=5816.f7fd193c.chunk.js.map