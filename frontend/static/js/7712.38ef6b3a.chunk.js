"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[7712],{17712:(e,l,a)=>{a.r(l),a.d(l,{default:()=>A});var d=a(69060),s=a(3358),i=a(5548),t=a(43692),r=a(89e3),o=a(78092),n=a(84436),c=a(82656),u=a(26773),v=a(4488),h=a(44380),m=a(90048),_=(a(67472),a(99852)),x=a(62344),p=a(39308),b=a(71412),j=a(61988),y=a(80236),g=a(1908),S=a(13724),I=a(55312),C=a(91924),N=a(91164),D=a(56480),f=a(82496);const A=e=>{var l;let{loadingOn:a,loadingOff:A}=e;const[T,P]=(0,d.useState)([]),L=JSON.parse(localStorage.getItem("user")),[F,w]=(0,d.useState)([]),[R,G]=(0,d.useState)([]),[k,V]=(0,d.useState)([]),[O,$]=(0,d.useState)([]),[H,q]=(0,d.useState)(!0),[B,E]=(0,d.useState)({}),[Q,W]=(0,d.useState)({}),[U,M]=(0,d.useState)(!1),[z,J]=(0,d.useState)([]),[Y,K]=(0,d.useState)([]),[X,Z]=(0,d.useState)(!1),[ee,le]=(0,d.useState)([]),[ae,de]=(0,d.useState)([]),se=(0,d.useState)(!0),ie=null===L||void 0===L?void 0:L.UserId,te=null===L||void 0===L?void 0:L.BranchId,[re,oe]=(0,d.useState)(!1),ne=()=>oe(!1),[ce,ue]=(0,d.useState)([]),ve={Fromdate:(0,p.SO)(7),Todate:(0,p.Q7)(),Retailer_Id:"",RetailerGet:"ALL",Created_by:"",CreatedByGet:"ALL",Sales_Person_Id:"",SalsePersonGet:"ALL",Cancel_status:0,Route_Id:"",RoutesGet:"ALL",Area_Id:"",AreaGet:"ALL"},[he,me]=(0,d.useState)(ve),[_e,xe]=(0,d.useState)([]),[pe,be]=(0,d.useState)(!1),[je,ye]=(0,d.useState)({Do_Date:(0,p.Q7)(),Vehicle_No:"",Trip_No:"",Trip_Date:(0,p.Q7)(),StartTime:"",Created_by:"",Delivery_Person_Id:"",Delivery_Location:"",Delivery_Time:"",Payment_Ref_No:"",Payment_Mode:"",Payment_Status:"",Narration:"",Alter_Id:"",Delivery_Status:"",GoDown_Id:"",GodDown_Name:""}),[ge,Se]=(0,d.useState)({filters:!1,orderDetails:!1});(0,d.useEffect)((()=>{(0,g.q)({address:`sales/saleDelivery?Fromdate=${null===he||void 0===he?void 0:he.Fromdate}&Todate=${null===he||void 0===he?void 0:he.Todate}&Retailer_Id=${null===he||void 0===he?void 0:he.Retailer_Id}&Sales_Person_Id=${null===he||void 0===he?void 0:he.Sales_Person_Id}&Created_by=${null===he||void 0===he?void 0:he.Created_by}&Cancel_status=${null===he||void 0===he?void 0:he.Cancel_status}&Route_Id=${null===he||void 0===he?void 0:he.Route_Id}&Area_Id=${null===he||void 0===he?void 0:he.Area_Id}`}).then((e=>{e.success&&w(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e)))}),[he.Fromdate,null===he||void 0===he?void 0:he.Todate,null===he||void 0===he?void 0:he.Retailer_Id,null===he||void 0===he?void 0:he.Sales_Person_Id,null===he||void 0===he?void 0:he.Created_by,null===he||void 0===he?void 0:he.Cancel_status,null===he||void 0===he?void 0:he.Route_Id,null===he||void 0===he?void 0:he.Area_Id,U]);(0,d.useEffect)((()=>{(0,g.q)({address:"masters/voucher"}).then((e=>{if(e.success){let l=e.data.filter((e=>"SALES"===e.Type));xe(l)}})).catch((e=>console.error(e))),(0,g.q)({address:`masters/retailers/dropDown?Company_Id=${null===L||void 0===L?void 0:L.Company_id}`}).then((e=>{e.success&&G(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:`masters/users/salesPerson/dropDown?Company_id=${null===L||void 0===L?void 0:L.Company_id}`}).then((e=>{e.success&&V(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:"purchase/stockItemLedgerName?type=SALES"}).then((e=>{e.success&&de(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:`masters/user/dropDown?Company_id=${null===L||void 0===L?void 0:L.Company_id}`}).then((e=>{e.success&&$(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:"/dataEntry/godownLocationMaster"}).then((e=>{e.success&&le(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:`masters/routes/dropdown?Company_id=${null===L||void 0===L?void 0:L.Company_id}`}).then((e=>{e.success&&J(e.data)})).catch((e=>console.error(e))),(0,g.q)({address:`masters/areas/dropdown?Company_id=${null===L||void 0===L?void 0:L.Company_id}`}).then((e=>{e.success&&K(e.data)})).catch((e=>console.error(e)))}),[]);const Ie=[{Field_Name:"checkbox",ColumnHeader:"",isVisible:1,pointer:!0,isCustomCell:!0,Cell:e=>{let{row:l}=e;const a=T.some((e=>e.So_Id===l.So_Id));return(0,f.jsx)("input",{type:"checkbox",checked:a,onChange:()=>(e=>{const l=T.some((l=>l.So_Id===e.So_Id));P(l?T.filter((l=>l.So_Id!==e.So_Id)):[...T,e])})(l),disabled:0!==(null===l||void 0===l?void 0:l.isConverted),onFocus:e=>{e.target.blur()},style:{cursor:"pointer",transform:"scale(1.5)",width:"14px",height:"20px"}})}},{Field_Name:"So_Id",ColumnHeader:"Order ID",Fied_Data:"string",isVisible:1},{Field_Name:"Retailer_Name",ColumnHeader:"Customer",Fied_Data:"string",isVisible:1},{Field_Name:"So_Date",ColumnHeader:"Sale Order Date",Fied_Data:"date",isVisible:1,align:"center"},{Field_Name:"So_Inv_No",ColumnHeader:"So_Inv_No",Fied_Data:"string",isVisible:1,align:"center"},{Field_Name:"Total_Before_Tax",ColumnHeader:"Before Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Tax",ColumnHeader:"Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Invoice_value",ColumnHeader:"Invoice Value",Fied_Data:"number",isVisible:1,align:"center"},{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,a;let{row:d}=e;const s=y.o.find((e=>e.id===Number(null===d||void 0===d?void 0:d.isConverted)));return(0,f.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(a=null===s||void 0===s?void 0:s.label)&&void 0!==a?a:"Undefined"})}},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(s.c,{title:"View Order",children:(0,f.jsx)(i.c,{onClick:()=>{W({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},color:"primary",size:"small",children:(0,f.jsx)(b.c,{className:"fa-16"})})})})}}],Ce=()=>{Se({...ge,filters:!1,orderDetails:!1}),E({})};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(t.c,{children:[(0,f.jsxs)("div",{className:"p-3 py-2 d-flex align-items-center justify-content-between",children:[(0,f.jsx)("h6",{className:"fa-18 m-0 p-0",children:H?"Sale Orders":(0,p.CY)(B)}),(0,f.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[T.length>0&&(0,f.jsxs)("h6",{className:"m-0 text-muted",children:["Selected Rows: ",T.length]}),H&&(0,f.jsx)(s.c,{title:"Filters",children:(0,f.jsx)(i.c,{size:"small",onClick:()=>Se({...ge,filters:!0}),children:(0,f.jsx)(j.c,{})})}),T.length>0&&H&&(0,f.jsx)(r.c,{variant:"outlined",onClick:()=>(e=>{if(!Array.isArray(e))return void console.error("Invalid data format. Expected an array.");oe(!0);const l=[],a=[];e.forEach((e=>{e&&(l.push(e),e.Products_List&&Array.isArray(e.Products_List)&&a.push(...e.Products_List))})),ue(l),ye({DeliveryList:l,Product_Array:a})})(T),children:"Convert To Delivery"}),H&&(0,f.jsx)(o.c,{checked:se,onChange:()=>{q(!1),Z(!0)},inputProps:{"aria-label":"controlled"}})]})]}),(0,f.jsx)(n.c,{className:"p-0",children:H?(0,f.jsx)(S.cp,{dataArray:F,columns:Ie,isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("table",{className:"table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,f.jsx)("td",{className:"border p-2",children:l.Branch_Name}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,f.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,f.jsx)("td",{className:"border p-2",children:l.Round_off})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,f.jsxs)("td",{className:"border p-2",children:[(0,p.Qr)(l.GST_Inclusive,1)&&"Inclusive",(0,p.Qr)(l.GST_Inclusive,0)&&"Exclusive"]}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,f.jsxs)("td",{className:"border p-2",children:[(0,p.Qr)(l.IS_IGST,1)&&"IGST",(0,p.Qr)(l.IS_IGST,0)&&"GST"]}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,f.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,f.jsx)("td",{className:"border p-2",colSpan:5,children:l.Narration})]})]})})})}}):X?(0,f.jsx)(N.c,{editValues:B,loadingOn:a,loadingOff:A,reload:()=>{M((e=>!e)),q((e=>!e))},switchScreen:()=>q(!0),onToggle:()=>{q((e=>!e)),Z((e=>!e))},triggerReload:()=>{M((e=>!e))}}):(0,f.jsx)(I.c,{editValues:B,loadingOn:a,loadingOff:A,reload:()=>{M((e=>!e)),q((e=>!e))},switchScreen:()=>q(!0),editOn:!0})})]}),Object.keys(Q).length>0&&(0,f.jsx)(C.c,{orderDetails:null===Q||void 0===Q?void 0:Q.orderDetails,orderProducts:null===Q||void 0===Q?void 0:Q.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>W({}),TitleText:"Sale Order"}),(0,f.jsxs)(c.c,{open:re,onClose:ne,fullWidth:!0,maxWidth:"sm",children:[(0,f.jsx)(u.c,{children:"Delivery Details"}),(0,f.jsx)(v.c,{children:(0,f.jsxs)("form",{children:[(0,f.jsxs)("td",{style:{verticalAlign:"middle"},children:["Delivery Date ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,f.jsx)(h.c,{fullWidth:!0,type:"date",name:"Do_Date",value:je.Do_Date,onChange:e=>{const{name:l,value:a}=e.target;ye((e=>({...e,[l]:a})))},InputLabelProps:{shrink:!0}}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{style:{verticalAlign:"middle"},children:["Godown ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,f.jsx)("div",{children:(0,f.jsx)(_.cp,{value:null!==je&&void 0!==je&&je.GoDown_Id?{value:null===je||void 0===je?void 0:je.GoDown_Id,label:null===je||void 0===je?void 0:je.GodDown_Name}:{value:"",label:"select",isDisabled:!0},onChange:e=>ye({...je,GoDown_Id:e.value,GodDown_Name:e.label}),options:[{value:"",label:"select",isDisabled:!0},...ee.map((e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:null===e||void 0===e?void 0:e.Godown_Name})))],styles:x.cF,isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{style:{verticalAlign:"middle"},children:["Ledger Name ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,f.jsx)(_.cp,{value:null!==je&&void 0!==je&&je.Stock_Item_Ledger_Name?{value:null===je||void 0===je?void 0:je.Stock_Item_Ledger_Id,label:null===je||void 0===je?void 0:je.Stock_Item_Ledger_Name}:{value:"",label:"select",isDisabled:!0},onChange:e=>ye({...je,Stock_Item_Ledger_Id:e.value,Stock_Item_Ledger_Name:e.label}),options:[{value:"",label:"select",isDisabled:!0},...(Array.isArray(ae)?ae:[]).map((e=>({value:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Id,label:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name})))],styles:x.cF,isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{style:{verticalAlign:"middle"},children:["Voucher Name ",(0,f.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,f.jsx)(_.cp,{value:void 0!==(null===je||void 0===je?void 0:je.Voucher_Type_Id)?{value:String(je.Voucher_Type_Id),label:je.Voucher_Type||"Select"}:{value:"",label:"Select",isDisabled:!0},onChange:e=>{ye({...je,Voucher_Type_Id:Number(e.value),Voucher_Type:e.label})},options:[{value:0,label:"Select",isDisabled:!0},...(_e||[]).map((e=>({value:String(e.Vocher_Type_Id),label:e.Voucher_Type})))],styles:x.cF,isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"},null!==(l=null===je||void 0===je?void 0:je.Voucher_Type_Id)&&void 0!==l?l:"reset-key")]})]})]})}),(0,f.jsxs)(m.c,{children:[(0,f.jsx)(r.c,{onClick:ne,children:"Cancel"}),(0,f.jsx)(r.c,{onClick:async()=>{if(pe)return;be(!0);const e={...je,DeliveryList:ce,Branch_Id:te,Created_by:ie};try{const l=await(0,g.q)({address:"delivery/multipleDelivery",method:"POST",bodyData:e});if(!l.success)return D.m4.error(l.message),!1;D.m4.success(l.message),me(ve),M((e=>!e)),ne(),P([])}catch(l){ne()}finally{be(!1)}},disabled:pe,style:{cursor:pe?"not-allowed":"pointer",opacity:pe?.3:1},children:pe?(0,f.jsx)(f.Fragment,{children:"Submitting..."}):"Submit"})]})]}),(0,f.jsxs)(c.c,{open:ge.filters,onClose:Ce,fullWidth:!0,maxWidth:"sm",children:[(0,f.jsx)(u.c,{children:"Filters"}),(0,f.jsx)(v.c,{children:(0,f.jsx)("div",{className:"table-responsive pb-4",children:(0,f.jsx)("table",{className:"table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,f.jsx)("td",{children:(0,f.jsx)(_.cp,{value:{value:null===he||void 0===he?void 0:he.Retailer_Id,label:null===he||void 0===he?void 0:he.RetailerGet},onChange:e=>me({...he,Retailer_Id:e.value,RetailerGet:e.label}),options:[{value:"",label:"ALL"},...R.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:x.cF,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Salse Person"}),(0,f.jsx)("td",{children:(0,f.jsx)(_.cp,{value:{value:null===he||void 0===he?void 0:he.Sales_Person_Id,label:null===he||void 0===he?void 0:he.SalsePersonGet},onChange:e=>me({...he,Sales_Person_Id:e.value,SalsePersonGet:e.label}),options:[{value:"",label:"ALL"},...k.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:x.cF,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,f.jsx)("td",{children:(0,f.jsx)(_.cp,{value:{value:null===he||void 0===he?void 0:he.Created_by,label:null===he||void 0===he?void 0:he.CreatedByGet},onChange:e=>me({...he,Created_by:e.value,CreatedByGet:e.label}),options:[{value:"",label:"ALL"},...O.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:x.cF,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,f.jsx)("td",{children:(0,f.jsx)("input",{type:"date",value:he.Fromdate,onChange:e=>me({...he,Fromdate:e.target.value}),className:"cus-inpt"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,f.jsx)("td",{children:(0,f.jsx)("input",{type:"date",value:he.Todate,onChange:e=>me({...he,Todate:e.target.value}),className:"cus-inpt"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,f.jsx)("td",{children:(0,f.jsxs)("select",{type:"date",value:he.Cancel_status,onChange:e=>me({...he,Cancel_status:Number(e.target.value)}),className:"cus-inpt",children:[(0,f.jsx)("option",{value:1,children:"Show"}),(0,f.jsx)("option",{value:0,children:"Hide"})]})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Routes"}),(0,f.jsx)("td",{children:(0,f.jsx)(_.cp,{value:{value:null===he||void 0===he?void 0:he.Route_Id,label:null===he||void 0===he?void 0:he.RoutesGet},onChange:e=>me({...he,Route_Id:e.value,RoutesGet:e.label}),options:[{value:"",label:"ALL"},...z.map((e=>({value:null===e||void 0===e?void 0:e.Route_Id,label:null===e||void 0===e?void 0:e.Route_Name})))],styles:x.cF,isSearchable:!0,placeholder:"Route Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Area"}),(0,f.jsx)("td",{children:(0,f.jsx)(_.cp,{value:{value:null===he||void 0===he?void 0:he.Area_Id,label:null===he||void 0===he?void 0:he.AreaGet},onChange:e=>me({...he,Area_Id:e.value,AreaGet:e.label}),options:[{value:"",label:"ALL"},...Y.map((e=>({value:null===e||void 0===e?void 0:e.Area_Id,label:null===e||void 0===e?void 0:e.Area_Name})))],styles:x.cF,isSearchable:!0,placeholder:"Area Name"})})]})]})})})}),(0,f.jsx)(m.c,{children:(0,f.jsx)(r.c,{onClick:Ce,children:"close"})})]})]})}}}]);
//# sourceMappingURL=7712.38ef6b3a.chunk.js.map