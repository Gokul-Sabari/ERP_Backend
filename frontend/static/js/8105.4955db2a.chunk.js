"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8105],{48105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(30800),c=a(69060),r=a(1908),l=a(3358),n=a(5548),o=a(82656),d=a(26773),i=a(4488),u=a(44380),m=a(90048),h=a(87016),x=a(57704),_=a(86e3),v=a(45180),p=a(51560),D=a(56480),j=a(13724),g=a(42136),I=a(39308),R=a(73380),w=a.n(R),N=a(85592),b=a.n(N),f=a(26592),S=a(82496);const C={Fromdate:(0,I.Q7)(),NewDate:""},F=e=>{const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(c)};const P=function(e){var t,a;let{loadingOn:R,loadingOff:N}=e;const[P,A]=(0,c.useState)({Fromdate:C.Fromdate,fetchFrom:C.Fromdate,NewDate:C.NewDate,fetchNew:C.NewDate}),[y,M]=(0,c.useState)(!1),[B,k]=(0,c.useState)({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),[O,E]=(0,c.useState)(!1),[T,q]=(0,c.useState)([]),[W,Y]=(0,c.useState)([]),[L,z]=(0,c.useState)([]),H=(0,p.i6)(),U=(0,p.IT)(),V=new URLSearchParams((0,p.IT)().search),[Q,G]=(0,c.useState)(""),[J,K]=(0,c.useState)([]),[X,Z]=(0,c.useState)(!1),[$,ee]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const e={Fromdate:V.get("Fromdate")&&(0,I.e8)(V.get("Fromdate"))?V.get("Fromdate"):C.Fromdate,NewDate:V.get("NewDate")&&(0,I.e8)(V.get("NewDate"))?V.get("NewDate"):C.NewDate};A((t=>(0,s.c)((0,s.c)({},t),{},{fetchFrom:e.Fromdate,fetchNew:e.NewDate})))}),[U.search]),(0,c.useEffect)((()=>{(0,r.q)({address:"masters/posRateMaster?FromDate=".concat(null===P||void 0===P?void 0:P.Fromdate)}).then((e=>{e.success&&(K(e),z(e.data))})).catch((e=>console.error(e))),(0,r.q)({address:"masters/posbranch/dropdown"}).then((e=>{e.success&&q(e.data)})).catch((e=>console.error(e)))}),[P.Fromdate,X]),(0,c.useEffect)((()=>{Q&&(async e=>{(0,r.q)({address:"masters/posbrand/productList?Pos_Brand_Id=".concat(e)}).then((e=>{e.success&&Y(e.data)})).catch((e=>console.error(e)))})(Q)}),[Q]),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"date-inputs",children:(0,S.jsxs)("div",{className:"p-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,S.jsxs)("h5",{className:"m-0 my-1 flex-grow-1 d-flex align-items-center flex-wrap",children:[(0,S.jsx)("span",{className:"mx-2",children:"Rate Master"}),(0,S.jsx)(g.c,{onClick:()=>ee(!0),children:"Export To"}),(0,S.jsx)(g.c,{className:"mx-2 btn btn-dark",style:{outline:"none",boxShadow:"none"},onClick:async()=>{const e=L.filter((e=>1===e.Is_Active_Decative));if(0===e.length)return void alert("No active data available for download.");const t=e.reduce(((e,t)=>{const{Pos_Brand_Id:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{});const a=new(b().Workbook),s=a.addWorksheet("PriceList_Data"),c=e.length>0?e[0].Rate_Date.split("T")[0].split("-").reverse().join("-"):"";s.addRow([c,"PriceList"]).font={bold:!0,size:14},Object.entries(t).forEach((e=>{let[t,a]=e;const c=s.addRow([a[0].POS_Brand_Name]).getCell(1);c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF00"}},c.font={bold:!0,size:12},a.forEach((e=>{s.addRow([e.Short_Name,e.Max_Rate])}))})),s.columns=[{width:40},{width:15}];const r=await a.xlsx.writeBuffer(),l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,f.saveAs)(l,"PriceList_Data.xlsx")},children:"Download Excel"})]}),(0,S.jsx)(l.c,{title:"Sync Data",children:(0,S.jsx)(n.c,{onClick:()=>{(0,r.q)({address:"masters/posproductSync"}).then((e=>{e&&D.m4.success(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e)))},children:(0,S.jsx)(h.c,{})})}),(0,S.jsx)("div",{children:(0,S.jsx)("input",{type:"date",value:P.Fromdate,onChange:e=>{const t=e.target.value;A((0,s.c)((0,s.c)({},P),{},{Fromdate:t,fetchFrom:t}))},className:"cus-inpt w-auto p-1"})}),(0,S.jsx)(n.c,{onClick:()=>{(e=>{const t=new URLSearchParams(e);H("?".concat(t.toString()),{replace:!0})})({Fromdate:null===P||void 0===P?void 0:P.Fromdate})},variant:"outlined",size:"small",children:(0,S.jsx)(x.c,{})}),(null===P||void 0===P?void 0:P.Fromdate)===w()().format("YYYY-MM-DD")?(0,S.jsx)(g.c,{onClick:()=>M(!0),children:"Add"}):null]})}),(0,S.jsx)(j.cp,{dataArray:L,EnableSerialNumber:!0,isExpendable:!0,maxHeightOption:!0,columns:[(0,j.A5)("Rate_Date","date","Rate Date"),(0,j.A5)("POS_Brand_Name","string","Brand"),(0,j.A5)("Short_Name","string","Product"),(0,j.A5)("Rate","string","Rate"),(0,j.A5)("Max_Rate","string","MaxRate"),{Field_Name:"Is_Active_Decative",ColumnHeader:"Status",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;const a=1===t.Is_Active_Decative?"Active":"Inactive";return(0,S.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 text-white",style:{backgroundColor:"Active"===a?"green":"red"},children:a})}},(null===P||void 0===P?void 0:P.Fromdate)===w()().format("YYYY-MM-DD")?{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,S.jsxs)("td",{style:{minWidth:"80px"},children:[(0,S.jsx)(n.c,{onClick:()=>{return e=t,M(!0),k({Id:null===e||void 0===e?void 0:e.Id,Rate_Date:F(e.Rate_Date),Pos_Brand_Id:e.Pos_Brand_Id,Item_Id:e.Item_Id,Rate:e.Rate,MaxRate:e.Max_Rate,Is_Active_Decative:e.Is_Active_Decative,POS_Brand_Name:e.POS_Brand_Name,Product_Name:e.Product_Name}),void G(e.Pos_Brand_Id);var e},size:"small",children:(0,S.jsx)(_.c,{className:"fa-in"})}),(0,S.jsx)(n.c,{onClick:()=>{E(!0),k({Id:t.Id})},size:"small",color:"error",children:(0,S.jsx)(v.c,{className:"fa-in "})})]})}}:{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,S.jsx)("td",{children:"-"})}}]}),(0,S.jsxs)(o.c,{open:y,onClose:()=>M(!1),fullWidth:!0,maxWidth:"sm",children:[(0,S.jsxs)(d.c,{children:[B.Id?"UPDATE":"CREATE"," RATE MASTER"]}),(0,S.jsxs)("form",{onSubmit:e=>{e.preventDefault(),B.Id?(0,r.q)({address:"masters/posRateMaster",method:"PUT",bodyData:(0,s.c)((0,s.c)({},B),{},{Rate_Date:F(B.Rate_Date)})}).then((e=>{e.success?(D.m4.success("Rate Master updated successfully!"),M(!1),Z(!X),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),G("")):D.m4.error("Failed to update Rate Master:",e.message)})).catch((e=>{throw e})):(0,r.q)({address:"masters/posRateMaster",method:"POST",bodyData:(0,s.c)((0,s.c)({},B),{},{Pos_Brand_Id:Q,Item_Id:B.Item_Id,Rate_Date:F(B.Rate_Date)})}).then((e=>{e.success?(M(!1),D.m4.success(e.message),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"-",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),G(""),Z(!X)):D.m4.error(e.message)})).catch((e=>console.error(e)))},children:[(0,S.jsxs)(i.c,{children:[(0,S.jsx)("label",{children:"Rate Date"}),(0,S.jsx)("input",{type:"date",value:B.Rate_Date,onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Rate_Date:e.target.value})),className:"cus-inpt"}),(0,S.jsx)("label",{children:"POS Brand"}),(0,S.jsxs)("select",{value:Q,onChange:e=>{const t=e.target.value;G(t),k((0,s.c)((0,s.c)({},B),{},{Pos_Brand_Id:t}))},className:"cus-inpt",children:[(0,S.jsx)("option",{value:"",disabled:!0,children:"Select POS Brand"}),T.map(((e,t)=>(0,S.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,S.jsx)("label",{children:"Product"}),(0,S.jsxs)("select",{className:"cus-inpt",disabled:!Q,value:B.Item_Id,onChange:e=>{k((0,s.c)((0,s.c)({},B),{},{Item_Id:e.target.value}))},children:[(0,S.jsx)("option",{value:"",disabled:!0,children:"Select Product"}),W.length>0?W.map(((e,t)=>(0,S.jsx)("option",{value:e.value,children:e.label},t))):(0,S.jsx)("option",{value:"",disabled:!0,children:"No products available"})]}),(0,S.jsx)("label",{children:"Rate"}),(0,S.jsx)(u.c,{label:"",value:null!==(t=B.Rate)&&void 0!==t?t:"",onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Rate:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,S.jsx)("label",{children:"Max Rate"}),(0,S.jsx)(u.c,{label:"",value:null!==(a=B.MaxRate)&&void 0!==a?a:"",onChange:e=>k((0,s.c)((0,s.c)({},B),{},{MaxRate:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined"}),(0,S.jsx)("label",{children:"Status"}),(0,S.jsxs)("select",{className:"cus-inpt",value:B.Is_Active_Decative,onChange:e=>k((0,s.c)((0,s.c)({},B),{},{Is_Active_Decative:e.target.value})),children:[(0,S.jsx)("option",{value:"",disabled:!0,children:"Select "}),(0,S.jsx)("option",{value:"1",children:"Active"}),(0,S.jsx)("option",{value:"0",children:"Inactive"})]})]}),(0,S.jsxs)(m.c,{children:[(0,S.jsx)(g.c,{onClick:()=>{k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),M(!1)},children:"Cancel"}),(0,S.jsx)(g.c,{type:"submit",variant:"contained",children:"Save"})]})]})]}),(0,S.jsxs)(o.c,{open:O,onClose:()=>E(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,S.jsx)(d.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,S.jsx)(i.c,{children:(0,S.jsx)("b",{children:"Do you want to delete the RateMaster?"})}),(0,S.jsxs)(m.c,{children:[(0,S.jsx)(g.c,{onClick:()=>E(!1),children:"Cancel"}),(0,S.jsx)(g.c,{onClick:()=>(B.Id,void(0,r.q)({address:"masters/posRateMaster",method:"DELETE",bodyData:{Id:B.Id}}).then((e=>{e.success?(Z(!X),E(!1),M(!1),k({Rate_Date:(new Date).toISOString().split("T")[0],Pos_Brand_Id:"",Item_Id:"",Rate:"",Is_Active_Decative:"",POS_Brand_Name:"",Product_Name:"",MaxRate:""}),G(""),D.m4.success("Rate Master deleted successfully!")):D.m4.error("Failed to delete area:",e.message)})).catch((e=>console.error(e)))),autoFocus:!0,color:"error",children:"Delete"})]})]}),(0,S.jsxs)(o.c,{open:$,onClose:()=>ee(!1),fullWidth:!0,maxWidth:"sm",children:[(0,S.jsx)(d.c,{id:"alert-dialog-title",children:"Confirmation"}),(0,S.jsx)(i.c,{children:(0,S.jsxs)("b",{children:["Do you want to export data from:",(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{children:"From Date"}),(0,S.jsx)("input",{type:"date",disabled:!0,value:P.Fromdate,onChange:e=>{const t=e.target.value;A((0,s.c)((0,s.c)({},P),{},{Fromdate:t,fetchFrom:t}))},className:"cus-inpt w-auto p-1"})]}),(0,S.jsx)("br",{}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{children:"New Date"}),(0,S.jsx)("input",{type:"date",value:P.NewDate,onChange:e=>{const t=e.target.value;A((0,s.c)((0,s.c)({},P),{},{NewDate:t}))},className:"cus-inpt w-auto p-1"})]})]})}),(0,S.jsxs)(m.c,{children:[(0,S.jsx)(g.c,{onClick:()=>ee(!1),children:"Cancel"}),(0,S.jsx)(g.c,{onClick:()=>(async()=>{if(R&&R(),null===P||void 0===P||!P.Fromdate||null===P||void 0===P||!P.NewDate)throw new Error("Both 'From Date' and 'New Date' are required.");(0,r.q)({address:"masters/exportRateMaster?FromDate=".concat(null===P||void 0===P?void 0:P.Fromdate,"&NewDate=").concat(null===P||void 0===P?void 0:P.NewDate),method:"POST",bodyData:{bulkData:J}}).then((e=>{e.success?(D.m4.success(e.message),ee(!1),A((0,s.c)((0,s.c)({},P),{},{NewDate:""}))):D.m4.error(e.message)})).catch((e=>console.error(e))).finally((()=>{N&&N()}))})(),autoFocus:!0,color:"primary",children:"Export"})]})]})]})}}}]);
//# sourceMappingURL=8105.4955db2a.chunk.js.map