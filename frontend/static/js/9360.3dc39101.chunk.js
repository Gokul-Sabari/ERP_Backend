"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[9360,3692],{64568:(e,l,a)=>{a.d(l,{c:()=>t});var s=a(82496);const t=()=>(0,s.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},99360:(e,l,a)=>{a.r(l),a.d(l,{default:()=>C});var s=a(30800),t=a(43692),c=a(84436),o=a(89e3),d=a(39308),i=a(1908),n=a(40656),r=a(69060),u=a(51560),v=a(27664),m=a(82496);const h=(0,v.c)((0,m.jsx)("path",{d:"M2.81 2.81 1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20M7.94 5.12 6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.46-1.46C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12"}),"HideSource");var p=a(30796);const x=(0,d.gV)().user,j={collection_id:"",collection_inv_no:"",voucher_id:"",collection_no:"",year_id:"",retailer_id:"",payed_by:"",collection_date:(0,d.Q7)(),collection_type:"CASH",payment_status:"",latitude:"",longitude:"",collected_by:"",total_amount:0,created_on:"",alterd_on:"",narration:"",verify_status:0,bank_date:"",created_by:x.UserId,updated_by:x.UserId,verified_by:x.UserId,verified_at:""},_={auto_id:"",collection_id:"",bill_id:"",bill_amount:0,collected_amount:0},y=e=>{var l,a;let{loadingOn:i,loadingOff:n,row:u={},receiptsPaymentInfo:v=[],setReceiptsPaymentInfo:x,collection_type:j}=e;const[y,N]=(0,r.useState)(!1),[b,C]=(0,r.useState)(!0),f=(0,r.useMemo)((()=>{const e=v.find((e=>(0,d.Qr)(null===e||void 0===e?void 0:e.bill_id,null===u||void 0===u?void 0:u.Do_Id)));return(0,d.CY)(e)?e:{}}),[v]),g=(0,r.useMemo)((()=>v.findIndex((e=>(0,d.Qr)(null===e||void 0===e?void 0:e.bill_id,null===u||void 0===u?void 0:u.Do_Id)))),[v]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(t.c,{className:"my-2",children:[(0,m.jsxs)("div",{className:"px-3 py-2 d-flex align-items-center flex-wrap border-bottom",children:[(0,m.jsxs)("div",{className:"flex-grow-1",children:[(0,m.jsx)("h5",{className:"m-0 fa-16 w-100",children:null===u||void 0===u?void 0:u.Do_Inv_No}),(0,m.jsx)("span",{className:"fa-12 text-muted",children:(0,d.uy)(null===u||void 0===u?void 0:u.Do_Date)})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("h5",{className:"fa-15 w-100",children:["Pending \u20b9",(0,d.SA)((0,d.gH)(null===u||void 0===u?void 0:u.PayableValue))]}),(0,m.jsxs)("h5",{className:"m-0 fa-13 text-muted text-end w-100",children:["Total \u20b9",(0,d.SA)((0,d.gH)(null===u||void 0===u?void 0:u.Total_Invoice_value))]}),(0,m.jsxs)("h5",{className:"m-0 fa-13 text-muted text-end w-100",children:["Tax \u20b9",(0,d.SA)((0,d.gH)(null===u||void 0===u?void 0:u.Total_Tax))]})]})]}),(0,m.jsxs)(c.c,{className:"pb-2",children:[(0,m.jsxs)("div",{className:"pb-2",children:[(0,m.jsx)("div",{className:"d-flex align-items-end justify-content-end ",children:(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"fa-14 w-100",children:"Receipt Amount (\u20b9)"}),(0,m.jsx)("input",{onInput:d.Gk,value:null!==f&&void 0!==f&&f.collected_amount?(0,d.gH)(null===f||void 0===f?void 0:f.collected_amount):"",onChange:e=>{return l="collected_amount",a=e.target.value,void x((e=>{const t=[...e];if(-1===g){const e=(0,s.c)({},_);return e.bill_id=null===u||void 0===u?void 0:u.Do_Id,e.bill_amount=(0,d.gH)(null===u||void 0===u?void 0:u.Total_Invoice_value),e[l]=a,[...t,e]}return t[g][l]=a,t}));var l,a},className:"cus-inpt border p-2",placeholder:"Enter Receipt Amount"})]})}),b&&(0,m.jsx)("div",{className:"table-responsive table-bordered fa-13 m-0 mt-2",children:(0,m.jsxs)("table",{className:"table m-0",children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:["SNo","Item","Quantity","Rate","Pack","Tax","Amount"].map(((e,l)=>(0,m.jsx)("th",{className:"bg-light",children:e},l)))})}),(0,m.jsx)("tbody",{children:Array.isArray(null===u||void 0===u?void 0:u.Products_List)&&u.Products_List.map(((e,l)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:l+1}),(0,m.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,m.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,m.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,m.jsx)("td",{children:null===e||void 0===e?void 0:e.UOM}),(0,m.jsx)("td",{children:(0,d.Q5)(null===e||void 0===e?void 0:e.Cgst_Amo,null===e||void 0===e?void 0:e.Sgst_Amo)||(0,d.gH)(null===e||void 0===e?void 0:e.Igst_Amo)}),(0,m.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount})]},l)))})]})})]}),(0,m.jsx)(o.c,{startIcon:y?(0,m.jsx)(h,{}):(0,m.jsx)(p.c,{}),onClick:()=>N((e=>!e)),disabled:!Array.isArray(null===u||void 0===u?void 0:u.Payments)||0===(0,d.gH)(null===u||void 0===u||null===(l=u.Payments)||void 0===l?void 0:l.length),children:"Previous Receipts"}),y&&(0,m.jsx)("div",{className:"table-responsive table-bordered fa-13 mt-2",children:(0,m.jsxs)("table",{className:"table",children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:["SNo","Collected By","Amount","Date","Receipt Type","payment_status","Verify Status"].map(((e,l)=>(0,m.jsx)("th",{className:"bg-light border",children:e},l)))})}),(0,m.jsx)("tbody",{children:null===(a=Array.isArray(null===u||void 0===u?void 0:u.Payments)?null===u||void 0===u?void 0:u.Payments:[])||void 0===a?void 0:a.map(((e,l)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border",children:l+1}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.CreatedByGet}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collected_amount}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_date}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,m.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.verify_status})]},l)))})]})})]})]})})};var N=a(56480);a(64568);const b=[{type:"CASH",default:"CREATED-CASH",statusOptions:["CREATED-CASH","CASH-PROCESSING","CASH-MISSING"]},{type:"UPI",default:"CREATED-UPI",statusOptions:["CREATED-UPI","UPI-PROCESSING","UPI-NOT-RECEIVED"]},{type:"CHECK",default:"CREATED-CHECK",statusOptions:["CREATED-CHECK","CHECK-PROCESSING","CHECK-BOUNCE"]},{type:"BANK ACCOUNT",default:"CREATED-BANK-TRANSFER",statusOptions:["CREATED-BANK-TRANSFER","BANK-PROCESSING","BANK-NOT-RECEIVED"]}],C=e=>{let{loadingOn:l,loadingOff:a}=e;(0,d.gV)().user,(0,u.i6)(),(0,u.IT)().state,new URLSearchParams((0,u.IT)().search);const[v,h]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),[_,C]=(0,r.useState)({salesPerson:[],voucherData:[]}),[f,g]=(0,r.useState)(j),[S,R]=(0,r.useState)([]),[A,E]=(0,r.useState)({Fromdate:(0,d.Q7)(),Todate:(0,d.Q7)(),Retailer:{value:"",label:"Search by Retailer..."}}),I=b.find((e=>e.type===(null===f||void 0===f?void 0:f.collection_type))).statusOptions;(0,r.useEffect)((()=>{(0,i.q)({address:"delivery/getRetailersWhoHasBills"}).then((e=>{e.success?x(e.data):x([])})).catch((e=>console.error(e))),(0,i.q)({address:"masters/users/salesPerson/dropDown"}).then((e=>{e.success?C((l=>(0,s.c)((0,s.c)({},l),{},{salesPerson:e.data}))):C((e=>(0,s.c)((0,s.c)({},e),{},{salesPerson:[]})))})).catch((e=>console.error(e))),(0,i.q)({address:"masters/voucher"}).then((e=>{e.success?C((l=>(0,s.c)((0,s.c)({},l),{},{voucherData:e.data}))):C((e=>(0,s.c)((0,s.c)({},e),{},{voucherData:[]})))})).catch((e=>console.error(e)))}),[]),(0,r.useEffect)((()=>{(0,d.Q$)(f.retailer_id)&&(l&&l(),(0,i.q)({address:"delivery/retailerPendingBills?retailer_id=".concat(f.retailer_id)}).then((e=>{e.success?h(e.data):h([])})).catch((e=>console.error(e))).finally((()=>{a&&a()})))}),[f.retailer_id]);const P=()=>{l&&l(),(0,i.q)({address:"delivery/paymentCollection",method:(0,d.Q$)(f.collection_id)&&f.collection_id>0?"PUT":"POST",bodyData:(0,s.c)((0,s.c)({},f),{},{Collections:S})}).then((e=>{e.success?(N.m4.success((null===e||void 0===e?void 0:e.message)||"Receipt Created"),g(j),R([]),E((e=>(0,s.c)((0,s.c)({},e),{},{Retailer:{value:"",label:"Search by Retailer..."}})))):N.m4.error((null===e||void 0===e?void 0:e.message)||"Failed to create Receipt")})).catch((e=>console.error(e))).finally((()=>{a&&a()}))};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(t.c,{children:[(0,m.jsx)("div",{className:"px-3 py-2",children:(0,m.jsx)("h5",{className:"m-0",children:"Receipt Creation"})}),(0,m.jsx)("form",{onSubmit:e=>{e.preventDefault(),P()},children:(0,m.jsxs)(c.c,{className:"pb-2",children:[(0,m.jsx)("label",{children:"Retailer"}),(0,m.jsx)("div",{className:"d-flex",children:(0,m.jsx)("div",{style:{width:"100%",maxWidth:"400px"},children:(0,m.jsx)(n.cp,{menuPortalTarget:document.body,options:[{value:"",label:"select",isDisabled:!0},...p.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],value:A.Retailer,menu:!0,onChange:e=>{E((l=>(0,s.c)((0,s.c)({},l),{},{Retailer:e}))),g((l=>(0,s.c)((0,s.c)({},l),{},{retailer_id:e.value})))},placeholder:"Search by Retailer"})})}),(0,m.jsxs)("div",{className:"row fa-13 border-bottom pb-3",children:[(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Payed By"}),(0,m.jsx)("input",{className:"cus-inpt p-2",value:f.payed_by,placeholder:"Owner, Shop Keeper..",onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{payed_by:e.target.value})))})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Date"}),(0,m.jsx)("input",{type:"date",className:"cus-inpt p-2",value:f.collection_date,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{collection_date:e.target.value}))),required:!0})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Type"}),(0,m.jsxs)("select",{className:"cus-inpt p-2",value:f.collection_type,required:!0,onChange:e=>g((l=>{var a;return(0,s.c)((0,s.c)({},l),{},{collection_type:e.target.value,payment_status:null===(a=b.find((l=>l.type===e.target.value)))||void 0===a?void 0:a.default})})),children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,m.jsx)("option",{value:"CASH",children:"CASH"}),(0,m.jsx)("option",{value:"UPI",children:"UPI"}),(0,m.jsx)("option",{value:"CHECK",children:"CHECK"}),(0,m.jsx)("option",{value:"BANK ACCOUNT",children:"BANK ACCOUNT"})]})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Payment Status"}),(0,m.jsxs)("select",{className:"cus-inpt p-2",value:f.payment_status,required:!0,disabled:!f.collection_type,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{payment_status:e.target.value}))),children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Select"}),I.map(((e,l)=>(0,m.jsx)("option",{value:e,children:e},l)))]})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Voucher"}),(0,m.jsxs)("select",{className:"cus-inpt p-2",value:f.voucher_id,required:!0,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{voucher_id:e.target.value}))),children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Select"}),_.voucherData.map(((e,l)=>(0,m.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l)))]})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,m.jsx)("label",{children:"Amount Received By"}),(0,m.jsxs)("select",{className:"cus-inpt p-2",value:f.collected_by,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{collected_by:e.target.value}))),required:!0,children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Select"}),_.salesPerson.map(((e,l)=>(0,m.jsx)("option",{value:e.UserId,children:e.Name},l)))]})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,m.jsx)("label",{className:"fa-14",children:"Bank Date"}),(0,m.jsx)("input",{type:"date",value:null!==f&&void 0!==f&&f.bank_date?null===f||void 0===f?void 0:f.bank_date:"",onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{bank_date:e.target.value}))),className:"cus-inpt border p-2"})]}),(0,m.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,m.jsx)("label",{className:"fa-14",children:"Verify Status"}),(0,m.jsxs)("select",{value:null===f||void 0===f?void 0:f.verify_status,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{verify_status:e.target.value}))),className:"cus-inpt border p-2",children:[(0,m.jsx)("option",{value:0,children:"Not-verified"}),(0,m.jsx)("option",{value:1,children:"verified"})]})]}),(0,m.jsxs)("div",{className:"col-12 p-1",children:[(0,m.jsx)("label",{className:"fa-14 w-100",children:"Narration"}),(0,m.jsx)("textarea",{style:{width:"100%",maxWidth:"450px"},className:"cus-inpt border p-2",value:null===f||void 0===f?void 0:f.narration,onChange:e=>g((l=>(0,s.c)((0,s.c)({},l),{},{narration:e.target.value}))),placeholder:"Narration..."})]})]}),(0,m.jsx)("div",{className:"d-flex justify-content-end mt-2",children:(0,m.jsx)(o.c,{variant:"outlined",type:"submit",disabled:0===S.length||S.every((e=>(0,d.gH)(e.collected_amount)<=0)),children:"save receipt"})})]})})]}),v.map(((e,s)=>(0,m.jsx)(y,{loadingOff:a,loadingOn:l,row:e,collection_type:null===f||void 0===f?void 0:f.collection_type,receiptsPaymentInfo:S,setReceiptsPaymentInfo:R},s)))]})}},30796:(e,l,a)=>{a.d(l,{c:()=>c});var s=a(27664),t=a(82496);const c=(0,s.c)((0,t.jsx)("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List")},84436:(e,l,a)=>{a.d(l,{c:()=>x});var s=a(45072),t=a(95656),c=a(69060),o=a(79736),d=a(21412),i=a(12556),n=a(49836),r=a(10099),u=a(33448);function v(e){return(0,u.cp)("MuiCardContent",e)}(0,r.c)("MuiCardContent",["root"]);var m=a(82496);const h=["className","component"],p=(0,i.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=c.forwardRef((function(e,l){const a=(0,n.C)({props:e,name:"MuiCardContent"}),{className:c,component:i="div"}=a,r=(0,t.c)(a,h),u=(0,s.c)({},a,{component:i}),x=(e=>{const{classes:l}=e;return(0,d.c)({root:["root"]},v,l)})(u);return(0,m.jsx)(p,(0,s.c)({as:i,className:(0,o.c)(x.root,c),ownerState:u,ref:l},r))}))},43692:(e,l,a)=>{a.d(l,{c:()=>j});var s=a(45072),t=a(95656),c=a(69060),o=a(79736),d=a(21412),i=a(12556),n=a(49836),r=a(85624),u=a(10099),v=a(33448);function m(e){return(0,v.cp)("MuiCard",e)}(0,u.c)("MuiCard",["root"]);var h=a(82496);const p=["className","raised"],x=(0,i.cp)(r.c,{name:"MuiCard",slot:"Root",overridesResolver:(e,l)=>l.root})((()=>({overflow:"hidden"}))),j=c.forwardRef((function(e,l){const a=(0,n.C)({props:e,name:"MuiCard"}),{className:c,raised:i=!1}=a,r=(0,t.c)(a,p),u=(0,s.c)({},a,{raised:i}),v=(e=>{const{classes:l}=e;return(0,d.c)({root:["root"]},m,l)})(u);return(0,h.jsx)(x,(0,s.c)({className:(0,o.c)(v.root,c),elevation:i?8:void 0,ref:l,ownerState:u},r))}))}}]);
//# sourceMappingURL=9360.3dc39101.chunk.js.map