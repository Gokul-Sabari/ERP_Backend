"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[312],{20312:(e,a,l)=>{l.r(a),l.d(a,{default:()=>E});var t=l(30800),n=l(18256),i=l(29720),o=l(61584),r=l(5548),d=l(12572),s=l(15786),m=l(69060),c=l(39308),u=l(57704),_=l(1908),p=l(13724),v=l(71448),x=l(52924),g=l(44380),h=l(3358),y=l(82656),N=l(4488),b=l(90048),j=l(89e3),C=l(26773),f=l(43692),F=l(85624),D=l(78092),T=l(68424),S=l(39504),O=l(12120),w=l(74912),k=l(61988),B=l(82496);const Q=(0,B.jsx)(T.c,{fontSize:"small"}),G=(0,B.jsx)(S.c,{fontSize:"small"}),A=e=>{let{loadingOn:a,loadingOff:l,Fromdate:n,Todate:i,api:o="itemWise",defaultGrouping:d="",storageStockColumns:s=[],groupingOption:u=!0}=e;const[T,S]=(0,m.useState)([]),[A,P]=(0,m.useState)({}),[z,E]=(0,m.useState)(d),[I,W]=(0,m.useState)([]),[M,V]=(0,m.useState)(!1),[q,H]=(0,m.useState)(!1),L=s.map(((e,a)=>({isVisible:a<11?1:0,Field_Name:null===e||void 0===e?void 0:e.Column_Name,Fied_Data:null===e||void 0===e?void 0:e.Data_Type,OrderBy:a+1}))),[R,$]=(0,m.useState)(L);(0,m.useEffect)((()=>{(0,_.q)({address:"reports/storageStock/".concat(o,"?Fromdate=").concat(n,"&Todate=").concat(i),loadingOn:a,loadingOff:l}).then((e=>{e.success&&S((0,c.dq)(e.data))}))}),[n,i]);const J=(0,m.useMemo)((()=>[...R].sort(((e,a)=>null!==e&&void 0!==e&&e.OrderBy&&null!==a&&void 0!==a&&a.OrderBy?(null===e||void 0===e?void 0:e.OrderBy)-(null===a||void 0===a?void 0:a.OrderBy):(null===a||void 0===a?void 0:a.OrderBy)-(null===e||void 0===e?void 0:e.OrderBy)))),[R]),K=(0,m.useMemo)((()=>J.filter((e=>(0,c.Qr)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,c.Qr)(null===e||void 0===e?void 0:e.isVisible,1)))),[J]),U=(0,m.useMemo)((()=>{const e=Object.keys(A).length>0,a=!!z,l=e?I:T,n=a?(0,c.ui)(l,z):[],i=K.filter((e=>"number"===(0,c.MP)(e.Fied_Data))).map((e=>e.Field_Name)),o=n.map((e=>(0,t.c)((0,t.c)({},e),Object.fromEntries(i.map((a=>{var l;return[a,null===e||void 0===e||null===(l=e.groupedData)||void 0===l?void 0:l.reduce(((e,l)=>(0,c.Q5)(e,(0,c.gH)(l[a])||0)),0)]}))))));return a?o:l}),[A,T,I,z,K]);(0,m.useEffect)((()=>{Y()}),[A]);const X=(e,a)=>{P((l=>(0,t.c)((0,t.c)({},l),{},{[e]:a})))},Y=()=>{let e=[...T];for(const l of J)if(A[l.Field_Name])if("range"===A[l.Field_Name].type){const{min:a,max:t}=A[l.Field_Name];e=e.filter((e=>{const n=e[l.Field_Name];return(void 0===a||n>=a)&&(void 0===t||n<=t)}))}else if("date"===A[l.Field_Name].type){const{start:a,end:t}=A[l.Field_Name].value;e=e.filter((e=>{const n=new Date(e[l.Field_Name]);return(void 0===a||n>=new Date(a))&&(void 0===t||n<=new Date(t))}))}else if(Array.isArray(A[l.Field_Name])){var a;e=(null===(a=A[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter((e=>{var a;return A[l.Field_Name].includes(null===(a=e[l.Field_Name])||void 0===a?void 0:a.toLowerCase().trim())})):e}W(e)},Z=e=>{const{Field_Name:a,Fied_Data:l}=e;var n,i,o,r,d,s,m,c,u,_;if("number"===l)return(0,B.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(n=null===(i=A[a])||void 0===i?void 0:i.min)&&void 0!==n?n:"",onChange:e=>X(a,(0,t.c)((0,t.c)({type:"range"},A[a]),{},{min:e.target.value?parseFloat(e.target.value):void 0}))}),(0,B.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(o=null===(r=A[a])||void 0===r?void 0:r.max)&&void 0!==o?o:"",onChange:e=>X(a,(0,t.c)((0,t.c)({type:"range"},A[a]),{},{max:e.target.value?parseFloat(e.target.value):void 0}))})]});if("date"===l)return(0,B.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(d=null===(s=A[a])||void 0===s||null===(m=s.value)||void 0===m?void 0:m.start)&&void 0!==d?d:"",onChange:e=>{var l;return X(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=A[a])||void 0===l?void 0:l.value),{},{start:e.target.value||void 0})})}}),(0,B.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(c=null===(u=A[a])||void 0===u||null===(_=u.value)||void 0===_?void 0:_.end)&&void 0!==c?c:"",onChange:e=>{var l;return X(a,{type:"date",value:(0,t.c)((0,t.c)({},null===(l=A[a])||void 0===l?void 0:l.value),{},{end:e.target.value||void 0})})}})]});if("string"===l){const e=[...new Set(T.map((e=>{var l,t;return null===(l=e[a])||void 0===l||null===(t=l.toLowerCase())||void 0===t?void 0:t.trim()})))];return(0,B.jsx)(v.c,{multiple:!0,id:"".concat(a,"-filter"),options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:A[a]||[],onChange:(e,l)=>X(a,l),renderOption:(e,a,l)=>{let{selected:n}=l;return(0,B.jsxs)("li",(0,t.c)((0,t.c)({},e),{},{children:[(0,B.jsx)(x.c,{icon:Q,checkedIcon:G,style:{marginRight:8},checked:n}),a]}))},isOptionEqualToValue:(e,a)=>e===a,renderInput:e=>(0,B.jsx)(g.c,(0,t.c)((0,t.c)({},e),{},{label:a,placeholder:"Select ".concat(null===a||void 0===a?void 0:a.replace(/_/g," "))}))})}},ee=()=>{V(!1),H(!1)};return(0,m.useEffect)((()=>{console.log(U)}),[U]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(p.cp,{title:"Item Wise",EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,maxHeightOption:!0,ButtonArea:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(h.c,{title:"Column Visiblity",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>V(!0),children:(0,B.jsx)(O.c,{})})}),(0,B.jsx)(h.c,{title:"Clear Filters",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>P({}),children:(0,B.jsx)(w.c,{})})}),(0,B.jsx)(h.c,{title:"Filters",children:(0,B.jsx)(r.c,{onClick:()=>H(!0),size:"small",children:(0,B.jsx)(k.c,{})})}),u&&(0,B.jsxs)("div",{className:"d-flex align-items-center flex-wrap",children:[(0,B.jsx)("span",{children:"Group-By: "}),(0,B.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:z,onChange:e=>E(e.target.value),children:[(0,B.jsx)("option",{value:"",children:"select group"}),K.filter((e=>"string"===(0,c.MP)(e.Fied_Data)&&"Ledger_Name"!==(null===e||void 0===e?void 0:e.Field_Name))).map(((e,a)=>{var l;return(0,B.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:null===e||void 0===e||null===(l=e.Field_Name)||void 0===l?void 0:l.replace(/_/g," ")},a)}))]})]})]}),ExcelPrintOption:!0,dataArray:U,columns:z?K.filter((e=>U.length>0&&Object.keys(U[0]).includes(e.Field_Name))).map((e=>(0,t.c)((0,t.c)({},e),{},{ColumnHeader:e.Field_Name===z?z:e.ColumnHeader}))):K,isExpendable:!!z,expandableComp:e=>{let{row:a}=e;return(0,B.jsx)(p.cp,{EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,dataArray:(0,c.dq)(null===a||void 0===a?void 0:a.groupedData),columns:K.filter((e=>!(0,c.m2)(e.Field_Name,z)))})}}),(0,B.jsxs)(y.c,{open:q,onClose:ee,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsxs)(N.c,{children:[(0,B.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,B.jsx)("span",{children:"Filters"}),(0,B.jsxs)("span",{children:[(0,B.jsx)(h.c,{title:"Column Visiblity",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>V(!0),children:(0,B.jsx)(O.c,{})})}),(0,B.jsx)(h.c,{title:"Clear Filters",children:(0,B.jsx)(r.c,{size:"small",onClick:()=>P({}),children:(0,B.jsx)(w.c,{})})})]})]}),(0,B.jsxs)("div",{className:"border rounded-3 ",children:[K.map(((e,a)=>{var l;return(0,B.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,B.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(l=e.Field_Name)||void 0===l?void 0:l.replace(/_/g," ")}),Z(e)]},a)})),(0,B.jsx)("br",{})]})]}),(0,B.jsx)(b.c,{children:(0,B.jsx)(j.c,{onClick:ee,color:"error",children:"close"})})]}),(0,B.jsxs)(y.c,{open:M,onClose:()=>V(!1),maxWidth:"lg",fullWidth:!0,children:[(0,B.jsx)(C.c,{children:"Column Settings"}),(0,B.jsx)(N.c,{children:(0,B.jsx)("div",{className:"row",children:R.map(((e,a)=>(0,B.jsx)("div",{className:"col-lg-4 col-md-6 p-2",children:(0,B.jsxs)(f.c,{component:F.c,className:"p-2 d-flex justify-content-between align-items-center flex-wrap ".concat(a%2!==0?"bg-light":""),children:[(0,B.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap",children:[(0,B.jsx)(D.c,{checked:Boolean(null===e||void 0===e?void 0:e.isDefault)||Boolean(null===e||void 0===e?void 0:e.isVisible),disabled:Boolean(null===e||void 0===e?void 0:e.isDefault),onChange:a=>$((l=>l.map((l=>l.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.c)((0,t.c)({},l),{},{isVisible:a.target.checked?1:0}):l))))}),(0,B.jsx)("h6",{className:"fa-13 mb-0 fw-bold ",children:null===e||void 0===e?void 0:e.Field_Name})]}),(0,B.jsx)("input",{type:"number",value:(0,c.Q$)(null===e||void 0===e?void 0:e.OrderBy)?null===e||void 0===e?void 0:e.OrderBy:"",onChange:a=>$((l=>l.map((l=>l.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.c)((0,t.c)({},l),{},{OrderBy:a.target.value}):l)))),label:"Order Value",className:"mt-2 p-1 border-0 cus-inpt",style:{width:"80px"},placeholder:"Order"})]})},a)))})}),(0,B.jsxs)(b.c,{children:[(0,B.jsx)(j.c,{onClick:()=>$(L),variant:"outlined",children:"Reset"}),(0,B.jsx)(j.c,{onClick:()=>V(!1),color:"error",children:"close"})]})]})]})},P=[{Column_Name:"Trans_Date",Data_Type:"date"},{Column_Name:"Group_Name",Data_Type:"string"},{Column_Name:"stock_item_name",Data_Type:"string"},{Column_Name:"OB_Bal_Qty",Data_Type:"number"},{Column_Name:"OB_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Qty",Data_Type:"number"},{Column_Name:"Sal_Qty",Data_Type:"number"},{Column_Name:"Bal_Qty",Data_Type:"number"},{Column_Name:"Bal_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Act_Qty",Data_Type:"number"},{Column_Name:"Sal_Act_Qty",Data_Type:"number"},{Column_Name:"Stock_Item",Data_Type:"string"},{Column_Name:"Group_ST",Data_Type:"string"},{Column_Name:"Bag",Data_Type:"string"},{Column_Name:"Stock_Group",Data_Type:"string"},{Column_Name:"Product_Rate",Data_Type:"number"},{Column_Name:"S_Sub_Group_1",Data_Type:"string"},{Column_Name:"Grade_Item_Group",Data_Type:"string"},{Column_Name:"Item_Name_Modified",Data_Type:"string"}],z=[{Column_Name:"Godown_Name",Data_Type:"string"},{Column_Name:"stock_item_name",Data_Type:"string"},{Column_Name:"OB_Bal_Qty",Data_Type:"number"},{Column_Name:"OB_Act_Qty",Data_Type:"number"},{Column_Name:"Pur_Qty",Data_Type:"number"},{Column_Name:"Sal_Qty",Data_Type:"number"},{Column_Name:"Bal_Qty",Data_Type:"number"},{Column_Name:"Act_Bal_Qty",Data_Type:"number"},{Column_Name:"Pur_Act_Qty",Data_Type:"number"},{Column_Name:"Sal_Act_Qty",Data_Type:"number"},{Column_Name:"Stock_Item",Data_Type:"string"},{Column_Name:"Group_ST",Data_Type:"string"},{Column_Name:"Bag",Data_Type:"string"},{Column_Name:"Stock_Group",Data_Type:"string"},{Column_Name:"Product_Rate",Data_Type:"number"},{Column_Name:"S_Sub_Group_1",Data_Type:"string"},{Column_Name:"Grade_Item_Group",Data_Type:"string"},{Column_Name:"Item_Name_Modified",Data_Type:"string"}],E=e=>{let{loadingOn:a,loadingOff:l}=e;const[_,p]=(0,m.useState)(1),[v,x]=(0,m.useState)({Fromdate:(0,c.Q7)(),Todate:(0,c.Q7)(),FilterFromDate:(0,c.Q7)(),FilterTodate:(0,c.Q7)()}),g=[{name:"Item Wise",component:(0,B.jsx)(A,{loadingOn:a,loadingOff:l,Fromdate:v.Fromdate,Todate:v.Todate,api:"itemWise",defaultGrouping:"",storageStockColumns:P})},{name:"Godown Wise",component:(0,B.jsx)(A,{loadingOn:a,loadingOff:l,Fromdate:v.Fromdate,Todate:v.Todate,api:"godownWise",defaultGrouping:"Godown_Name",storageStockColumns:z,groupingOption:!1})}];return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-3",children:[(0,B.jsx)("label",{htmlFor:"from",className:"me-1 fw-bold ",children:"Fromdate: "}),(0,B.jsx)("input",{type:"date",id:"from",className:"cus-inpt p-2 w-auto me-2",value:v.FilterFromDate,onChange:e=>x((a=>(0,t.c)((0,t.c)({},a),{},{FilterFromDate:e.target.value})))}),(0,B.jsx)("label",{htmlFor:"to",className:"me-1 fw-bold ",children:"Todate: "}),(0,B.jsx)("input",{type:"date",id:"to",className:"cus-inpt p-2 w-auto",value:v.FilterTodate,onChange:e=>x((a=>(0,t.c)((0,t.c)({},a),{},{FilterTodate:e.target.value})))}),(0,B.jsx)(r.c,{size:"small",onClick:()=>x((e=>(0,t.c)((0,t.c)({},e),{},{Fromdate:e.FilterFromDate?e.FilterFromDate:e.Fromdate,Todate:e.FilterTodate?e.FilterTodate:e.Todate}))),children:(0,B.jsx)(u.c,{})})]}),(0,B.jsxs)(n.cp,{value:_,children:[(0,B.jsx)(d.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,B.jsx)(i.c,{indicatorColor:"transparant",onChange:(e,a)=>p(a),variant:"scrollable",scrollButtons:"auto",children:g.map(((e,a)=>(0,B.jsx)(s.c,{sx:_===a+1?{backgroundColor:"#c6d7eb"}:{},label:e.name,value:a+1},a)))})}),g.map(((e,a)=>(0,B.jsx)(o.c,{value:a+1,sx:{p:0,pt:2},children:e.component},a)))]})]})}}}]);
//# sourceMappingURL=312.46435a4f.chunk.js.map