"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[9488],{80644:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Q});var l=a(69060),t=a(43692),o=a(89e3),r=a(84436),n=a(5548),d=a(62344),c=a(56480),i=a(39308),u=a(96064),m=a(81256),v=a(86e3),p=a(45180),h=a(1908),x=a(13724),_=a(128),g=a(51560),j=a(63656),I=a(99852),b=a(82496);const f=e=>{let{StaffArray:s=[],setStaffArray:a,costCenter:l=[],costCategory:t=[]}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,b.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,b.jsx)(o.c,{variant:"outlined",color:"primary",type:"button",onClick:()=>a((e=>[...e,{...j.IF}])),children:"Add"})]}),(0,b.jsxs)("table",{className:"table table-bordered",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"fa-13",children:"Sno"}),(0,b.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,b.jsx)("th",{className:"fa-13",children:"Category"}),(0,b.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,b.jsx)("tbody",{children:(0,i.dq)(s).map(((e,o)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"fa-13 vctr text-center",children:o+1}),(0,b.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,b.jsx)(I.cp,{value:{value:null===e||void 0===e?void 0:e.Emp_Id,label:null===e||void 0===e?void 0:e.Emp_Name},onChange:e=>a((s=>s.map(((s,a)=>{if((0,i.Qr)(a,o)){const a=(0,i.dq)(l).find((s=>(0,i.Qr)(null===s||void 0===s?void 0:s.Cost_Center_Id,e.value)));return{...s,Emp_Type_Id:(0,i.Q$)(null===s||void 0===s?void 0:s.Emp_Type_Id)?Number(null===s||void 0===s?void 0:s.Emp_Type_Id):(0,i.Q$)(a.User_Type)?Number(a.User_Type):0,Emp_Id:Number(e.value),Emp_Name:e.label}}return s})))),options:[...(0,i.dq)(l).filter((e=>!s.some((s=>(0,i.Qr)(s.Emp_Id,e.Cost_Center_Id)))))].map((e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name}))),styles:d.cF,isSearchable:!0,placeholder:"Select Staff"})}),(0,b.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,b.jsxs)("select",{value:null===e||void 0===e?void 0:e.Emp_Type_Id,onChange:e=>a((s=>s.map(((s,a)=>(0,i.Qr)(a,o)?{...s,Emp_Type_Id:e.target.value}:s)))),className:"cus-inpt p-2 border-0",children:[(0,b.jsx)("option",{value:"",children:"Select"}),(0,i.dq)(t).map(((e,s)=>(0,b.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},s)))]})}),(0,b.jsx)("td",{className:"fa-13 vctr p-0",children:(0,b.jsx)(n.c,{onClick:()=>{a((e=>e.filter(((e,s)=>o!==s))))},size:"small",children:(0,b.jsx)(p.c,{color:"error"})})})]},o)))})]})]})};var N=a(64568);const S=e=>{var s;let{invoiceInfo:a={},setInvoiceInfo:l,retailers:t=[],voucherType:o=[],branches:r=[],onChangeRetailer:n,stockItemLedgerName:c=[]}=e;const u="cus-inpt p-2";return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,b.jsx)("label",{className:"fa-13",children:"Party Name"}),(0,b.jsx)(I.cp,{value:{value:null===a||void 0===a?void 0:a.Retailer_Id,label:null===a||void 0===a?void 0:a.Retailer_Name},onChange:e=>{l((s=>({...s,Retailer_Id:e.value,Retailer_Name:e.label}))),n&&n()},options:[{value:"",label:"Search",isDisabled:!0},...(0,i.dq)(t).map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:d.cF,isSearchable:!0,placeholder:"Select Vendor",maxMenuHeight:300})]}),(0,b.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,b.jsx)("label",{className:"fa-13",children:"Voucher Type"}),(0,b.jsx)(I.cp,{value:{value:a.Voucher_Type,label:null===(s=(0,i.dq)(o).find((e=>(0,i.Qr)(e.Vocher_Type_Id,a.Voucher_Type))))||void 0===s?void 0:s.Voucher_Type},onChange:e=>l((s=>({...s,Voucher_Type:e.value}))),options:[{value:"",label:"Search",isDisabled:!0},...(0,i.dq)(o).filter((e=>"SALES"===(null===e||void 0===e?void 0:e.Type))).map((e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type})))],styles:d.cF,isSearchable:!0,required:!0,placeholder:"Select Voucher Type",maxMenuHeight:300,isDisabled:(0,i.Q$)(null===a||void 0===a?void 0:a.Do_Id)})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsxs)("label",{className:"fa-13",children:["Entry Date ",(0,b.jsx)(N.c,{})]}),(0,b.jsx)("input",{value:null===a||void 0===a?void 0:a.Do_Date,type:"date",required:!0,className:u,onChange:e=>l((s=>({...s,Do_Date:e.target.value})))})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsxs)("label",{className:"fa-13",children:["Branch ",(0,b.jsx)(N.c,{})]}),(0,b.jsxs)("select",{className:u,value:null===a||void 0===a?void 0:a.Branch_Id,required:!0,onChange:e=>l((s=>({...s,Branch_Id:e.target.value}))),children:[(0,b.jsx)("option",{value:"",children:"select"}),r.map(((e,s)=>(0,b.jsx)("option",{value:null===e||void 0===e?void 0:e.BranchId,children:null===e||void 0===e?void 0:e.BranchName},s)))]})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsxs)("label",{className:"fa-13",children:["GST Type ",(0,b.jsx)(N.c,{})]}),(0,b.jsxs)("select",{className:u,onChange:e=>l((s=>({...s,GST_Inclusive:Number(e.target.value)}))),value:a.GST_Inclusive,required:!0,children:[(0,b.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,b.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,b.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{className:"fa-13",children:"Tax Type"}),(0,b.jsxs)("select",{className:u,onChange:e=>l((s=>({...s,IS_IGST:Number(e.target.value)}))),value:a.IS_IGST,children:[(0,b.jsx)("option",{value:"0",children:"GST"}),(0,b.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{className:"fa-13",children:"Stock Item Ledger Name"}),(0,b.jsx)(I.cp,{value:{value:a.Stock_Item_Ledger_Name,label:a.Stock_Item_Ledger_Name},onChange:e=>l((s=>({...s,Stock_Item_Ledger_Name:e.value}))),options:[{value:"",label:"Search",isDisabled:!0},...c.map((e=>({value:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name,label:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name})))],styles:d.cF,menuPortalTarget:document.body,required:!0,isSearchable:!0,placeholder:"Select",maxMenuHeight:300})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{className:"fa-13",children:"Status"}),(0,b.jsxs)("select",{value:null===a||void 0===a?void 0:a.Cancel_status,className:u,onChange:e=>l((s=>({...s,Cancel_status:e.target.value}))),children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,b.jsx)("option",{value:"1",children:"New"}),(0,b.jsx)("option",{value:"2",children:"Progess"}),(0,b.jsx)("option",{value:"3",children:"Completed"}),(0,b.jsx)("option",{value:"0",children:"Canceled"})]})]})]}),(0,b.jsx)("label",{className:"fa-13",children:"Narration"}),(0,b.jsx)("textarea",{className:"cus-inpt fa-14",rows:2,value:a.Narration,onChange:e=>l((s=>({...s,Narration:e.target.value})))})]})},C=function(){var e;let s=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,i.Qr)(e.Product_Id,s))))&&void 0!==e?e:{}},y=e=>{let{invoiceProducts:s=[],invoiceExpences:a=[],isNotTaxableBill:t,isInclusive:o,IS_IGST:r,products:n=[],invoiceInfo:d={},setInvoiceInfo:c}=e;const u=(0,l.useMemo)((()=>(0,i.dq)(a).reduce(((e,s)=>(0,i.Q5)(e,null===s||void 0===s?void 0:s.Expence_Value)),0)),[a]),m=(0,l.useMemo)((()=>{const e=s.reduce(((e,s)=>{const a=(0,i.kR)(null===s||void 0===s?void 0:s.Amount);if(t)return(0,i.Q5)(e,a);const l=C(n,s.Item_Id),d=r?l.Igst_P:l.Gst_P;return o?(0,i.Q5)(e,(0,_.O)(a,d,"remove").with_tax):(0,i.Q5)(e,(0,_.O)(a,d,"add").with_tax)}),0);return(0,i.Q5)(e,u)}),[s,t,n,r,o,u]),v=(0,l.useMemo)((()=>{if(!s||0===s.length)return{};let e=0,a=0;s.forEach((s=>{const l=(0,i.kR)((null===s||void 0===s?void 0:s.Amount)||0);if(t)return void(e=(0,i.Q5)(e,l));const d=C(n,s.Item_Id),c=(0,i.Qr)(r,1)?d.Igst_P:d.Gst_P,u=(0,_.O)(l,c,o?"remove":"add");e=(0,i.Q5)(e,parseFloat(u.without_tax)),a=(0,i.Q5)(a,parseFloat(u.tax_amount))}));const l=(0,i.Q5)(e,a),d=Math.round(l),c=(0,i.kR)(d-l),u=(0,i.Qr)(r,1)?0:(0,i.kR)(a/2),m=(0,i.Qr)(r,1)?0:(0,i.kR)(a/2),v=(0,i.Qr)(r,1)?(0,i.kR)(a):0;return{totalTaxable:(0,i.kR)(e),totalTax:(0,i.kR)(a),cgst:u,sgst:m,igst:v,roundOff:c,invoiceTotal:d}}),[s,n,r,t,o]);return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("table",{className:"table",children:(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"border p-2",rowSpan:r?5:6,children:["Total in words: ",(0,i.m4)(parseInt(m))]}),(0,b.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,b.jsx)("td",{className:"border p-2",children:v.totalTaxable})]}),r?(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"IGST"}),(0,b.jsx)("td",{className:"border p-2",children:v.igst})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"CGST"}),(0,b.jsx)("td",{className:"border p-2",children:v.cgst})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"SGST"}),(0,b.jsx)("td",{className:"border p-2",children:v.sgst})]})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"Total Expences"}),(0,b.jsx)("td",{className:"border p-2",children:(0,i.kR)(u)})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,b.jsx)("td",{className:"border p-0",children:(0,b.jsx)("input",{value:d.Round_off,defaultValue:v.roundOff,className:"cus-inpt p-2 m-0 border-0",onInput:i.mE,onChange:e=>c((s=>({...s,Round_off:e.target.value})))})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2",children:"Total"}),(0,b.jsx)("td",{className:"border p-2",children:(0,i.SA)(Math.round(m))})]})]})})})};var T=a(664),E=a(52204);const A=e=>{let{invoiceExpences:s=[],setInvoiceExpences:a,expenceMaster:l=[],IS_IGST:r,taxType:d}=e;return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(t.c,{children:[(0,b.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-wrap px-3 py-2",children:[(0,b.jsx)("h5",{className:"m-0",children:"Expenses"}),(0,b.jsx)(o.c,{variant:"outlined",type:"button",onClick:()=>{a((e=>[...e,{...j.ox,Sno:e.length}]))},children:"Add"})]}),(0,b.jsx)("div",{className:"table-responsive",children:(0,b.jsxs)("table",{className:"table table-bordered m-0",children:[(0,b.jsx)("thead",{className:"table-light",children:(0,b.jsx)("tr",{children:["S.No","Expense","Expense Value","Action"].map(((e,s)=>(0,b.jsx)("th",{className:"fa-13 bg-light",children:e},s)))})}),(0,b.jsxs)("tbody",{style:{fontSize:"13px"},children:[s.map(((e,t)=>{var o;return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:t+1}),(0,b.jsx)("td",{className:"p-0 vctr",style:{minWidth:"180px"},children:(0,b.jsx)(I.cp,{value:{value:null===e||void 0===e?void 0:e.Expense_Id,label:(null===(o=l.find((s=>(0,i.Qr)(s.Id,null===e||void 0===e?void 0:e.Expense_Id))))||void 0===o?void 0:o.Expence_Name)||""},onChange:e=>((e,s)=>{const t=l.find((e=>(0,i.Qr)(e.Id,s.value)))||{};a((s=>s.map(((s,a)=>a!==e?s:{...s,Expense_Id:t.Id,Expence_Value:0}))))})(t,e),options:l.filter((e=>!s.some((s=>s.Expense_Id===e.Id)))).map((e=>({value:e.Id,label:e.Expence_Name}))),menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Expense"})}),(0,b.jsx)("td",{className:"p-0 vctr",children:(0,b.jsx)("input",{onInput:i.mE,className:"cus-inpt p-2 border-0",value:e.Expence_Value||"",disabled:!(0,i.Q$)(e.Expense_Id),onChange:e=>{console.log(e.target.value),((e,s,l)=>{a((a=>a.map(((a,t)=>{if(t!==e)return a;const o={...a,[s]:l};if("Expence_Value"===s){const e=a.Cgst?(0,i.gH)(a.Cgst):0,s=a.Sgst?(0,i.gH)(a.Sgst):0,t=a.Igst?(0,i.gH)(a.Igst):0,n=(0,i.gH)(l),c=r?t:(0,i.Q5)(e,s),u=(0,_.O)(n,c,d);o.Cgst_Amo=e>0&&!r?u.cgst_amount:0,o.Sgst_Amo=s>0&&!r?u.sgst_amount:0,o.Igst_Amo=t>0&&r?u.igst_amount:0}if("Igst"===s){const e=r?(0,i.gH)(l):0,s=r?0:(0,i.yy)((0,i.gH)(l),2),t=r?0:(0,i.yy)((0,i.gH)(l),2),n=(0,i.gH)(a.Expence_Value),c=r?e:(0,i.Q5)(s,t),u=(0,_.O)(n,c,d);o.Cgst=s,o.Sgst=t,o.Cgst_Amo=s>0?u.cgst_amount:0,o.Sgst_Amo=t>0?u.sgst_amount:0,o.Igst_Amo=e>0?u.igst_amount:0}return o}))))})(t,"Expence_Value",e.target.value)}})}),(0,b.jsx)("td",{className:"p-0 vctr  text-center ",children:(0,b.jsx)(n.c,{onClick:()=>(e=>{a((s=>s.filter(((s,a)=>a!==e))))})(t),size:"small",children:(0,b.jsx)(p.c,{color:"error",fontSize:"small"})})})]},t)})),0===s.length&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"text-center",colSpan:6,children:"No rows"})})]})]})})]})})},w=(0,i.gV)().user,Q=e=>{let{loadingOn:s,loadingOff:a}=e;const d=(0,g.i6)(),I=(0,g.IT)().state,[N,C]=(0,l.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],brand:[],godown:[],expence:[],stockInGodown:[],stockItemLedgerName:[]}),[Q,k]=(0,l.useState)({addProductDialog:!1,importFromSaleOrder:!1}),[G,P]=(0,l.useState)(j.ai),[V,R]=(0,l.useState)([]),[O,H]=(0,l.useState)([]),[q,M]=(0,l.useState)([]),[L,D]=(0,l.useState)(null),z=(0,i.Qr)(G.GST_Inclusive,1),F=(0,i.Qr)(G.GST_Inclusive,2),B=(0,i.Qr)(G.IS_IGST,1),$=F?"zerotax":z?"remove":"add",U=3-V.length;(0,l.useEffect)((()=>{(async()=>{try{s&&s();const[e,a,l,t,o,r,n,d,c,u,m]=await Promise.all([(0,h.q)({address:"masters/branch/dropDown"}),(0,h.q)({address:"masters/products"}),(0,h.q)({address:`masters/retailers/dropDown?Company_Id=${null===w||void 0===w?void 0:w.Company_id}`}),(0,h.q)({address:"purchase/voucherType"}),(0,h.q)({address:"masters/uom"}),(0,h.q)({address:"dataEntry/costCenter"}),(0,h.q)({address:"dataEntry/costCenter/category"}),(0,h.q)({address:"dataEntry/godownLocationMaster"}),(0,h.q)({address:"masters/defaultAccountMaster"}),(0,h.q)({address:"sales/stockInGodown"}),(0,h.q)({address:"purchase/stockItemLedgerName?type=SALES"})]),v=(e.success?e.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===s||void 0===s?void 0:s.BranchName))),p=(a.success?a.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===s||void 0===s?void 0:s.Product_Name))),x=(l.success?l.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===s||void 0===s?void 0:s.Retailer_Name))),_=(t.success?t.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===s||void 0===s?void 0:s.Voucher_Type))),g=(o.success?o.data:[]).sort(((e,s)=>String(e.Units).localeCompare(s.Units))),j=(r.success?r.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===s||void 0===s?void 0:s.Cost_Center_Name))),I=(n.success?n.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===s||void 0===s?void 0:s.Cost_Category))),b=(d.success?d.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Godown_Name).localeCompare(null===s||void 0===s?void 0:s.Godown_Name))),f=(c.success?(0,i.dq)(c.data):[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Account_Name).localeCompare(null===s||void 0===s?void 0:s.Account_Name))),N=(u.success?u.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.stock_item_name).localeCompare(null===s||void 0===s?void 0:s.stock_item_name))),S=(m.success?m.data:[]).sort(((e,s)=>String(null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name).localeCompare(null===s||void 0===s?void 0:s.Stock_Item_Ledger_Name)));C((e=>({...e,products:p,branch:v,retailers:x,voucherType:_,uom:g,staff:j,staffType:I,godown:b,brand:(0,i.Un)(p,"Brand",["Brand_Name"]),expence:f.filter((e=>!(0,i.m2)(e.Type,"DEFAULT"))).map((e=>({Id:e.Acc_Id,Expence_Name:e.Account_Name}))),stockInGodown:N,stockItemLedgerName:S})))}catch(e){console.error("Error fetching data:",e)}finally{a&&a()}})()}),[null===w||void 0===w?void 0:w.Company_id]);(0,l.useEffect)((()=>{R((e=>[...e].map((e=>Object.fromEntries(Object.entries(e).map((s=>{let[a,l]=s;const t=function(){var e;let s=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,i.Qr)(e.Product_Id,s))))&&void 0!==e?e:{}}(N.products,null===e||void 0===e?void 0:e.Item_Id),o=B?t.Igst_P:t.Gst_P,r=o>0,{Bill_Qty:n,Item_Rate:d,Amount:c}=e,u=(0,_.O)(d,o,$),m=(0,_.O)(c,o,$),v=B?0:m.cgst_per,p=B?m.igst_per:0,h=B?0:m.cgst_amount,x=B?m.igst_amount:0;switch(a){case"Taxable_Rate":return[a,u.base_amount];case"Total_Qty":return[a,n];case"Taxble":return[a,r?1:0];case"Taxable_Amount":return[a,m.base_amount];case"Tax_Rate":return[a,o];case"Cgst":case"Sgst":return[a,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[a,F?0:h];case"Igst":return[a,null!==p&&void 0!==p?p:0];case"Igst_Amo":return[a,F?0:x];case"Final_Amo":return[a,m.with_tax];default:return[a,e[a]||l]}})))))))}),[N.products,B,$]),(0,l.useEffect)((()=>{H((e=>[...e].map((e=>{const s=B?(0,i.gH)(null===e||void 0===e?void 0:e.Igst):0,a=B?0:(0,i.gH)(null===e||void 0===e?void 0:e.Cgst),l=B?0:(0,i.gH)(null===e||void 0===e?void 0:e.Sgst),t=(0,i.gH)(null===e||void 0===e?void 0:e.Expence_Value),o=B?s:(0,i.Q5)(a,l),r=(0,_.O)(t,o,$);return{...e,Cgst:a,Sgst:l,Igst:s,Expence_Value:t,Cgst_Amo:a>0?r.cgst_amount:0,Sgst_Amo:l>0?r.sgst_amount:0,Igst_Amo:s>0?r.igst_amount:0}}))))}),[N.expence,B,$]),(0,l.useEffect)((()=>{if((0,i.CY)(I)&&Array.isArray(null===I||void 0===I?void 0:I.Products_List)){const{Products_List:e,Expence_Array:s,Staffs_Array:a}=I;P(Object.fromEntries(Object.entries(j.ai).map((e=>{var s;let[a,l]=e;return"Do_Date"===a?[a,I[a]?(0,i.Q7)(I[a]):l]:[a,null!==(s=I[a])&&void 0!==s?s:l]})))),R(e.map((e=>Object.fromEntries(Object.entries(j.e4).map((s=>{var a;let[l,t]=s;return[l,null!==(a=e[l])&&void 0!==a?a:t]})))))),H((0,i.dq)(s).map((e=>Object.fromEntries(Object.entries(j.ox).map((s=>{var a;let[l,t]=s;return[l,null!==(a=e[l])&&void 0!==a?a:t]})))))),M((0,i.dq)(a).map((e=>Object.fromEntries(Object.entries(j.IF).map((s=>{var a;let[l,t]=s;return[l,null!==(a=e[l])&&void 0!==a?a:t]}))))))}}),[I]);const W=()=>{s&&s(),(0,h.q)({address:"sales/salesInvoice",method:(0,i.Q$)(null===G||void 0===G?void 0:G.Do_Id)?"PUT":"POST",bodyData:{...G,Product_Array:V,Staffs_Array:q,Expence_Array:O}}).then((e=>{e.success?(P(j.ai),R([]),H([]),M([]),c.m4.success(e.message),d("/erp/sales/invoice")):c.m4.warn(e.message)})).catch((e=>console.error(e))).finally((()=>{a&&a()}))};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.c,{orderProducts:V,setOrderProducts:R,open:Q.addProductDialog,onClose:()=>{k((e=>({...e,addProductDialog:!1}))),D(null)},products:N.products,brands:N.brand,uom:N.uom,godowns:N.godown,GST_Inclusive:G.GST_Inclusive,IS_IGST:B,editValues:L,initialValue:{...j.e4,Pre_Id:G.So_No},stockInGodown:N.stockInGodown}),(0,b.jsxs)(t.c,{children:[(0,b.jsxs)("div",{className:"d-flex flex-wrap align-items-center border-bottom py-2 px-3",children:[(0,b.jsx)("span",{className:"flex-grow-1 fa-16 fw-bold",children:"Sales Invoice"}),(0,b.jsxs)("span",{children:[(0,b.jsx)(o.c,{type:"button",onClick:()=>{window.history.length>1?d(-1):d("/erp/sales/invoice")},children:"Cancel"}),(0,b.jsx)(o.c,{onClick:()=>W(),variant:"contained",children:"submit"})]})]}),(0,b.jsxs)(r.c,{children:[(0,b.jsxs)("div",{className:"row p-0",children:[(0,b.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,b.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,b.jsx)(f,{StaffArray:q,setStaffArray:M,costCenter:N.staff,costCategory:N.staffType})})}),(0,b.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,b.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,b.jsx)(S,{invoiceInfo:G,setInvoiceInfo:P,retailers:N.retailers,branches:N.branch,voucherType:N.voucherType,stockItemLedgerName:N.stockItemLedgerName,onChangeRetailer:()=>{R([]),H([])}})})})]}),(0,b.jsx)(x.cp,{title:"Items",headerFontSizePx:13,bodyFontSizePx:13,EnableSerialNumber:!0,disablePagination:!0,ButtonArea:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.c,{onClick:()=>{D(null),k((e=>({...e,addProductDialog:!0})))},sx:{ml:1},variant:"outlined",type:"button",startIcon:(0,b.jsx)(u.c,{}),disabled:!(0,i.Q$)(G.Retailer_Id)||V.length>0&&(0,i.Q$)(G.So_No),children:"Add Product"}),(0,b.jsx)(E.c,{loadingOn:s,loadingOff:a,open:Q.importFromSaleOrder,onClose:()=>k((e=>({...e,importFromSaleOrder:!1}))),retailer:null===G||void 0===G?void 0:G.Retailer_Id,selectedItems:V,setSelectedItems:R,staffArray:q,setStaffArray:M,products:N.products,GST_Inclusive:G.GST_Inclusive,IS_IGST:B,invoiceInfo:G,setInvoiceInfo:P,godowns:N.godown,stockInGodown:N.stockInGodown,children:(0,b.jsx)(o.c,{onClick:()=>k((e=>({...e,importFromSaleOrder:!0}))),disabled:!(0,i.Q$)(G.Retailer_Id)||V.length>0&&!(0,i.Q$)(G.So_No),sx:{ml:1},type:"button",variant:"outlined",startIcon:(0,b.jsx)(m.c,{}),children:"Choose Sale Order"})})]}),dataArray:[...V,...Array.from({length:U>0?U:0}).map((e=>j.e4))],columns:[(0,x.A5)("Item_Name","string"),(0,x.A5)("HSN_Code","string"),(0,x.A5)("Bill_Qty","number"),(0,x.A5)("Act_Qty","number"),(0,x.A5)("Item_Rate","number"),{isVisible:1,ColumnHeader:"Tax",isCustomCell:!0,Cell:e=>{let{row:s}=e;const{Cgst:a=0,Sgst:l=0,Igst:t=0,Cgst_Amo:o=0,Sgst_Amo:r=0,Igst_Amo:n=0}=s,d=B?t:(0,i.Q5)(a,l),c=B?n:(0,i.Q5)(o,r);return(0,i.Q$)(null===s||void 0===s?void 0:s.Item_Id)?`${c} - (${d} %)`:""}},{isVisible:1,ColumnHeader:"Godown",isCustomCell:!0,Cell:e=>{var s,a;let{row:l}=e;return null!==(s=null===(a=N.godown.find((e=>(0,i.Qr)(e.Godown_Id,null===l||void 0===l?void 0:l.GoDown_Id))))||void 0===a?void 0:a.Godown_Name)&&void 0!==s?s:""}},(0,x.A5)("Amount","number"),{isCustomCell:!0,Cell:e=>{let{row:s}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.c,{onClick:()=>{D(s),k((e=>({...e,addProductDialog:!0})))},size:"small",type:"button",disabled:!(0,i.Q$)(null===s||void 0===s?void 0:s.Item_Id),children:(0,b.jsx)(v.c,{})}),(0,b.jsx)(n.c,{size:"small",type:"button",onClick:()=>R((e=>e.filter((e=>!(0,i.Qr)(e.Item_Id,s.Item_Id))))),color:"error",disabled:!(0,i.Q$)(null===s||void 0===s?void 0:s.Item_Id),children:(0,b.jsx)(p.c,{})})]})},ColumnHeader:"Action",isVisible:1}]}),(0,b.jsx)("br",{}),(0,b.jsx)(A,{invoiceExpences:O,setInvoiceExpences:H,expenceMaster:N.expence,IS_IGST:B,taxType:$}),(0,b.jsx)("br",{}),(0,b.jsx)(y,{invoiceProducts:V,invoiceExpences:O,isNotTaxableBill:F,isInclusive:z,IS_IGST:B,products:N.products,invoiceInfo:G,setInvoiceInfo:P})]})]})]})}},96064:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)((0,t.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},56084:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)((0,t.jsx)("path",{d:"M5 13h14v-2H5zm-2 4h14v-2H3zM7 7v2h14V7z"}),"ClearAll")},45180:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)((0,t.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},42376:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)((0,t.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done")},86e3:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},81256:(e,s,a)=>{a.d(s,{c:()=>o});var l=a(27664),t=a(82496);const o=(0,l.c)([(0,t.jsx)("path",{d:"M19.5 3.5 18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2v14H3v3c0 1.66 1.34 3 3 3h12c1.66 0 3-1.34 3-3V2zM19 19c0 .55-.45 1-1 1s-1-.45-1-1v-3H8V5h11z"},"0"),(0,t.jsx)("path",{d:"M9 7h6v2H9zm7 0h2v2h-2zm-7 3h6v2H9zm7 0h2v2h-2z"},"1")],"ReceiptLong")},84436:(e,s,a)=>{a.d(s,{c:()=>x});var l=a(45072),t=a(95656),o=a(69060),r=a(79736),n=a(21412),d=a(12556),c=a(49836),i=a(10099),u=a(33448);function m(e){return(0,u.cp)("MuiCardContent",e)}(0,i.c)("MuiCardContent",["root"]);var v=a(82496);const p=["className","component"],h=(0,d.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,s)=>s.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),x=o.forwardRef((function(e,s){const a=(0,c.C)({props:e,name:"MuiCardContent"}),{className:o,component:d="div"}=a,i=(0,t.c)(a,p),u=(0,l.c)({},a,{component:d}),x=(e=>{const{classes:s}=e;return(0,n.c)({root:["root"]},m,s)})(u);return(0,v.jsx)(h,(0,l.c)({as:d,className:(0,r.c)(x.root,o),ownerState:u,ref:s},i))}))}}]);
//# sourceMappingURL=9488.f1c47013.chunk.js.map